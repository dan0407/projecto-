/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={6199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(5319),o=n(1635),a=n(5844),c=n(6336),u=n(6148),l=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")},e}(),h="@firebase/app",d="0.10.2",f=new a.Logger("@firebase/app"),p="[DEFAULT]",m=((r={})[h]="fire-core",r["@firebase/app-compat"]="fire-core-compat",r["@firebase/analytics"]="fire-analytics",r["@firebase/analytics-compat"]="fire-analytics-compat",r["@firebase/app-check"]="fire-app-check",r["@firebase/app-check-compat"]="fire-app-check-compat",r["@firebase/auth"]="fire-auth",r["@firebase/auth-compat"]="fire-auth-compat",r["@firebase/database"]="fire-rtdb",r["@firebase/database-compat"]="fire-rtdb-compat",r["@firebase/functions"]="fire-fn",r["@firebase/functions-compat"]="fire-fn-compat",r["@firebase/installations"]="fire-iid",r["@firebase/installations-compat"]="fire-iid-compat",r["@firebase/messaging"]="fire-fcm",r["@firebase/messaging-compat"]="fire-fcm-compat",r["@firebase/performance"]="fire-perf",r["@firebase/performance-compat"]="fire-perf-compat",r["@firebase/remote-config"]="fire-rc",r["@firebase/remote-config-compat"]="fire-rc-compat",r["@firebase/storage"]="fire-gcs",r["@firebase/storage-compat"]="fire-gcs-compat",r["@firebase/firestore"]="fire-fst",r["@firebase/firestore-compat"]="fire-fst-compat",r["fire-js"]="fire-js",r.firebase="fire-js-all",r),g=new Map,y=new Map,v=new Map;function w(e,t){try{e.container.addComponent(t)}catch(n){f.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function b(e){var t,n,r,i,s=e.name;if(v.has(s))return f.debug("There were multiple attempts to register component ".concat(s,".")),!1;v.set(s,e);try{for(var a=o.__values(g.values()),c=a.next();!c.done;c=a.next())w(c.value,e)}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}try{for(var u=o.__values(y.values()),l=u.next();!l.done;l=u.next())w(l.value,e)}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return!0}function _(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function E(e){return void 0!==e.options}var x=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call initializeApp() first",i["bad-app-name"]="Illegal App name: '{$appName}'",i["duplicate-app"]="Firebase App named '{$appName}' already exists with different options or config",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["server-app-deleted"]="Firebase Server App has been deleted",i["no-options"]="Need to provide options, when not being deployed to hosting via source.",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i["idb-open"]="Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",i["idb-get"]="Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",i["idb-set"]="Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",i["idb-delete"]="Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",i["finalization-registry-not-supported"]="FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.",i["invalid-server-app-environment"]="FirebaseServerApp is not for use in browser environments.",i),I=new c.ErrorFactory("app","Firebase",x),S=function(){function e(e,t,n){var r=this;this._isDeleted=!1,this._options=o.__assign({},e),this._config=o.__assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.Component("app",(function(){return r}),"PUBLIC"))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed(),this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed(),this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.checkDestroyed(),this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){this._isDeleted=e},enumerable:!1,configurable:!0}),e.prototype.checkDestroyed=function(){if(this.isDeleted)throw I.create("app-deleted",{appName:this._name})},e}(),T=function(e){function t(t,n,r,i){var s=this,a=void 0!==n.automaticDataCollectionEnabled&&n.automaticDataCollectionEnabled,c={name:r,automaticDataCollectionEnabled:a};if(void 0!==t.apiKey)s=e.call(this,t,c,i)||this;else{var u=t;s=e.call(this,u.options,c,i)||this}return s._serverConfig=o.__assign({automaticDataCollectionEnabled:a},n),s._finalizationRegistry=new FinalizationRegistry((function(){s.automaticCleanup()})),s._refCount=0,s.incRefCount(s._serverConfig.releaseOnDeref),s._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,A(h,d,"serverapp"),s}return o.__extends(t,e),t.prototype.toJSON=function(){},Object.defineProperty(t.prototype,"refCount",{get:function(){return this._refCount},enumerable:!1,configurable:!0}),t.prototype.incRefCount=function(e){this.isDeleted||(this._refCount++,void 0!==e&&this._finalizationRegistry.register(e,this))},t.prototype.decRefCount=function(){return this.isDeleted?0:--this._refCount},t.prototype.automaticCleanup=function(){D(this)},Object.defineProperty(t.prototype,"settings",{get:function(){return this.checkDestroyed(),this._serverConfig},enumerable:!1,configurable:!0}),t.prototype.checkDestroyed=function(){if(this.isDeleted)throw I.create("server-app-deleted")},t}(S);function C(e,t){var n,r;void 0===t&&(t={});var i=e;"object"!=typeof t&&(t={name:t});var a=o.__assign({name:p,automaticDataCollectionEnabled:!1},t),u=a.name;if("string"!=typeof u||!u)throw I.create("bad-app-name",{appName:String(u)});if(i||(i=c.getDefaultAppConfig()),!i)throw I.create("no-options");var l=g.get(u);if(l){if(c.deepEqual(i,l.options)&&c.deepEqual(a,l.config))return l;throw I.create("duplicate-app",{appName:u})}var h=new s.ComponentContainer(u);try{for(var d=o.__values(v.values()),f=d.next();!f.done;f=d.next()){var m=f.value;h.addComponent(m)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var y=new S(i,a,h);return g.set(u,y),y}function D(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return t=!1,n=e.name,g.has(n)?(t=!0,g.delete(n)):y.has(n)&&e.decRefCount()<=0&&(y.delete(n),t=!0),t?[4,Promise.all(e.container.getProviders().map((function(e){return e.delete()})))]:[3,2];case 1:r.sent(),e.isDeleted=!0,r.label=2;case 2:return[2]}}))}))}function A(e,t,n){var r,i=null!==(r=m[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var c=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&c.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&c.push("and"),a&&c.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void f.warn(c.join(" "))}b(new s.Component("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}var k="firebase-heartbeat-database",N=1,O="firebase-heartbeat-store",P=null;function L(){return P||(P=u.openDB(k,N,{upgrade:function(e,t){if(0===t)try{e.createObjectStore(O)}catch(e){console.warn(e)}}}).catch((function(e){throw I.create("idb-open",{originalErrorMessage:e.message})}))),P}function M(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,L()];case 1:return t=o.sent(),[4,(n=t.transaction(O)).objectStore(O).get(F(e))];case 2:return r=o.sent(),[4,n.done];case 3:return o.sent(),[2,r];case 4:return(i=o.sent())instanceof c.FirebaseError?f.warn(i.message):(s=I.create("idb-get",{originalErrorMessage:null==i?void 0:i.message}),f.warn(s.message)),[3,5];case 5:return[2]}}))}))}function R(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,L()];case 1:return n=o.sent(),[4,(r=n.transaction(O,"readwrite")).objectStore(O).put(t,F(e))];case 2:return o.sent(),[4,r.done];case 3:return o.sent(),[3,5];case 4:return(i=o.sent())instanceof c.FirebaseError?f.warn(i.message):(s=I.create("idb-set",{originalErrorMessage:null==i?void 0:i.message}),f.warn(s.message)),[3,5];case 5:return[2]}}))}))}function F(e){return"".concat(e.name,"!").concat(e.options.appId)}var V=function(){function e(e){var t=this;this.container=e,this._heartbeatsCache=null;var n=this.container.getProvider("app").getImmediate();this._storage=new B(n),this._heartbeatsCachePromise=this._storage.read().then((function(e){return t._heartbeatsCache=e,e}))}return e.prototype.triggerHeartbeat=function(){var e,t;return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return n=this.container.getProvider("platform-logger").getImmediate(),r=n.getPlatformInfoString(),i=j(),null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)?[3,2]:(s=this,[4,this._heartbeatsCachePromise]);case 1:if(s._heartbeatsCache=o.sent(),null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return[2];o.label=2;case 2:return this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((function(e){return e.date===i}))?[2]:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),[2,this._storage.overwrite(this._heartbeatsCache)])}}))}))},e.prototype.getHeartbeatsHeader=function(){var e;return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,s;return o.__generator(this,(function(a){switch(a.label){case 0:return null!==this._heartbeatsCache?[3,2]:[4,this._heartbeatsCachePromise];case 1:a.sent(),a.label=2;case 2:return null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length?[2,""]:(t=j(),n=function(e,t){var n,r;void 0===t&&(t=1024);var i=[],s=e.slice(),a=function(e){var n=i.find((function(t){return t.agent===e.agent}));if(n){if(n.dates.push(e.date),U(i)>t)return n.dates.pop(),"break"}else if(i.push({agent:e.agent,dates:[e.date]}),U(i)>t)return i.pop(),"break";s=s.slice(1)};try{for(var c=o.__values(e),u=c.next();!u.done&&"break"!==a(u.value);u=c.next());}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return{heartbeatsToSend:i,unsentEntries:s}}(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,s=c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,[4,this._storage.overwrite(this._heartbeatsCache)]):[3,4]);case 3:return a.sent(),[3,5];case 4:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache),a.label=5;case 5:return[2,s]}}))}))},e}();function j(){return(new Date).toISOString().substring(0,10)}var B=function(){function e(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e.prototype.runIndexedDBEnvironmentCheck=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return c.isIndexedDBAvailable()?[2,c.validateIndexedDBOpenable().then((function(){return!0})).catch((function(){return!1}))]:[2,!1]}))}))},e.prototype.read=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return t.sent()?[3,2]:[2,{heartbeats:[]}];case 2:return[4,M(this.app)];case 3:return(null==(e=t.sent())?void 0:e.heartbeats)?[2,e]:[2,{heartbeats:[]}];case 4:return[2]}}))}))},e.prototype.overwrite=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,R(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})]}}))}))},e.prototype.add=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,R(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:o.__spreadArray(o.__spreadArray([],o.__read(n.heartbeats),!1),o.__read(e.heartbeats),!1)})]}}))}))},e}();function U(e){return c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}b(new s.Component("platform-logger",(function(e){return new l(e)}),"PRIVATE")),b(new s.Component("heartbeat",(function(e){return new V(e)}),"PRIVATE")),A(h,d,"node"),A(h,d,"cjs5"),A("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return c.FirebaseError}}),t.SDK_VERSION="10.11.1",t._DEFAULT_ENTRY_NAME=p,t._addComponent=w,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=g,t._clearComponents=function(){v.clear()},t._components=v,t._getProvider=_,t._isFirebaseApp=E,t._isFirebaseServerApp=function(e){return void 0!==e.settings},t._registerComponent=b,t._removeServiceInstance=function(e,t,n){void 0===n&&(n=p),_(e,t).clearInstance(n)},t._serverApps=y,t.deleteApp=D,t.getApp=function(e){void 0===e&&(e=p);var t=g.get(e);if(!t&&e===p&&c.getDefaultAppConfig())return C();if(!t)throw I.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(g.values())},t.initializeApp=C,t.initializeServerApp=function(e,t){var n,r,i;if(c.isBrowser())throw I.create("invalid-server-app-environment");void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1),i=E(e)?e.options:e;var a=o.__assign(o.__assign({},t),i);if(void 0!==a.releaseOnDeref&&delete a.releaseOnDeref,void 0!==t.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw I.create("finalization-registry-not-supported",{});var u,l=""+(u=JSON.stringify(a),o.__spreadArray([],o.__read(u),!1).reduce((function(e,t){return Math.imul(31,e)+t.charCodeAt(0)|0}),0)),h=y.get(l);if(h)return h.incRefCount(t.releaseOnDeref),h;var d=new s.ComponentContainer(l);try{for(var f=o.__values(v.values()),p=f.next();!p.done;p=f.next()){var m=p.value;d.addComponent(m)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var g=new T(i,t,l,d);return y.set(l,g),g},t.onLog=function(e,t){if(null!==e&&"function"!=typeof e)throw I.create("invalid-log-argument");a.setUserLogHandler(e,t)},t.registerVersion=A,t.setLogLevel=function(e){a.setLogLevel(e)}},5319:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1635),i=n(6336),s=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),o="[DEFAULT]",a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var a=r.__read(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=o),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spreadArray(r.__spreadArray([],r.__read(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),!1),r.__read(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()}))),!1))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=o),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=o),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,s=void 0===i?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error("".concat(this.name,"(").concat(o,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=r.__values(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=r.__read(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,s=this.onInitCallbacks.get(t);if(s)try{for(var o=r.__values(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===o?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=o),this.component?this.component.multipleInstances?e:o:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),c=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=s,t.ComponentContainer=c,t.Provider=a},1241:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6199),i=n(5319),s=n(5844),o=n(6336),a=n(3637);const c="@firebase/firestore";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let l="10.11.1";const h=new s.Logger("@firebase/firestore");function d(){return h.logLevel}function f(e,...t){if(h.logLevel<=s.LogLevel.DEBUG){const n=t.map(g);h.debug(`Firestore (${l}): ${e}`,...n)}}function p(e,...t){if(h.logLevel<=s.LogLevel.ERROR){const n=t.map(g);h.error(`Firestore (${l}): ${e}`,...n)}}function m(e,...t){if(h.logLevel<=s.LogLevel.WARN){const n=t.map(g);h.warn(`Firestore (${l}): ${e}`,...n)}}function g(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function y(e="Unexpected state"){const t=`FIRESTORE (${l}) INTERNAL ASSERTION FAILED: `+e;throw p(t),new Error(t)}function v(e,t){e||y()}function w(e,t){return e}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _ extends o.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class E{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class x{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(u.UNAUTHENTICATED)))}shutdown(){}}class S{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class T{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new E;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new E,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{f("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(f("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new E)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(f("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(v("string"==typeof t.accessToken),new x(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return v(null===e||"string"==typeof e),new u(e)}}class C{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class D{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new C(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(u.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class A{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&f("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,f("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{f("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):f("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(v("string"==typeof e.token),this.R=e.token,new A(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function N(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class O{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=N(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function P(e,t){return e<t?-1:e>t?1:0}function L(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function M(e){return e+"\0"}class R{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return R.fromMillis(Date.now())}static fromDate(e){return R.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new R(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?P(this.nanoseconds,e.nanoseconds):P(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class F{constructor(e){this.timestamp=e}static fromTimestamp(e){return new F(e)}static min(){return new F(new R(0,0))}static max(){return new F(new R(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class V{constructor(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===V.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof V?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class j extends V{construct(e,t,n){return new j(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new j(t)}static emptyPath(){return new j([])}}const B=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class U extends V{construct(e,t,n){return new U(e,t,n)}static isValidIdentifier(e){return B.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),U.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new U(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new _(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new _(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new U(t)}static emptyPath(){return new U([])}}class q{constructor(e){this.path=e}static fromPath(e){return new q(j.fromString(e))}static fromName(e){return new q(j.fromString(e).popFirst(5))}static empty(){return new q(j.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===j.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return j.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new q(new j(e.slice()))}}class z{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function G(e){return e.fields.find((e=>2===e.kind))}function K(e){return e.fields.filter((e=>2!==e.kind))}function $(e,t){let n=P(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=Q(e.fields[r],t.fields[r]),0!==n)return n;return P(e.fields.length,t.fields.length)}z.UNKNOWN_ID=-1;class H{constructor(e,t){this.fieldPath=e,this.kind=t}}function Q(e,t){const n=U.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:P(e.kind,t.kind)}class W{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new W(0,X.min())}}function J(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=F.fromTimestamp(1e9===r?new R(n+1,0):new R(n,r));return new X(i,q.empty(),t)}function Y(e){return new X(e.readTime,e.key,-1)}class X{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new X(F.min(),q.empty(),-1)}static max(){return new X(F.max(),q.empty(),-1)}}function Z(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=q.comparator(e.documentKey,t.documentKey),0!==n?n:P(e.largestBatchId,t.largestBatchId))}const ee="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ne(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==ee)throw e;f("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(e){return re.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,n)=>{t(e)}))}static reject(e){return new re(((t,n)=>{n(e)}))}static waitFor(e){return new re(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=re.resolve(!1);for(const n of e)t=t.next((e=>e?re.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new re(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new re(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class ie{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new E,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ce(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=fe(t.target.error);this.V.reject(new ce(e,n))}}static open(e,t,n,r){try{return new ie(t,e.transaction(r,n))}catch(e){throw new ce(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(f("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new le(t)}}class se{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===se.S(o.getUA())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return f("SimpleDb","Removing database:",e),he(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!o.isIndexedDBAvailable())return!1;if(se.C())return!0;const e=o.getUA(),t=se.S(e),n=0<t&&t<10,r=oe(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.v)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(f("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ce(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new _(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new _(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ce(e,r))},r.onupgradeneeded=e=>{f("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,r.transaction,e.oldVersion,this.version).next((()=>{f("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.M(e);const t=ie.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),re.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(f("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function oe(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ae{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return he(this.B.delete())}}class ce extends _{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ue(e){return"IndexedDbTransactionError"===e.name}class le{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(f("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(f("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),he(n)}add(e){return f("SimpleDb","ADD",this.store.name,e,e),he(this.store.add(e))}get(e){return he(this.store.get(e)).next((t=>(void 0===t&&(t=null),f("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return f("SimpleDb","DELETE",this.store.name,e),he(this.store.delete(e))}count(){return f("SimpleDb","COUNT",this.store.name),he(this.store.count())}U(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new re(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.W(e,((e,n)=>{t.push(n)})).next((()=>t))}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new re(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}j(e,t){f("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.W(r,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Y(e){const t=this.cursor({});return new re(((n,r)=>{t.onerror=e=>{const t=fe(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}W(e,t){const n=[];return new re(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new ae(i),o=t(i.primaryKey,i.value,s);if(o instanceof re){const e=o.catch((e=>(s.done(),re.reject(e))));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}})).next((()=>re.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function he(e){return new re(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=fe(e.target.error);n(t)}}))}let de=!1;function fe(e){const t=se.S(o.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new _("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return de||(de=!0,setTimeout((()=>{throw e}),0)),e}}return e}class pe{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){f("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{f("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){ue(e)?f("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await ne(e)}await this.X(6e4)}))}}class me{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const n=new Set;let r=t,i=!0;return re.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return f("IndexBackfiller",`Processing collection: ${t}`),this.ne(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.re(r,n))).next((n=>(f("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}re(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Y(t);Z(r,n)>0&&(n=r)})),new X(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ge{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function ye(e){return null==e}function ve(e){return 0===e&&1/e==-1/0}function we(e){return"number"==typeof e&&Number.isInteger(e)&&!ve(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function be(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ee(t)),t=_e(e.get(n),t);return Ee(t)}function _e(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Ee(e){return e+""}function xe(e){const t=e.length;if(v(t>=2),2===t)return v(""===e.charAt(0)&&""===e.charAt(1)),j.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&y(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:y()}s=t+2}return new j(r)}ge.oe=-1;const Ie=["userId","batchId"];function Se(e,t){return[e,be(t)]}function Te(e,t,n){return[e,be(t),n]}const Ce={},De=["prefixPath","collectionGroup","readTime","documentId"],Ae=["prefixPath","collectionGroup","documentId"],ke=["collectionGroup","readTime","prefixPath","documentId"],Ne=["canonicalId","targetId"],Oe=["targetId","path"],Pe=["path","targetId"],Le=["collectionId","parent"],Me=["indexId","uid"],Re=["uid","sequenceNumber"],Fe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ve=["indexId","uid","orderedDocumentKey"],je=["userId","collectionPath","documentId"],Be=["userId","collectionPath","largestBatchId"],Ue=["userId","collectionGroup","largestBatchId"],qe=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ze=[...qe,"documentOverlays"],Ge=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ke=Ge,$e=[...Ke,"indexConfiguration","indexState","indexEntries"],He=$e;class Qe extends te{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function We(e,t){const n=w(e);return se.F(n._e,t)}function Je(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ye(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Xe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ze{constructor(e,t){this.comparator=e,this.root=t||tt.EMPTY}insert(e,t){return new Ze(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tt.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new et(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new et(this.root,e,this.comparator,!1)}getReverseIterator(){return new et(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new et(this.root,e,this.comparator,!0)}}class et{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tt{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:tt.RED,this.left=null!=r?r:tt.EMPTY,this.right=null!=i?i:tt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new tt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return tt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return tt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw y();if(this.right.isRed())throw y();const e=this.left.check();if(e!==this.right.check())throw y();return e+(this.isRed()?0:1)}}tt.EMPTY=null,tt.RED=!0,tt.BLACK=!1,tt.EMPTY=new class{constructor(){this.size=0}get key(){throw y()}get value(){throw y()}get color(){throw y()}get left(){throw y()}get right(){throw y()}copy(e,t,n,r,i){return this}insert(e,t,n){return new tt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class nt{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rt(this.data.getIterator())}getIteratorFrom(e){return new rt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof nt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new nt(this.comparator);return t.data=e,t}}class rt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function it(e){return e.hasNext()?e.getNext():void 0}class st{constructor(e){this.fields=e,e.sort(U.comparator)}static empty(){return new st([])}unionWith(e){let t=new nt(U.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new st(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return L(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class ot extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class at{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new ot("Invalid base64 string: "+e):e}}(e);return new at(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new at(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return P(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const ct=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ut(e){if(v(!!e),"string"==typeof e){let t=0;const n=ct.exec(e);if(v(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:lt(e.seconds),nanos:lt(e.nanos)}}function lt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ht(e){return"string"==typeof e?at.fromBase64String(e):at.fromUint8Array(e)}function dt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ft(e){const t=e.mapValue.fields.__previous_value__;return dt(t)?ft(t):t}function pt(e){const t=ut(e.mapValue.fields.__local_write_time__.timestampValue);return new R(t.seconds,t.nanos)}class mt{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class gt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new gt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof gt&&e.projectId===this.projectId&&e.database===this.database}}const yt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},vt={nullValue:"NULL_VALUE"};function wt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?dt(e)?4:Lt(e)?9007199254740991:10:y()}function bt(e,t){if(e===t)return!0;const n=wt(e);if(n!==wt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return pt(e).isEqual(pt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ut(e.timestampValue),r=ut(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ht(e.bytesValue).isEqual(ht(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return lt(e.geoPointValue.latitude)===lt(t.geoPointValue.latitude)&&lt(e.geoPointValue.longitude)===lt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return lt(e.integerValue)===lt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=lt(e.doubleValue),r=lt(t.doubleValue);return n===r?ve(n)===ve(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return L(e.arrayValue.values||[],t.arrayValue.values||[],bt);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Je(n)!==Je(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!bt(n[e],r[e])))return!1;return!0}(e,t);default:return y()}}function _t(e,t){return void 0!==(e.values||[]).find((e=>bt(e,t)))}function Et(e,t){if(e===t)return 0;const n=wt(e),r=wt(t);if(n!==r)return P(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return P(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=lt(e.integerValue||e.doubleValue),r=lt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return xt(e.timestampValue,t.timestampValue);case 4:return xt(pt(e),pt(t));case 5:return P(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ht(e),r=ht(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=P(n[e],r[e]);if(0!==t)return t}return P(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=P(lt(e.latitude),lt(t.latitude));return 0!==n?n:P(lt(e.longitude),lt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=Et(n[e],r[e]);if(t)return t}return P(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===yt.mapValue&&t===yt.mapValue)return 0;if(e===yt.mapValue)return 1;if(t===yt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=P(r[e],s[e]);if(0!==t)return t;const o=Et(n[r[e]],i[s[e]]);if(0!==o)return o}return P(r.length,s.length)}(e.mapValue,t.mapValue);default:throw y()}}function xt(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return P(e,t);const n=ut(e),r=ut(t),i=P(n.seconds,r.seconds);return 0!==i?i:P(n.nanos,r.nanos)}function It(e){return St(e)}function St(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ut(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ht(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return q.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=St(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${St(e.fields[i])}`;return n+"}"}(e.mapValue):y()}function Tt(e){switch(wt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ft(e);return t?16+Tt(t):16;case 5:return 2*e.stringValue.length;case 6:return ht(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Tt(t)),0)}(e.arrayValue);case 10:return function(e){let t=0;return Ye(e.fields,((e,n)=>{t+=e.length+Tt(n)})),t}(e.mapValue);default:throw y()}}function Ct(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Dt(e){return!!e&&"integerValue"in e}function At(e){return!!e&&"arrayValue"in e}function kt(e){return!!e&&"nullValue"in e}function Nt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ot(e){return!!e&&"mapValue"in e}function Pt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ye(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Pt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Pt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Lt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Mt(e){return"nullValue"in e?vt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Ct(gt.empty(),q.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:y()}function Rt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Ct(gt.empty(),q.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?yt:y()}function Ft(e,t){const n=Et(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Vt(e,t){const n=Et(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class jt{constructor(e){this.value=e}static empty(){return new jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ot(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pt(t)}setAll(e){let t=U.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Pt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Ot(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return bt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ot(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ye(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new jt(Pt(this.value))}}function Bt(e){const t=[];return Ye(e.fields,((e,n)=>{const r=new U([e]);if(Ot(n)){const e=Bt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new st(t)}class Ut{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ut(e,0,F.min(),F.min(),F.min(),jt.empty(),0)}static newFoundDocument(e,t,n,r){return new Ut(e,1,t,F.min(),n,r,0)}static newNoDocument(e,t){return new Ut(e,2,t,F.min(),F.min(),jt.empty(),0)}static newUnknownDocument(e,t){return new Ut(e,3,t,F.min(),F.min(),jt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(F.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=F.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qt{constructor(e,t){this.position=e,this.inclusive=t}}function zt(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?q.comparator(q.fromName(o.referenceValue),n.key):Et(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Gt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!bt(e.position[n],t.position[n]))return!1;return!0}class Kt{constructor(e,t="asc"){this.field=e,this.dir=t}}function $t(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ht{}class Qt extends Ht{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new sn(e,t,n):"array-contains"===t?new un(e,n):"in"===t?new ln(e,n):"not-in"===t?new hn(e,n):"array-contains-any"===t?new dn(e,n):new Qt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new on(e,n):new an(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Et(t,this.value)):null!==t&&wt(this.value)===wt(t)&&this.matchesComparison(Et(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wt extends Ht{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Wt(e,t)}matches(e){return Jt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Jt(e){return"and"===e.op}function Yt(e){return"or"===e.op}function Xt(e){return Zt(e)&&Jt(e)}function Zt(e){for(const t of e.filters)if(t instanceof Wt)return!1;return!0}function en(e){if(e instanceof Qt)return e.field.canonicalString()+e.op.toString()+It(e.value);if(Xt(e))return e.filters.map((e=>en(e))).join(",");{const t=e.filters.map((e=>en(e))).join(",");return`${e.op}(${t})`}}function tn(e,t){return e instanceof Qt?function(e,t){return t instanceof Qt&&e.op===t.op&&e.field.isEqual(t.field)&&bt(e.value,t.value)}(e,t):e instanceof Wt?function(e,t){return t instanceof Wt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&tn(n,t.filters[r])),!0)}(e,t):void y()}function nn(e,t){const n=e.filters.concat(t);return Wt.create(n,e.op)}function rn(e){return e instanceof Qt?function(e){return`${e.field.canonicalString()} ${e.op} ${It(e.value)}`}(e):e instanceof Wt?function(e){return e.op.toString()+" {"+e.getFilters().map(rn).join(" ,")+"}"}(e):"Filter"}class sn extends Qt{constructor(e,t,n){super(e,t,n),this.key=q.fromName(n.referenceValue)}matches(e){const t=q.comparator(e.key,this.key);return this.matchesComparison(t)}}class on extends Qt{constructor(e,t){super(e,"in",t),this.keys=cn(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class an extends Qt{constructor(e,t){super(e,"not-in",t),this.keys=cn(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function cn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>q.fromName(e.referenceValue)))}class un extends Qt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return At(t)&&_t(t.arrayValue,this.value)}}class ln extends Qt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&_t(this.value.arrayValue,t)}}class hn extends Qt{constructor(e,t){super(e,"not-in",t)}matches(e){if(_t(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!_t(this.value.arrayValue,t)}}class dn extends Qt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!At(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>_t(this.value.arrayValue,e)))}}class fn{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function pn(e,t=null,n=[],r=[],i=null,s=null,o=null){return new fn(e,t,n,r,i,s,o)}function mn(e){const t=w(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>en(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ye(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>It(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>It(e))).join(",")),t.ue=e}return t.ue}function gn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!$t(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!tn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Gt(e.startAt,t.startAt)&&Gt(e.endAt,t.endAt)}function yn(e){return q.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function vn(e,t){return e.filters.filter((e=>e instanceof Qt&&e.field.isEqual(t)))}function wn(e,t,n){let r=vt,i=!0;for(const n of vn(e,t)){let e=vt,t=!0;switch(n.op){case"<":case"<=":e=Mt(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=vt}Ft({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Ft({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function bn(e,t,n){let r=yt,i=!0;for(const n of vn(e,t)){let e=yt,t=!0;switch(n.op){case">=":case">":e=Rt(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=yt}Vt({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Vt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class _n{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function En(e,t,n,r,i,s,o,a){return new _n(e,t,n,r,i,s,o,a)}function xn(e){return new _n(e)}function In(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Sn(e){return null!==e.collectionGroup}function Tn(e){const t=w(e);if(null===t.ce){t.ce=[];const e=new Set;for(const n of t.explicitOrderBy)t.ce.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new nt(U.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Kt(r,n))})),e.has(U.keyField().canonicalString())||t.ce.push(new Kt(U.keyField(),n))}return t.ce}function Cn(e){const t=w(e);return t.le||(t.le=Dn(t,Tn(e))),t.le}function Dn(e,t){if("F"===e.limitType)return pn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Kt(e.field,t)}));const n=e.endAt?new qt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new qt(e.startAt.position,e.startAt.inclusive):null;return pn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function An(e,t){const n=e.filters.concat([t]);return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function kn(e,t,n){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Nn(e,t){return gn(Cn(e),Cn(t))&&e.limitType===t.limitType}function On(e){return`${mn(Cn(e))}|lt:${e.limitType}`}function Pn(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>rn(e))).join(", ")}]`),ye(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>It(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>It(e))).join(",")),`Target(${t})`}(Cn(e))}; limitType=${e.limitType})`}function Ln(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):q.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Tn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=zt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Tn(e),t)||e.endAt&&!function(e,t,n){const r=zt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Tn(e),t))}(e,t)}function Mn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Rn(e){return(t,n)=>{let r=!1;for(const i of Tn(e)){const e=Fn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Fn(e,t,n){const r=e.field.isKeyField()?q.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Et(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}class Vn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ye(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Xe(this.inner)}size(){return this.innerSize}}const jn=new Ze(q.comparator);function Bn(){return jn}const Un=new Ze(q.comparator);function qn(...e){let t=Un;for(const n of e)t=t.insert(n.key,n);return t}function zn(e){let t=Un;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Gn(){return $n()}function Kn(){return $n()}function $n(){return new Vn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Hn=new Ze(q.comparator),Qn=new nt(q.comparator);function Wn(...e){let t=Qn;for(const n of e)t=t.add(n);return t}const Jn=new nt(P);function Yn(){return Jn}function Xn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ve(t)?"-0":t}}function Zn(e){return{integerValue:""+e}}function er(e,t){return we(t)?Zn(t):Xn(e,t)}class tr{constructor(){this._=void 0}}function nr(e,t,n){return e instanceof sr?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&dt(t)&&(t=ft(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof or?ar(e,t):e instanceof cr?ur(e,t):function(e,t){const n=ir(e,t),r=hr(n)+hr(e.Pe);return Dt(n)&&Dt(e.Pe)?Zn(r):Xn(e.serializer,r)}(e,t)}function rr(e,t,n){return e instanceof or?ar(e,t):e instanceof cr?ur(e,t):n}function ir(e,t){return e instanceof lr?function(e){return Dt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class sr extends tr{}class or extends tr{constructor(e){super(),this.elements=e}}function ar(e,t){const n=dr(t);for(const t of e.elements)n.some((e=>bt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class cr extends tr{constructor(e){super(),this.elements=e}}function ur(e,t){let n=dr(t);for(const t of e.elements)n=n.filter((e=>!bt(e,t)));return{arrayValue:{values:n}}}class lr extends tr{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function hr(e){return lt(e.integerValue||e.doubleValue)}function dr(e){return At(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class fr{constructor(e,t){this.field=e,this.transform=t}}class pr{constructor(e,t){this.version=e,this.transformResults=t}}class mr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new mr}static exists(e){return new mr(void 0,e)}static updateTime(e){return new mr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class yr{}function vr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Dr(e.key,mr.none()):new xr(e.key,e.data,mr.none());{const n=e.data,r=jt.empty();let i=new nt(U.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ir(e.key,r,new st(i.toArray()),mr.none())}}function wr(e,t,n){e instanceof xr?function(e,t,n){const r=e.value.clone(),i=Tr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ir?function(e,t,n){if(!gr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Tr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Sr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function br(e,t,n,r){return e instanceof xr?function(e,t,n,r){if(!gr(e.precondition,t))return n;const i=e.value.clone(),s=Cr(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ir?function(e,t,n,r){if(!gr(e.precondition,t))return n;const i=Cr(e.fieldTransforms,r,t),s=t.data;return s.setAll(Sr(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return gr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function _r(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=ir(r.transform,e||null);null!=i&&(null===n&&(n=jt.empty()),n.set(r.field,i))}return n||null}function Er(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&L(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof or&&t instanceof or||e instanceof cr&&t instanceof cr?L(e.elements,t.elements,bt):e instanceof lr&&t instanceof lr?bt(e.Pe,t.Pe):e instanceof sr&&t instanceof sr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class xr extends yr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ir extends yr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Sr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Tr(e,t,n){const r=new Map;v(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,rr(o,a,n[i]))}return r}function Cr(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,nr(e,s,t))}return r}class Dr extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ar extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class kr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&wr(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=br(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=br(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Kn();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=vr(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(F.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Wn())}isEqual(e){return this.batchId===e.batchId&&L(this.mutations,e.mutations,((e,t)=>Er(e,t)))&&L(this.baseMutations,e.baseMutations,((e,t)=>Er(e,t)))}}class Nr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){v(e.mutations.length===n.length);let r=Hn;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new Nr(e,t,n,r)}}class Or{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Pr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Lr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Mr,Rr;function Fr(e){switch(e){default:return y();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function Vr(e){if(void 0===e)return p("GRPC error has no .code"),b.UNKNOWN;switch(e){case Mr.OK:return b.OK;case Mr.CANCELLED:return b.CANCELLED;case Mr.UNKNOWN:return b.UNKNOWN;case Mr.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Mr.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Mr.INTERNAL:return b.INTERNAL;case Mr.UNAVAILABLE:return b.UNAVAILABLE;case Mr.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Mr.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Mr.NOT_FOUND:return b.NOT_FOUND;case Mr.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Mr.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Mr.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Mr.ABORTED:return b.ABORTED;case Mr.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Mr.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Mr.DATA_LOSS:return b.DATA_LOSS;default:return y()}}(Rr=Mr||(Mr={}))[Rr.OK=0]="OK",Rr[Rr.CANCELLED=1]="CANCELLED",Rr[Rr.UNKNOWN=2]="UNKNOWN",Rr[Rr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rr[Rr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rr[Rr.NOT_FOUND=5]="NOT_FOUND",Rr[Rr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rr[Rr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rr[Rr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rr[Rr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rr[Rr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rr[Rr.ABORTED=10]="ABORTED",Rr[Rr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rr[Rr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rr[Rr.INTERNAL=13]="INTERNAL",Rr[Rr.UNAVAILABLE=14]="UNAVAILABLE",Rr[Rr.DATA_LOSS=15]="DATA_LOSS";let jr=null;function Br(){return new TextEncoder}const Ur=new a.Integer([4294967295,4294967295],0);function qr(e){const t=Br().encode(e),n=new a.Md5;return n.update(t),new Uint8Array(n.digest())}function zr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new a.Integer([n,r],0),new a.Integer([i,s],0)]}class Gr{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Kr(`Invalid padding: ${t}`);if(n<0)throw new Kr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Kr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Kr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=a.Integer.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(a.Integer.fromNumber(n)));return 1===r.compare(Ur)&&(r=new a.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=qr(e),[n,r]=zr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ee(n,r,e);if(!this.de(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Gr(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=qr(e),[n,r]=zr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ee(n,r,e);this.Ae(t)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Kr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class $r{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Hr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new $r(F.min(),r,new Ze(P),Bn(),Wn())}}class Hr{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Hr(n,t,Wn(),Wn(),Wn())}}class Qr{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Wr{constructor(e,t){this.targetId=e,this.me=t}}class Jr{constructor(e,t,n=at.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Yr{constructor(){this.fe=0,this.ge=ei(),this.pe=at.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Wn(),t=Wn(),n=Wn();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}})),new Hr(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=ei()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,v(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Xr{constructor(e){this.Le=e,this.Be=new Map,this.ke=Bn(),this.qe=Zr(),this.Qe=new Ze(P)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:y()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(yn(i))if(0===n){const e=new q(i.path);this.Ue(t,e,Ut.newNoDocument(e,F.min()))}else v(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==jr||jr.et(function(e,t,n,r,i){var s,o,a,c,u,l;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(l=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=ht(n).toUint8Array()}catch(e){if(e instanceof ot)return m("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Gr(s,r,i)}catch(e){return m(e instanceof Kr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&yn(i.target)){const t=new q(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Ut.newNoDocument(t,e))}n.be&&(t.set(r,n.Ce()),n.ve())}}));let n=Wn();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new $r(e,t,this.Qe,this.ke,n);return this.ke=Bn(),this.qe=Zr(),this.Qe=new Ze(P),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Yr,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new nt(P),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||f("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Yr),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Zr(){return new Ze(q.comparator)}function ei(){return new Ze(q.comparator)}const ti={asc:"ASCENDING",desc:"DESCENDING"},ni={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ri={and:"AND",or:"OR"};class ii{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function si(e,t){return e.useProto3Json||ye(t)?t:{value:t}}function oi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function ai(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ci(e,t){return oi(e,t.toTimestamp())}function ui(e){return v(!!e),F.fromTimestamp(function(e){const t=ut(e);return new R(t.seconds,t.nanos)}(e))}function li(e,t){return hi(e,t).canonicalString()}function hi(e,t){const n=function(e){return new j(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function di(e){const t=j.fromString(e);return v(Li(t)),t}function fi(e,t){return li(e.databaseId,t.path)}function pi(e,t){const n=di(t);if(n.get(1)!==e.databaseId.projectId)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new q(vi(n))}function mi(e,t){return li(e.databaseId,t)}function gi(e){const t=di(e);return 4===t.length?j.emptyPath():vi(t)}function yi(e){return new j(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function vi(e){return v(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function wi(e,t,n){return{name:fi(e,t),fields:n.value.mapValue.fields}}function bi(e,t,n){const r=pi(e,t.name),i=ui(t.updateTime),s=t.createTime?ui(t.createTime):F.min(),o=new jt({mapValue:{fields:t.fields}}),a=Ut.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function _i(e,t){let n;if(t instanceof xr)n={update:wi(e,t.key,t.value)};else if(t instanceof Dr)n={delete:fi(e,t.key)};else if(t instanceof Ir)n={update:wi(e,t.key,t.data),updateMask:Pi(t.fieldMask)};else{if(!(t instanceof Ar))return y();n={verify:fi(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof sr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof or)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof lr)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw y()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ci(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.precondition)),n}function Ei(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?mr.updateTime(ui(e.updateTime)):void 0!==e.exists?mr.exists(e.exists):mr.none()}(t.currentDocument):mr.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue),n=new sr;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new or(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new cr(e)}else"increment"in t?n=new lr(e,t.increment):y();const r=U.fromServerFormat(t.fieldPath);return new fr(r,n)}(e,t))):[];if(t.update){t.update.name;const i=pi(e,t.update.name),s=new jt({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new st(t.map((e=>U.fromServerFormat(e))))}(t.updateMask);return new Ir(i,s,e,n,r)}return new xr(i,s,n,r)}if(t.delete){const r=pi(e,t.delete);return new Dr(r,n)}if(t.verify){const r=pi(e,t.verify);return new Ar(r,n)}return y()}function xi(e,t){return{documents:[mi(e,t.path)]}}function Ii(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=mi(e,i);const s=function(e){if(0!==e.length)return Oi(Wt.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:ki(e.field),direction:Ci(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=si(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Si(e){let t=gi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){v(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ti(e);return t instanceof Wt&&Xt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Kt(Ni(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ye(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new qt(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new qt(n,t)}(n.endAt)),En(t,i,o,s,a,"F",c,u)}function Ti(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ni(e.unaryFilter.field);return Qt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ni(e.unaryFilter.field);return Qt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ni(e.unaryFilter.field);return Qt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ni(e.unaryFilter.field);return Qt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return y()}}(e):void 0!==e.fieldFilter?function(e){return Qt.create(Ni(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Wt.create(e.compositeFilter.filters.map((e=>Ti(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return y()}}(e.compositeFilter.op))}(e):y()}function Ci(e){return ti[e]}function Di(e){return ni[e]}function Ai(e){return ri[e]}function ki(e){return{fieldPath:e.canonicalString()}}function Ni(e){return U.fromServerFormat(e.fieldPath)}function Oi(e){return e instanceof Qt?function(e){if("=="===e.op){if(Nt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NAN"}};if(kt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Nt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NOT_NAN"}};if(kt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ki(e.field),op:Di(e.op),value:e.value}}}(e):e instanceof Wt?function(e){const t=e.getFilters().map((e=>Oi(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ai(e.op),filters:t}}}(e):y()}function Pi(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Li(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Mi{constructor(e,t,n,r,i=F.min(),s=F.min(),o=at.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ri{constructor(e){this.ut=e}}function Fi(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Vi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:fi(e,t.key),fields:t.data.value.mapValue.fields,updateTime:oi(e,t.version.toTimestamp()),createTime:oi(e,t.createTime.toTimestamp())}}(e.ut,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ji(t.version)};else{if(!t.isUnknownDocument())return y();r.unknownDocument={path:n.path.toArray(),version:ji(t.version)}}return r}function Vi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ji(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Bi(e){const t=new R(e.seconds,e.nanoseconds);return F.fromTimestamp(t)}function Ui(e,t){const n=(t.baseMutations||[]).map((t=>Ei(e.ut,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>Ei(e.ut,t))),i=R.fromMillis(t.localWriteTimeMs);return new kr(t.batchId,i,n,r)}function qi(e){const t=Bi(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Bi(e.lastLimboFreeSnapshotVersion):F.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return v(1===e.documents.length),Cn(xn(gi(e.documents[0])))}(e.query):function(e){return Cn(Si(e))}(e.query),new Mi(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,at.fromBase64String(e.resumeToken))}function zi(e,t){const n=ji(t.snapshotVersion),r=ji(t.lastLimboFreeSnapshotVersion);let i;i=yn(t.target)?xi(e.ut,t.target):Ii(e.ut,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:mn(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Gi(e){const t=Si({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?kn(t,t.limit,"L"):t}function Ki(e,t){return new Or(t.largestBatchId,Ei(e.ut,t.overlayMutation))}function $i(e,t){const n=t.path.lastSegment();return[e,be(t.path.popLast()),n]}function Hi(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:ji(r.readTime),documentKey:be(r.documentKey.path),largestBatchId:r.largestBatchId}}class Qi{getBundleMetadata(e,t){return Wi(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Bi(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Wi(e).put(function(e){return{bundleId:e.id,createTime:ji(ui(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Ji(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Gi(e.bundledQuery),readTime:Bi(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Ji(e).put(function(e){return{name:e.name,readTime:ji(ui(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Wi(e){return We(e,"bundles")}function Ji(e){return We(e,"namedQueries")}class Yi{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const n=t.uid||"";return new Yi(e,n)}getOverlay(e,t){return Xi(e).get($i(this.userId,t)).next((e=>e?Ki(this.serializer,e):null))}getOverlays(e,t){const n=Gn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new Or(t,i);r.push(this.lt(e,s))})),re.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(be(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Xi(e).j("collectionPathOverlayIndex",r))})),re.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Gn(),i=be(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Xi(e).U("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=Ki(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Gn();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xi(e).J({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=Ki(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}lt(e,t){return Xi(e).put(function(e,t,n){const[r,i,s]=$i(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:_i(e.ut,n.mutation)}}(this.serializer,this.userId,t))}}function Xi(e){return We(e,"documentOverlays")}class Zi{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(lt(e.integerValue));else if("doubleValue"in e){const n=lt(e.doubleValue);isNaN(n)?this.Tt(t,13):(this.Tt(t,15),ve(n)?t.Et(0):t.Et(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Tt(t,20),"string"==typeof n&&(n=ut(n)),t.dt(`${n.seconds||""}`),t.Et(n.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(ht(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Tt(t,45),t.Et(n.latitude||0),t.Et(n.longitude||0)}else"mapValue"in e?Lt(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):y()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const n=e.fields||{};this.Tt(t,55);for(const e of Object.keys(n))this.At(e,t),this.Pt(n[e],t)}yt(e,t){const n=e.values||[];this.Tt(t,50);for(const e of n)this.Pt(e,t)}ft(e,t){this.Tt(t,37),q.fromName(e).path.forEach((e=>{this.Tt(t,60),this.wt(e,t)}))}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function es(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function ts(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=es(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Zi.St=new Zi;class ns{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Dt(n.value),n=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Dt(e);else if(e<2048)this.Dt(960|e>>>6),this.Dt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|e>>>12),this.Dt(128|63&e>>>6),this.Dt(128|63&e);else{const e=t.codePointAt(0);this.Dt(240|e>>>18),this.Dt(128|63&e>>>12),this.Dt(128|63&e>>>6),this.Dt(128|63&e)}}this.Ct()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Nt(e){const t=this.Lt(e),n=ts(t);this.Bt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}kt(e){const t=this.Lt(e),n=ts(t);this.Bt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class rs{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class is{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class ss{constructor(){this.Wt=new ns,this.Gt=new rs(this.Wt),this.zt=new is(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class os{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new os(this.indexId,this.documentKey,this.arrayValue,n)}}function as(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=cs(e.arrayValue,t.arrayValue),0!==n?n:(n=cs(e.directionalValue,t.directionalValue),0!==n?n:q.comparator(e.documentKey,t.documentKey)))}function cs(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class us{constructor(e){this.Jt=new nt(((e,t)=>U.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Jt=this.Jt.add(e):this.Zt.push(e)}}get Xt(){return this.Jt.size>1}en(e){if(v(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=G(e);if(void 0!==t&&!this.tn(t))return!1;const n=K(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.tn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Jt.size>0){const e=this.Jt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.nn(e,t)||!this.rn(this.Yt[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Yt.length||!this.rn(this.Yt[s++],e))return!1}return!0}sn(){if(this.Xt)return null;let e=new nt(U.comparator);const t=[];for(const n of this.Zt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new H(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new H(n.field,0))}for(const n of this.Yt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new H(n.field,"asc"===n.dir?0:1)));return new z(z.UNKNOWN_ID,this.collectionId,t,W.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function ls(e){var t,n;if(v(e instanceof Qt||e instanceof Wt),e instanceof Qt){if(e instanceof ln){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Qt.create(e.field,"==",t))))||[];return Wt.create(r,"or")}return e}const r=e.filters.map((e=>ls(e)));return Wt.create(r,e.op)}function hs(e){if(0===e.getFilters().length)return[];const t=ms(ls(e));return v(ps(t)),ds(t)||fs(t)?[t]:t.getFilters()}function ds(e){return e instanceof Qt}function fs(e){return e instanceof Wt&&Xt(e)}function ps(e){return ds(e)||fs(e)||function(e){if(e instanceof Wt&&Yt(e)){for(const t of e.getFilters())if(!ds(t)&&!fs(t))return!1;return!0}return!1}(e)}function ms(e){if(v(e instanceof Qt||e instanceof Wt),e instanceof Qt)return e;if(1===e.filters.length)return ms(e.filters[0]);const t=e.filters.map((e=>ms(e)));let n=Wt.create(t,e.op);return n=vs(n),ps(n)?n:(v(n instanceof Wt),v(Jt(n)),v(n.filters.length>1),n.filters.reduce(((e,t)=>gs(e,t))))}function gs(e,t){let n;return v(e instanceof Qt||e instanceof Wt),v(t instanceof Qt||t instanceof Wt),n=e instanceof Qt?t instanceof Qt?function(e,t){return Wt.create([e,t],"and")}(e,t):ys(e,t):t instanceof Qt?ys(t,e):function(e,t){if(v(e.filters.length>0&&t.filters.length>0),Jt(e)&&Jt(t))return nn(e,t.getFilters());const n=Yt(e)?e:t,r=Yt(e)?t:e,i=n.filters.map((e=>gs(e,r)));return Wt.create(i,"or")}(e,t),vs(n)}function ys(e,t){if(Jt(t))return nn(t,e.getFilters());{const n=t.filters.map((t=>gs(e,t)));return Wt.create(n,"or")}}function vs(e){if(v(e instanceof Qt||e instanceof Wt),e instanceof Qt)return e;const t=e.getFilters();if(1===t.length)return vs(t[0]);if(Zt(e))return e;const n=t.map((e=>vs(e))),r=[];return n.forEach((t=>{t instanceof Qt?r.push(t):t instanceof Wt&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Wt.create(r,e.op)}class ws{constructor(){this.on=new bs}addToCollectionParentIndex(e,t){return this.on.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(X.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(X.min())}updateCollectionGroup(e,t,n){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class bs{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new nt(j.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new nt(j.comparator)).toArray()}}const _s=new Uint8Array(0);class Es{constructor(e,t){this.databaseId=t,this._n=new bs,this.an=new Vn((e=>mn(e)),((e,t)=>gn(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this._n.add(t)}));const i={collectionId:n,parent:be(r)};return xs(e).put(i)}return re.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[M(t),""],!1,!0);return xs(e).U(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(xe(r.parent))}return n}))}addFieldIndex(e,t){const n=Ss(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Ts(e);return i.next((e=>{n.put(Hi(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=Ss(e),r=Ts(e),i=Is(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Ss(e),n=Is(e),r=Ts(e);return t.j().next((()=>n.j())).next((()=>r.j()))}createTargetIndexes(e,t){return re.forEach(this.un(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new us(t).sn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Is(e);let r=!0;const i=new Map;return re.forEach(this.un(t),(t=>this.cn(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Wn();const r=[];return re.forEach(i,((i,s)=>{f("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${mn(t)}`);const o=function(e,t){const n=G(t);if(void 0===n)return null;for(const t of vn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of K(t))for(const t of vn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of K(t)){const t=0===i.kind?wn(e,i.fieldPath,e.startAt):bn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new qt(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of K(t)){const t=0===i.kind?bn(e,i.fieldPath,e.endAt):wn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new qt(n,r)}(s,i),l=this.ln(i,s,c),h=this.ln(i,s,u),d=this.hn(i,s,a),p=this.Pn(i.indexId,o,l,c.inclusive,h,u.inclusive,d);return re.forEach(p,(i=>n.G(i,t.limit).next((t=>{t.forEach((t=>{const n=q.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return re.resolve(null)}))}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:hs(Wt.create(e.filters,"and")).map((t=>pn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.an.set(e,t),t)}Pn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.In(t[l/c]):_s,h=this.Tn(e,a,n[l%c],r),d=this.En(e,a,i[l%c],s),f=o.map((t=>this.Tn(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}Tn(e,t,n,r){const i=new os(e,q.empty(),t,n);return r?i:i.Ht()}En(e,t,n,r){const i=new os(e,q.empty(),t,n);return r?i.Ht():i}cn(e,t){const n=new us(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.en(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.un(t);return re.forEach(r,(t=>this.cn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new nt(U.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}dn(e,t){const n=new ss;for(const r of K(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.jt(r.kind);Zi.St.ht(e,i)}return n.Ut()}In(e){const t=new ss;return Zi.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const n=new ss;return Zi.St.ht(Ct(this.databaseId,t),n.jt(function(e){const t=K(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Ut()}hn(e,t,n){if(null===n)return[];let r=[];r.push(new ss);let i=0;for(const s of K(e)){const e=n[i++];for(const n of r)if(this.Rn(t,s.fieldPath)&&At(e))r=this.Vn(r,s,e);else{const t=n.jt(s.kind);Zi.St.ht(e,t)}}return this.mn(r)}ln(e,t,n){return this.hn(e,t,n.position)}mn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Ut();return t}Vn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new ss;r.seed(n.Ut()),Zi.St.ht(e,r.jt(t.kind)),i.push(r)}return i}Rn(e,t){return!!e.filters.find((e=>e instanceof Qt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Ss(e),r=Ts(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next((e=>{const t=[];return re.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new W(t.sequenceNumber,new X(Bi(t.readTime),new q(xe(t.documentKey)),t.largestBatchId)):W.empty(),r=e.fields.map((([e,t])=>new H(U.fromServerFormat(e),t)));return new z(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:P(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Ss(e),i=Ts(e);return this.fn(e).next((e=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>re.forEach(t,(t=>i.put(Hi(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return re.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?re.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),re.forEach(i,(n=>this.gn(e,t,n).next((t=>{const i=this.pn(r,n);return t.isEqual(i)?re.resolve():this.yn(e,r,n,t,i)})))))))}))}wn(e,t,n,r){return Is(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.An(n,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,n,r){return Is(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.An(n,t.key),t.key.path.toArray()])}gn(e,t,n){const r=Is(e);let i=new nt(as);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.An(n,t)])},((e,r)=>{i=i.add(new os(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}pn(e,t){let n=new nt(as);const r=this.dn(t,e);if(null==r)return n;const i=G(t);if(null!=i){const s=e.data.field(i.fieldPath);if(At(s))for(const i of s.arrayValue.values||[])n=n.add(new os(t.indexId,e.key,this.In(i),r))}else n=n.add(new os(t.indexId,e.key,_s,r));return n}yn(e,t,n,r,i){f("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=it(s),c=it(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=it(o)):t?(i(a),a=it(s)):(a=it(s),c=it(o))}}(r,i,as,(r=>{s.push(this.wn(e,t,n,r))}),(r=>{s.push(this.Sn(e,t,n,r))})),re.waitFor(s)}fn(e){let t=1;return Ts(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>as(e,t))).filter(((e,t,n)=>!t||0!==as(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=as(i,e),s=as(i,t);if(0===n)r[0]=e.Ht();else if(n>0&&s<0)r.push(i),r.push(i.Ht());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.bn(r[e],r[e+1]))return[];const t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,_s,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,_s,[]];i.push(IDBKeyRange.bound(t,n))}return i}bn(e,t){return as(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Cs)}getMinOffset(e,t){return re.mapArray(this.un(t),(t=>this.cn(e,t).next((e=>e||y())))).next(Cs)}}function xs(e){return We(e,"collectionParents")}function Is(e){return We(e,"indexEntries")}function Ss(e){return We(e,"indexConfiguration")}function Ts(e){return We(e,"indexState")}function Cs(e){v(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Z(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new X(t.readTime,t.documentKey,n)}const Ds={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class As{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new As(e,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function ks(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{v(1===a)})));const u=[];for(const e of n.mutations){const r=Te(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return re.waitFor(s).next((()=>u))}function Ns(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}As.DEFAULT_COLLECTION_PERCENTILE=10,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,As.DEFAULT=new As(41943040,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),As.DISABLED=new As(-1,0,0);class Os{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Dn={}}static ct(e,t,n,r){v(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Os(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ls(e).J({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Ms(e),s=Ls(e);return s.add({}).next((o=>{v("number"==typeof o);const a=new kr(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>_i(e.ut,t))),i=n.mutations.map((t=>_i(e.ut,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let l=new nt(((e,t)=>P(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Te(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,Ce))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Dn[o]=a.keys()})),re.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Ls(e).get(t).next((e=>e?(v(e.userId===this.userId),Ui(this.serializer,e)):null))}Cn(e,t){return this.Dn[t]?re.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Dn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Ls(e).J({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(v(t.batchId>=n),i=Ui(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ls(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ls(e).U("userMutationsIndex",t).next((e=>e.map((e=>Ui(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Se(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Ms(e).J({range:r},((n,r,s)=>{const[o,a,c]=n,u=xe(a);if(o===this.userId&&t.path.isEqual(u))return Ls(e).get(c).next((e=>{if(!e)throw y();v(e.userId===this.userId),i.push(Ui(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new nt(P);const r=[];return t.forEach((t=>{const i=Se(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Ms(e).J({range:s},((e,r,i)=>{const[s,o,a]=e,c=xe(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),re.waitFor(r).next((()=>this.vn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Se(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new nt(P);return Ms(e).J({range:s},((e,t,i)=>{const[s,a,c]=e,u=xe(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.vn(e,o)))}vn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Ls(e).get(t).next((e=>{if(null===e)throw y();v(e.userId===this.userId),n.push(Ui(this.serializer,e))})))})),re.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return ks(e._e,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Fn(t.batchId)})),re.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Ms(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=xe(e[1]);r.push(t)}else n.done()})).next((()=>{v(0===r.length)}))}))}containsKey(e,t){return Ps(e,this.userId,t)}Mn(e){return Rs(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function Ps(e,t,n){const r=Se(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ms(e).J({range:s,H:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Ls(e){return We(e,"mutations")}function Ms(e){return We(e,"documentMutations")}function Rs(e){return We(e,"mutationQueues")}class Fs{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Fs(0)}static Nn(){return new Fs(-1)}}class Vs{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Ln(e).next((t=>{const n=new Fs(t.highestTargetId);return t.highestTargetId=n.next(),this.Bn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Ln(e).next((e=>F.fromTimestamp(new R(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Ln(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Ln(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Bn(e,r))))}addTargetData(e,t){return this.kn(e,t).next((()=>this.Ln(e).next((n=>(n.targetCount+=1,this.qn(t,n),this.Bn(e,n))))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>js(e).delete(t.targetId))).next((()=>this.Ln(e))).next((t=>(v(t.targetCount>0),t.targetCount-=1,this.Bn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return js(e).J(((s,o)=>{const a=qi(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>re.waitFor(i))).next((()=>r))}forEachTarget(e,t){return js(e).J(((e,n)=>{const r=qi(n);t(r)}))}Ln(e){return Bs(e).get("targetGlobalKey").next((e=>(v(null!==e),e)))}Bn(e,t){return Bs(e).put("targetGlobalKey",t)}kn(e,t){return js(e).put(zi(this.serializer,t))}qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Ln(e).next((e=>e.targetCount))}getTargetData(e,t){const n=mn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return js(e).J({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=qi(n);gn(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=Us(e);return t.forEach((t=>{const s=be(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),re.waitFor(r)}removeMatchingKeys(e,t,n){const r=Us(e);return re.forEach(t,(t=>{const i=be(t.path);return re.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Us(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Us(e);let i=Wn();return r.J({range:n,H:!0},((e,t,n)=>{const r=xe(e[1]),s=new q(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=be(t.path),r=IDBKeyRange.bound([n],[M(n)],!1,!0);let i=0;return Us(e).J({index:"documentTargetsIndex",H:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}ot(e,t){return js(e).get(t).next((e=>e?qi(e):null))}}function js(e){return We(e,"targets")}function Bs(e){return We(e,"targetGlobal")}function Us(e){return We(e,"targetDocuments")}function qs([e,t],[n,r]){const i=P(e,n);return 0===i?P(t,r):i}class zs{constructor(e){this.Qn=e,this.buffer=new nt(qs),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();qs(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Gs{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){f("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ue(e)?f("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await ne(e)}await this.Gn(3e5)}))}}class Ks{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return re.resolve(ge.oe);const n=new zs(t);return this.zn.forEachTarget(e,(e=>n.Un(e.sequenceNumber))).next((()=>this.zn.Hn(e,(e=>n.Un(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.zn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(Ds)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ds):this.Jn(e,t)))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let n,r,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(f("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),d()<=s.LogLevel.DEBUG&&f("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function $s(e,t){return new Ks(e,t)}class Hs{constructor(e,t){this.db=e,this.garbageCollector=$s(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Yn(e){let t=0;return this.Hn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,((e,n)=>t(n)))}addReference(e,t,n){return Qs(e,n)}removeReference(e,t,n){return Qs(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Qs(e,t)}Xn(e,t){return function(e,t){let n=!1;return Rs(e).Y((r=>Ps(e,r,t).next((e=>(e&&(n=!0),re.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Zn(e,((s,o)=>{if(o<=t){const t=this.Xn(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,F.min()),Us(e).delete(function(e){return[0,be(e.path)]}(s)))))}));r.push(t)}})).next((()=>re.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Qs(e,t)}Zn(e,t){const n=Us(e);let r,i=ge.oe;return n.J({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==ge.oe&&t(new q(xe(r)),i),i=o,r=s):i=ge.oe})).next((()=>{i!==ge.oe&&t(new q(xe(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qs(e,t){return Us(e).put(function(e,t){return{targetId:0,path:be(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Ws{constructor(){this.changes=new Vn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?re.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Js{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return eo(e).put(n)}removeEntry(e,t,n){return eo(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Vi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.er(e,n))))}getEntry(e,t){let n=Ut.newInvalidDocument(t);return eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(to(t))},((e,r)=>{n=this.tr(t,r)})).next((()=>n))}nr(e,t){let n={size:0,document:Ut.newInvalidDocument(t)};return eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(to(t))},((e,r)=>{n={document:this.tr(t,r),size:Ns(r)}})).next((()=>n))}getEntries(e,t){let n=Bn();return this.rr(e,t,((e,t)=>{const r=this.tr(e,t);n=n.insert(e,r)})).next((()=>n))}ir(e,t){let n=Bn(),r=new Ze(q.comparator);return this.rr(e,t,((e,t)=>{const i=this.tr(e,t);n=n.insert(e,i),r=r.insert(e,Ns(t))})).next((()=>({documents:n,sr:r})))}rr(e,t,n){if(t.isEmpty())return re.resolve();let r=new nt(ro);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(to(r.first()),to(r.last())),s=r.getIterator();let o=s.getNext();return eo(e).J({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=q.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&ro(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.$(to(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Vi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return eo(e).U(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Bn();for(const i of e){const e=this.tr(q.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Ln(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Bn();const s=no(t,n),o=no(t,X.max());return eo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.tr(q.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Xs(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Zs(e).get("remoteDocumentGlobalKey").next((e=>(v(!!e),e)))}er(e,t){return Zs(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=bi(e.ut,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=q.fromSegments(t.noDocument.path),r=Bi(t.noDocument.readTime);n=Ut.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return y();{const e=q.fromSegments(t.unknownDocument.path),r=Bi(t.unknownDocument.version);n=Ut.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new R(e[0],e[1]);return F.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(F.min()))return e}return Ut.newInvalidDocument(e)}}function Ys(e){return new Js(e)}class Xs extends Ws{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new Vn((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new nt(((e,t)=>P(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.ar.get(i);if(t.push(this._r.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Fi(this._r.serializer,s);r=r.add(i.path.popLast());const c=Ns(a);n+=c-o.size,t.push(this._r.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Fi(this._r.serializer,s.convertToNoDocument(F.min()));t.push(this._r.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,n))})),t.push(this._r.updateMetadata(e,n)),re.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next((e=>(this.ar.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this._r.ir(e,t).next((({documents:e,sr:t})=>(t.forEach(((t,n)=>{this.ar.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Zs(e){return We(e,"remoteDocumentGlobal")}function eo(e){return We(e,"remoteDocumentsV14")}function to(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function no(e,t){const n=t.documentKey.path.toArray();return[e,Vi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ro(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=P(n[e],r[e]),i)return i;return i=P(n.length,r.length),i||(i=P(n[n.length-2],r[r.length-2]),i||P(n[n.length-1],r[r.length-1]))}class io{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class so{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&br(n.mutation,e,st.empty(),R.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Wn()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Wn()){const r=Gn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=qn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Gn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Wn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Bn();const s=$n(),o=$n();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ir)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),br(o.mutation,t,o.mutation.getFieldMask(),R.now())):s.set(t.key,st.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new io(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=$n();let r=new Ze(((e,t)=>e-t)),i=Wn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||st.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Wn()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Kn();c.forEach((e=>{if(!i.has(e)){const r=vr(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return re.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return q.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):re.resolve(Gn());let o=-1,a=i;return s.next((t=>re.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?re.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Wn()))).next((e=>({batchId:o,changes:zn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next((e=>{let t=qn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=qn();return this.indexManager.getCollectionParents(e,i).next((o=>re.forEach(o,(o=>{const a=function(e,t){return new _n(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ut.newInvalidDocument(r)))}));let n=qn();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&br(s.mutation,r,st.empty(),R.now()),Ln(t,r)&&(n=n.insert(e,r))})),n}))}}class oo{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return re.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ui(e.createTime)}}(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(e){return{name:e.name,query:Gi(e.bundledQuery),readTime:ui(e.readTime)}}(t)),re.resolve()}}class ao{constructor(){this.overlays=new Ze(q.comparator),this.lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Gn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.lt(e,t,r)})),re.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.lr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.lr.delete(n)),re.resolve()}getOverlaysForCollection(e,t,n){const r=Gn(),i=t.length+1,s=new q(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ze(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Gn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Gn(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return re.resolve(o)}lt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.lr.get(r.largestBatchId).delete(n.key);this.lr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Or(t,n));let i=this.lr.get(t);void 0===i&&(i=Wn(),this.lr.set(t,i)),this.lr.set(t,i.add(n.key))}}class co{constructor(){this.hr=new nt(uo.Pr),this.Ir=new nt(uo.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const n=new uo(e,t);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.dr(new uo(e,t))}Ar(e,t){e.forEach((e=>this.removeReference(e,t)))}Rr(e){const t=new q(new j([])),n=new uo(t,e),r=new uo(t,e+1),i=[];return this.Ir.forEachInRange([n,r],(e=>{this.dr(e),i.push(e.key)})),i}Vr(){this.hr.forEach((e=>this.dr(e)))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new q(new j([])),n=new uo(t,e),r=new uo(t,e+1);let i=Wn();return this.Ir.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new uo(e,0),n=this.hr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class uo{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return q.comparator(e.key,t.key)||P(e.gr,t.gr)}static Tr(e,t){return P(e.gr,t.gr)||q.comparator(e.key,t.key)}}class lo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new nt(uo.Pr)}checkEmpty(e){return re.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new kr(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.yr=this.yr.add(new uo(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Sr(n),i=r<0?0:r;return re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new uo(t,0),r=new uo(t,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([n,r],(e=>{const t=this.wr(e.gr);i.push(t)})),re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new nt(P);return t.forEach((e=>{const t=new uo(e,0),r=new uo(e,Number.POSITIVE_INFINITY);this.yr.forEachInRange([t,r],(e=>{n=n.add(e.gr)}))})),re.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;q.isDocumentKey(i)||(i=i.child(""));const s=new uo(new q(i),0);let o=new nt(P);return this.yr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.gr)),!0)}),s),re.resolve(this.br(o))}br(e){const t=[];return e.forEach((e=>{const n=this.wr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){v(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return re.forEach(t.mutations,(r=>{const i=new uo(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.yr=n}))}Fn(e){}containsKey(e,t){const n=new uo(t,0),r=this.yr.firstAfterOrEqual(n);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ho{constructor(e){this.Cr=e,this.docs=new Ze(q.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return re.resolve(n?n.document.mutableCopy():Ut.newInvalidDocument(t))}getEntries(e,t){let n=Bn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ut.newInvalidDocument(e))})),re.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Bn();const s=t.path,o=new q(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Z(Y(o),n)<=0||(r.has(o.key)||Ln(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return re.resolve(i)}getAllFromCollectionGroup(e,t,n,r){y()}vr(e,t){return re.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new fo(this)}getSize(e){return re.resolve(this.size)}}class fo extends Ws{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(n)})),re.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class po{constructor(e){this.persistence=e,this.Fr=new Vn((e=>mn(e)),gn),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Mr=0,this.Or=new co,this.targetCount=0,this.Nr=Fs.On()}forEachTarget(e,t){return this.Fr.forEach(((e,n)=>t(n))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Mr&&(this.Mr=t),re.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Fs(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.kn(t),re.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Fr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Fr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),re.waitFor(i).next((()=>r))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const n=this.Fr.get(t)||null;return re.resolve(n)}addMatchingKeys(e,t,n){return this.Or.Er(t,n),re.resolve()}removeMatchingKeys(e,t,n){this.Or.Ar(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),re.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Or.mr(t);return re.resolve(n)}containsKey(e,t){return re.resolve(this.Or.containsKey(t))}}class mo{constructor(e,t){this.Lr={},this.overlays={},this.Br=new ge(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new po(this),this.indexManager=new ws,this.remoteDocumentCache=function(e){return new ho(e)}((e=>this.referenceDelegate.Qr(e))),this.serializer=new Ri(t),this.Kr=new oo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ao,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Lr[e.toKey()];return n||(n=new lo(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,n){f("MemoryPersistence","Starting transaction:",e);const r=new go(this.Br.next());return this.referenceDelegate.$r(),n(r).next((e=>this.referenceDelegate.Ur(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Wr(e,t){return re.or(Object.values(this.Lr).map((n=>()=>n.containsKey(e,t))))}}class go extends te{constructor(e){super(),this.currentSequenceNumber=e}}class yo{constructor(e){this.persistence=e,this.Gr=new co,this.zr=null}static jr(e){return new yo(e)}get Hr(){if(this.zr)return this.zr;throw y()}addReference(e,t,n){return this.Gr.addReference(n,t),this.Hr.delete(n.toString()),re.resolve()}removeReference(e,t,n){return this.Gr.removeReference(n,t),this.Hr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),re.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach((e=>this.Hr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Hr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Hr,(n=>{const r=q.fromPath(n);return this.Jr(e,r).next((e=>{e||t.removeEntry(r,F.min())}))})).next((()=>(this.zr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Jr(e,t).next((e=>{e?this.Hr.delete(t.toString()):this.Hr.add(t.toString())}))}Qr(e){return 0}Jr(e,t){return re.or([()=>re.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class vo{constructor(e,t){this.persistence=e,this.Yr=new Vn((e=>be(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=$s(this,t)}static jr(e,t){return new vo(e,t)}$r(){}Ur(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}jn(e){const t=this.Yn(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Yn(e){let t=0;return this.Hn(e,(e=>{t++})).next((()=>t))}Hn(e,t){return re.forEach(this.Yr,((n,r)=>this.Xn(e,n,r).next((e=>e?re.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.vr(e,(r=>this.Xn(e,r,t).next((e=>{e||(n++,i.removeEntry(r,F.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.Yr.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Yr.set(n,e.currentSequenceNumber),re.resolve()}removeReference(e,t,n){return this.Yr.set(n,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.Yr.set(t,e.currentSequenceNumber),re.resolve()}Qr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Tt(e.data.value)),t}Xn(e,t,n){return re.or([()=>this.persistence.Wr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Yr.get(t);return re.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class wo{constructor(e){this.serializer=e}O(e,t,n,r){const i=new ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ie,{unique:!0}),e.createObjectStore("documentMutations")}(e),bo(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=re.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),bo(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:F.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").U().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ie,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return re.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Zr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(i))))),n<7&&r>=7&&(s=s.next((()=>this.ei(i)))),n<8&&r>=8&&(s=s.next((()=>this.ti(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ni(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:je});t.createIndex("collectionPathOverlayIndex",Be,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Ue,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:De});t.createIndex("documentKeyIndex",Ae),t.createIndex("collectionGroupIndex",ke)}(e))).next((()=>this.ri(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.ii(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Me}).createIndex("sequenceNumberIndex",Re,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Fe}).createIndex("documentKeyIndex",Ve,{unique:!1})}(e)))),n<16&&r>=16&&(s=s.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),s}Xr(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=Ns(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Zr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next((t=>re.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",r).next((n=>re.forEach(n,(n=>{v(n.userId===t.userId);const r=Ui(this.serializer,n);return ks(e,t.userId,r).next((()=>{}))}))))}))))}ei(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.J(((n,i)=>{const s=new j(n),o=function(e){return[0,be(e)]}(s);r.push(t.get(o).next((n=>n?re.resolve():(n=>t.put({targetId:0,path:be(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>re.waitFor(r)))}))}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Le});const n=t.store("collectionParents"),r=new bs,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:be(r)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new j(e);return i(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([e,t,n],r)=>{const s=xe(t);return i(s.popLast())}))))}ni(e){const t=e.store("targets");return t.J(((e,n)=>{const r=qi(n),i=zi(this.serializer,r);return t.put(i)}))}ri(e,t){const n=t.store("remoteDocuments"),r=[];return n.J(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new q(j.fromString(e.document.name).popFirst(5)):e.noDocument?q.fromSegments(e.noDocument.path):e.unknownDocument?q.fromSegments(e.unknownDocument.path):y()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>re.waitFor(r)))}ii(e,t){const n=t.store("mutations"),r=Ys(this.serializer),i=new mo(yo.jr,this.serializer.ut);return n.U().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Wn();Ui(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),re.forEach(n,((e,n)=>{const s=new u(n),o=Yi.ct(this.serializer,s),a=i.getIndexManager(s),c=Os.ct(s,this.serializer,a,i.referenceDelegate);return new so(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Qe(t,ge.oe),e).next()}))}))}}function bo(e){e.createObjectStore("targetDocuments",{keyPath:Oe}).createIndex("documentTargetsIndex",Pe,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ne,{unique:!0}),e.createObjectStore("targetGlobal")}const _o="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Eo{constructor(e,t,n,r,i,s,o,a,c,u,l=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.si=i,this.window=s,this.document=o,this.oi=c,this._i=u,this.ai=l,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=e=>Promise.resolve(),!Eo.D())throw new _(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Hs(this,r),this.Ii=t+"main",this.serializer=new Ri(a),this.Ti=new se(this.Ii,this.ai,new wo(this.serializer)),this.qr=new Vs(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ys(this.serializer),this.Kr=new Qi,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===u&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,_o);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.qr.getHighestSequenceNumber(e)))})).then((e=>{this.Br=new ge(e,this.oi)})).then((()=>{this.kr=!0})).catch((e=>(this.Ti&&this.Ti.close(),Promise.reject(e))))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((async()=>{this.started&&await this.di()})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Io(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.fi(e).next((e=>{e||(this.isPrimary=!1,this.si.enqueueRetryable((()=>this.Pi(!1))))}))})).next((()=>this.gi(e))).next((t=>this.isPrimary&&!t?this.pi(e).next((()=>!1)):!!t&&this.yi(e).next((()=>!0)))))).catch((e=>{if(ue(e))return f("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return f("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.si.enqueueRetryable((()=>this.Pi(e))),this.isPrimary=e}))}fi(e){return xo(e).get("owner").next((e=>re.resolve(this.wi(e))))}Si(e){return Io(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=We(e,"clientMetadata");return t.U().next((e=>{const n=this.Ci(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return re.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.di().then((()=>this.bi())).then((()=>this.Vi()))))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?re.resolve(!0):xo(e).get("owner").next((t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,_o);return!1}}return!(!this.networkEnabled||!this.inForeground)||Io(e).U().next((e=>void 0===this.Ci(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&f("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Qe(e,ge.oe);return this.pi(t).next((()=>this.Si(t)))})),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter((e=>this.Di(e.updateTimeMs,t)&&!this.Fi(e.clientId)))}Li(){return this.runTransaction("getActiveClients","readonly",(e=>Io(e).U().next((e=>this.Ci(e,18e5).map((e=>e.clientId))))))}get started(){return this.kr}getMutationQueue(e,t){return Os.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Es(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Yi.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,n){f("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 16===e?He:15===e?$e:14===e?Ke:13===e?Ge:12===e?ze:11===e?qe:void y()}(this.ai);let s;return this.Ti.runTransaction(e,r,i,(r=>(s=new Qe(r,this.Br?this.Br.next():ge.oe),"readwrite-primary"===t?this.fi(s).next((e=>!!e||this.gi(s))).next((t=>{if(!t)throw p(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable((()=>this.Pi(!1))),new _(b.FAILED_PRECONDITION,ee);return n(s)})).next((e=>this.yi(s).next((()=>e)))):this.Bi(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Bi(e){return xo(e).get("owner").next((e=>{if(null!==e&&this.Di(e.leaseTimestampMs,5e3)&&!this.Fi(e.ownerId)&&!this.wi(e)&&!(this._i||this.allowTabSynchronization&&e.allowTabSynchronization))throw new _(b.FAILED_PRECONDITION,_o)}))}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xo(e).put("owner",t)}static D(){return se.D()}pi(e){const t=xo(e);return t.get("owner").next((e=>this.wi(e)?(f("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):re.resolve()))}Di(e,t){const n=Date.now();return!(e<n-t||e>n&&(p(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.di())))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const e=/(?:Version|Mobile)\/1[456]/;o.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const n=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return f("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return p("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){p("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch(e){}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function xo(e){return We(e,"owner")}function Io(e){return We(e,"clientMetadata")}function So(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class To{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ki=n,this.qi=r}static Qi(e,t){let n=Wn(),r=Wn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new To(e,t.fromCache,n,r)}}class Co{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Do{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=o.isSafari()?8:oe(o.getUA())>0?6:4}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.zi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ji(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Co;return this.Hi(e,t,n).next((r=>{if(i.result=r,this.$i)return this.Ji(e,t,n,r.size)}))})).next((()=>i.result))}Ji(e,t,n,r){return n.documentReadCount<this.Ui?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","SDK will not create cache indexes for query:",Pn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),re.resolve()):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Query:",Pn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Wi*r?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","The SDK decides to create cache indexes for query:",Pn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(t))):re.resolve())}zi(e,t){if(In(t))return re.resolve(null);let n=Cn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=kn(t,null,"F"),n=Cn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Wn(...r);return this.Gi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Yi(t,r);return this.Zi(t,s,i,n.readTime)?this.zi(e,kn(t,null,"F")):this.Xi(e,s,t,n)}))))})))))}ji(e,t,n,r){return In(t)||r.isEqual(F.min())?re.resolve(null):this.Gi.getDocuments(e,n).next((i=>{const o=this.Yi(t,i);return this.Zi(t,o,n,r)?re.resolve(null):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Pn(t)),this.Xi(e,o,t,J(r,-1)).next((e=>e)))}))}Yi(e,t){let n=new nt(Rn(e));return t.forEach(((t,r)=>{Ln(e,r)&&(n=n.add(r))})),n}Zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Hi(e,t,n){return d()<=s.LogLevel.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Pn(t)),this.Gi.getDocumentsMatchingQuery(e,t,X.min(),n)}Xi(e,t,n,r){return this.Gi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Ao{constructor(e,t,n,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new Ze(P),this.ns=new Vn((e=>mn(e)),gn),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(n)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new so(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ts)))}}function ko(e,t,n,r){return new Ao(e,t,n,r)}async function No(e,t){const n=w(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.os(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Wn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({_s:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function Oo(e){const t=w(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.qr.getLastRemoteSnapshotVersion(e)))}function Po(e,t,n){let r=Wn(),i=Wn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Bn();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(F.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):f("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{us:r,cs:i}}))}function Lo(e,t){const n=w(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Mo(e,t){const n=w(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.qr.getTargetData(e,t).next((i=>i?(r=i,re.resolve(r)):n.qr.allocateTargetId(e).next((i=>(r=new Mi(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ts=n.ts.insert(e.targetId,e),n.ns.set(t,e.targetId)),e}))}async function Ro(e,t,n){const r=w(e),i=r.ts.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ue(e))throw e;f("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ts=r.ts.remove(t),r.ns.delete(i.target)}function Fo(e,t,n){const r=w(e);let i=F.min(),s=Wn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=w(e),i=r.ns.get(n);return void 0!==i?re.resolve(r.ts.get(i)):r.qr.getTargetData(t,n)}(r,e,Cn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.es.getDocumentsMatchingQuery(e,t,n?i:F.min(),n?s:Wn()))).next((e=>(Bo(r,Mn(t),e),{documents:e,ls:s})))))}function Vo(e,t){const n=w(e),r=w(n.qr),i=n.ts.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ot(e,t).next((e=>e?e.target:null))))}function jo(e,t){const n=w(e),r=n.rs.get(t)||F.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.ss.getAllFromCollectionGroup(e,t,J(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Bo(n,t,e),e)))}function Bo(e,t,n){let r=e.rs.get(t)||F.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.rs.set(t,r)}async function Uo(e,t,n=Wn()){const r=await Mo(e,Cn(Gi(t.bundledQuery))),i=w(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=ui(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Kr.saveNamedQuery(e,t);const o=r.withResumeToken(at.EMPTY_BYTE_STRING,s);return i.ts=i.ts.insert(o.targetId,o),i.qr.updateTargetData(e,o).next((()=>i.qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.Kr.saveNamedQuery(e,t)))}))}function qo(e,t){return`firestore_clients_${e}_${t}`}function zo(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Go(e,t){return`firestore_targets_${e}_${t}`}class Ko{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ts(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new _(r.error.code,r.error.message))),s?new Ko(e,t,r.state,i):(p("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $o{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ts(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new _(n.error.code,n.error.message))),i?new $o(e,n.state,r):(p("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ho{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Yn();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=we(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Ho(e,i):(p("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Qo{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Qo(t.clientId,t.onlineState):(p("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Wo{constructor(){this.activeTargetIds=Yn()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jo{constructor(e,t,n,r,i){this.window=e,this.si=t,this.persistenceKey=n,this.Rs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Ze(P),this.started=!1,this.ps=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ys=qo(this.persistenceKey,this.Rs),this.ws=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Wo),this.Ss=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Cs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.vs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Li();for(const t of e){if(t===this.Rs)continue;const e=this.getItem(qo(this.persistenceKey,t));if(e){const n=Ho.Ts(t,e);n&&(this.gs=this.gs.insert(n.clientId,n))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const e=this.Ms(t);e&&this.xs(e)}for(const e of this.ps)this.fs(e);this.ps=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,n){this.Ns(e,t,n),this.Ls(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Go(this.persistenceKey,e));if(n){const r=$o.Ts(e,n);r&&(t=r.state)}}return this.Bs.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Go(this.persistenceKey,e))}updateQueryState(e,t,n){this.ks(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Ls(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return f("SharedClientState","READ",e,t),t}setItem(e,t){f("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){f("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(f("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ss.test(t.key)){if(null==t.newValue){const e=this.Ks(t.key);return this.$s(e,null)}{const e=this.Us(t.key,t.newValue);if(e)return this.$s(e.clientId,e)}}else if(this.bs.test(t.key)){if(null!==t.newValue){const e=this.Ws(t.key,t.newValue);if(e)return this.Gs(e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.zs(t.key,t.newValue);if(e)return this.js(e)}}else if(t.key===this.Cs){if(null!==t.newValue){const e=this.Ms(t.newValue);if(e)return this.xs(e)}}else if(t.key===this.ws){const e=function(e){let t=ge.oe;if(null!=e)try{const n=JSON.parse(e);v("number"==typeof n),t=n}catch(e){p("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==ge.oe&&this.sequenceNumberHandler(e)}else if(t.key===this.vs){const e=this.Hs(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Js(e))))}}else this.ps.push(t)}))}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,t,n){const r=new Ko(this.currentUser,e,t,n),i=zo(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Es())}Ls(e){const t=zo(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,n){const r=Go(this.persistenceKey,e),i=new $o(e,t,n);this.setItem(r,i.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const n=this.Ks(e);return Ho.Ts(n,t)}Ws(e,t){const n=this.bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ko.Ts(new u(i),r,t)}zs(e,t){const n=this.Ds.exec(e),r=Number(n[1]);return $o.Ts(r,t)}Ms(e){return Qo.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);f("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const n=t?this.gs.insert(e,t):this.gs.remove(e),r=this.Os(this.gs),i=this.Os(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.Xs(s,o).then((()=>{this.gs=n}))}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=Yn();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Yo{constructor(){this.eo=new Wo,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,n){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Wo,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Xo{ro(e){}shutdown(){}}class Zo{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){f("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){f("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ea=null;function ta(){return null===ea?ea=268435456+Math.round(2147483648*Math.random()):ea++,"0x"+ea.toString(16)}const na={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ra{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}}const ia="WebChannelConnection";class sa extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.yo=t+"://"+e.host,this.wo=`projects/${n}/databases/${r}`,this.So="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get bo(){return!1}Do(e,t,n,r,i){const s=ta(),o=this.Co(e,t.toUriEncodedString());f("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(a,r,i),this.Fo(e,o,a,n).then((t=>(f("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw m("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Mo(e,t,n,r,i,s){return this.Do(e,t,n,r,i)}vo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+l,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}Co(e,t){const n=na[e];return`${this.yo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,t,n,r){const i=ta();return new Promise(((s,o)=>{const c=new a.XhrIo;c.setWithCredentials(!0),c.listenOnce(a.EventType.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case a.ErrorCode.NO_ERROR:const t=c.getResponseJson();f(ia,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case a.ErrorCode.TIMEOUT:f(ia,`RPC '${e}' ${i} timed out`),o(new _(b.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:const n=c.getStatus();if(f(ia,`RPC '${e}' ${i} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(t)>=0?t:b.UNKNOWN}(t.status);o(new _(e,t.message))}else o(new _(b.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new _(b.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{f(ia,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(r);f(ia,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,n,15)}))}xo(e,t,n){const r=ta(),i=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=a.createWebChannelTransport(),o=a.getStatEventTarget(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new a.FetchXmlHttpFactory({})),this.vo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const l=i.join("");f(ia,`Creating RPC '${e}' stream ${r}: ${l}`,c);const h=s.createWebChannel(l,c);let d=!1,p=!1;const g=new ra({co:t=>{p?f(ia,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(f(ia,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),f(ia,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},lo:()=>h.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(h,a.WebChannel.EventType.OPEN,(()=>{p||(f(ia,`RPC '${e}' stream ${r} transport opened.`),g.Vo())})),y(h,a.WebChannel.EventType.CLOSE,(()=>{p||(p=!0,f(ia,`RPC '${e}' stream ${r} transport closed`),g.fo())})),y(h,a.WebChannel.EventType.ERROR,(t=>{p||(p=!0,m(ia,`RPC '${e}' stream ${r} transport errored:`,t),g.fo(new _(b.UNAVAILABLE,"The operation could not be completed")))})),y(h,a.WebChannel.EventType.MESSAGE,(t=>{var n;if(!p){const i=t.data[0];v(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){f(ia,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Mr[e];if(void 0!==t)return Vr(t)}(t),i=o.message;void 0===n&&(n=b.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),p=!0,g.fo(new _(n,i)),h.close()}else f(ia,`RPC '${e}' stream ${r} received:`,i),g.po(i)}})),y(o,a.Event.STAT_EVENT,(t=>{t.stat===a.Stat.PROXY?f(ia,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===a.Stat.NOPROXY&&f(ia,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{g.mo()}),0),g}}function oa(){return"undefined"!=typeof window?window:null}function aa(){return"undefined"!=typeof document?document:null}function ca(e){return new ii(e,!0)}class ua{constructor(e,t,n=1e3,r=1.5,i=6e4){this.si=e,this.timerId=t,this.Oo=n,this.No=r,this.Lo=i,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();const t=Math.floor(this.Bo+this.$o()),n=Math.max(0,Date.now()-this.qo),r=Math.max(0,t-n);r>0&&f("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Bo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,r,(()=>(this.qo=Date.now(),e()))),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){null!==this.ko&&(this.ko.skipDelay(),this.ko=null)}cancel(){null!==this.ko&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}}class la{constructor(e,t,n,r,i,s,o,a){this.si=e,this.Wo=n,this.Go=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new ua(e,t)}Yo(){return 1===this.state||5===this.state||this.Zo()}Zo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Xo()}async stop(){this.Yo()&&await this.close(0)}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&null===this.jo&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,(()=>this.n_())))}r_(e){this.i_(),this.stream.send(e)}async n_(){if(this.Zo())return this.close(0)}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}async close(e,t){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,4!==e?this.Jo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(p(t.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):t&&t.code===b.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Eo(t)}o_(){}auth(){this.state=1;const e=this.__(this.zo),t=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.zo===t&&this.a_(e,n)}),(t=>{e((()=>{const e=new _(b.UNKNOWN,"Fetching auth token failed: "+t.message);return this.u_(e)}))}))}a_(e,t){const n=this.__(this.zo);this.stream=this.c_(e,t),this.stream.ho((()=>{n((()=>this.listener.ho()))})),this.stream.Io((()=>{n((()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,(()=>(this.Zo()&&(this.state=3),Promise.resolve()))),this.listener.Io())))})),this.stream.Eo((e=>{n((()=>this.u_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Xo(){this.state=5,this.Jo.Ko((async()=>{this.state=0,this.start()}))}u_(e){return f("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return t=>{this.si.enqueueAndForget((()=>this.zo===e?t():(f("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ha extends la{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}c_(e,t){return this.connection.xo("Listen",e,t)}onMessage(e){this.Jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(v(void 0===t||"string"==typeof t),at.fromBase64String(t||"")):(v(void 0===t||t instanceof Buffer||t instanceof Uint8Array),at.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?b.UNKNOWN:Vr(e.code);return new _(t,e.message||"")}(o);n=new Jr(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=pi(e,r.document.name),s=ui(r.document.updateTime),o=r.document.createTime?ui(r.document.createTime):F.min(),a=new jt({mapValue:{fields:r.document.fields}}),c=Ut.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Qr(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=pi(e,r.document),s=r.readTime?ui(r.readTime):F.min(),o=Ut.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Qr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=pi(e,r.document),s=r.removedTargetIds||[];n=new Qr([],s,i,null)}else{if(!("filter"in t))return y();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Lr(r,i),o=e.targetId;n=new Wr(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return F.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?F.min():t.readTime?ui(t.readTime):F.min()}(e);return this.listener.l_(t,n)}h_(e){const t={};t.database=yi(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=yn(r)?{documents:xi(e,r)}:{query:Ii(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=ai(e,t.resumeToken);const r=si(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(F.min())>0){n.readTime=oi(e,t.snapshotVersion.toTimestamp());const r=si(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return y()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.r_(t)}P_(e){const t={};t.database=yi(this.serializer),t.removeTarget=e,this.r_(t)}}class da extends la{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,t){return this.connection.xo("Write",e,t)}onMessage(e){if(v(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();const t=function(e,t){return e&&e.length>0?(v(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ui(e.updateTime):ui(t);return n.isEqual(F.min())&&(n=ui(t)),new pr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ui(e.commitTime);return this.listener.d_(n,t)}return v(!e.writeResults||0===e.writeResults.length),this.I_=!0,this.listener.A_()}R_(){const e={};e.database=yi(this.serializer),this.r_(e)}E_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>_i(this.serializer,e)))};this.r_(t)}}class fa extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.V_=!1}m_(){if(this.V_)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,t,n,r){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Do(e,hi(t,n),r,i,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}Mo(e,t,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Mo(e,hi(t,n),r,s,o,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}terminate(){this.V_=!0,this.connection.terminate()}}class pa{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve()))))}D_(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(p(t),this.y_=!1):f("OnlineStateTracker",t)}C_(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}class ma{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.ro((e=>{n.enqueueAndForget((async()=>{Ia(this)&&(f("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=w(e);t.M_.add(4),await ya(t),t.N_.set("Unknown"),t.M_.delete(4),await ga(t)}(this))}))})),this.N_=new pa(n,r)}}async function ga(e){if(Ia(e))for(const t of e.x_)await t(!0)}async function ya(e){for(const t of e.x_)await t(!1)}function va(e,t){const n=w(e);n.F_.has(t.targetId)||(n.F_.set(t.targetId,t),xa(n)?Ea(n):za(n).Zo()&&ba(n,t))}function wa(e,t){const n=w(e),r=za(n);n.F_.delete(t),r.Zo()&&_a(n,t),0===n.F_.size&&(r.Zo()?r.t_():Ia(n)&&n.N_.set("Unknown"))}function ba(e,t){if(e.L_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(F.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}za(e).h_(t)}function _a(e,t){e.L_.xe(t),za(e).P_(t)}function Ea(e){e.L_=new Xr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.F_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),za(e).start(),e.N_.w_()}function xa(e){return Ia(e)&&!za(e).Yo()&&e.F_.size>0}function Ia(e){return 0===w(e).M_.size}function Sa(e){e.L_=void 0}async function Ta(e){e.N_.set("Online")}async function Ca(e){e.F_.forEach(((t,n)=>{ba(e,t)}))}async function Da(e,t){Sa(e),xa(e)?(e.N_.D_(t),Ea(e)):e.N_.set("Unknown")}async function Aa(e,t,n){if(e.N_.set("Online"),t instanceof Jr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.F_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.F_.delete(r),e.L_.removeTarget(r))}(e,t)}catch(n){f("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ka(e,n)}else if(t instanceof Qr?e.L_.Ke(t):t instanceof Wr?e.L_.He(t):e.L_.We(t),!n.isEqual(F.min()))try{const t=await Oo(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.L_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.F_.get(r);i&&e.F_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.F_.get(t);if(!r)return;e.F_.set(t,r.withResumeToken(at.EMPTY_BYTE_STRING,r.snapshotVersion)),_a(e,t);const i=new Mi(r.target,t,n,r.sequenceNumber);ba(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){f("RemoteStore","Failed to raise snapshot:",t),await ka(e,t)}}async function ka(e,t,n){if(!ue(t))throw t;e.M_.add(1),await ya(e),e.N_.set("Offline"),n||(n=()=>Oo(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{f("RemoteStore","Retrying IndexedDB access"),await n(),e.M_.delete(1),await ga(e)}))}function Na(e,t){return t().catch((n=>ka(e,n,t)))}async function Oa(e){const t=w(e),n=Ga(t);let r=t.v_.length>0?t.v_[t.v_.length-1].batchId:-1;for(;Pa(t);)try{const e=await Lo(t.localStore,r);if(null===e){0===t.v_.length&&n.t_();break}r=e.batchId,La(t,e)}catch(e){await ka(t,e)}Ma(t)&&Ra(t)}function Pa(e){return Ia(e)&&e.v_.length<10}function La(e,t){e.v_.push(t);const n=Ga(e);n.Zo()&&n.T_&&n.E_(t.mutations)}function Ma(e){return Ia(e)&&!Ga(e).Yo()&&e.v_.length>0}function Ra(e){Ga(e).start()}async function Fa(e){Ga(e).R_()}async function Va(e){const t=Ga(e);for(const n of e.v_)t.E_(n.mutations)}async function ja(e,t,n){const r=e.v_.shift(),i=Nr.from(r,t,n);await Na(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Oa(e)}async function Ba(e,t){t&&Ga(e).T_&&await async function(e,t){if(function(e){return Fr(e)&&e!==b.ABORTED}(t.code)){const n=e.v_.shift();Ga(e).e_(),await Na(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Oa(e)}}(e,t),Ma(e)&&Ra(e)}async function Ua(e,t){const n=w(e);n.asyncQueue.verifyOperationInProgress(),f("RemoteStore","RemoteStore received new credentials");const r=Ia(n);n.M_.add(3),await ya(n),r&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.M_.delete(3),await ga(n)}async function qa(e,t){const n=w(e);t?(n.M_.delete(2),await ga(n)):t||(n.M_.add(2),await ya(n),n.N_.set("Unknown"))}function za(e){return e.B_||(e.B_=function(e,t,n){const r=w(e);return r.m_(),new ha(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:Ta.bind(null,e),Io:Ca.bind(null,e),Eo:Da.bind(null,e),l_:Aa.bind(null,e)}),e.x_.push((async t=>{t?(e.B_.e_(),xa(e)?Ea(e):e.N_.set("Unknown")):(await e.B_.stop(),Sa(e))}))),e.B_}function Ga(e){return e.k_||(e.k_=function(e,t,n){const r=w(e);return r.m_(),new da(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:()=>Promise.resolve(),Io:Fa.bind(null,e),Eo:Ba.bind(null,e),A_:Va.bind(null,e),d_:ja.bind(null,e)}),e.x_.push((async t=>{t?(e.k_.e_(),await Oa(e)):(await e.k_.stop(),e.v_.length>0&&(f("RemoteStore",`Stopping write stream with ${e.v_.length} pending writes`),e.v_=[]))}))),e.k_}class Ka{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new E,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ka(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $a(e,t){if(p("AsyncQueue",`${t}: ${e}`),ue(e))return new _(b.UNAVAILABLE,`${t}: ${e}`);throw e}class Ha{constructor(e){this.comparator=e?(t,n)=>e(t,n)||q.comparator(t.key,n.key):(e,t)=>q.comparator(e.key,t.key),this.keyedMap=qn(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new Ha(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ha))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Ha;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Qa{constructor(){this.q_=new Ze(q.comparator)}track(e){const t=e.doc.key,n=this.q_.get(t);n?0!==e.type&&3===n.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==n.type?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.q_=this.q_.remove(t):1===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):y():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Wa{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Wa(e,t,Ha.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Ja{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some((e=>e.G_()))}}class Ya{constructor(){this.queries=new Vn((e=>On(e)),Nn),this.onlineState="Unknown",this.z_=new Set}}async function Xa(e,t){const n=w(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.W_()&&t.G_()&&(r=2):(s=new Ja,r=t.G_()?0:1);try{switch(r){case 0:s.K_=await n.onListen(i,!0);break;case 1:s.K_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=$a(e,`Initialization of query '${Pn(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.U_.push(t),t.j_(n.onlineState),s.K_&&t.H_(s.K_)&&nc(n)}async function Za(e,t){const n=w(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.U_.indexOf(t);e>=0&&(s.U_.splice(e,1),0===s.U_.length?i=t.G_()?0:1:!s.W_()&&t.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ec(e,t){const n=w(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.U_)t.H_(e)&&(r=!0);i.K_=e}}r&&nc(n)}function tc(e,t,n){const r=w(e),i=r.queries.get(t);if(i)for(const e of i.U_)e.onError(n);r.queries.delete(t)}function nc(e){e.z_.forEach((e=>{e.next()}))}var rc,ic;(ic=rc||(rc={})).J_="default",ic.Cache="cache";class sc{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Wa(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache)return!0;if(!this.G_())return!0;const n="Offline"!==t;return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}na(e){e=Wa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==rc.Cache}}class oc{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}}class ac{constructor(e){this.serializer=e}hs(e){return pi(this.serializer,e)}Ps(e){return e.metadata.exists?bi(this.serializer,e.document,!1):Ut.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return ui(e)}}class cc{constructor(e,t,n){this.oa=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uc(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;const n=j.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){const t=new Map,n=new ac(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.hs(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Wn()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=w(e);let s=Wn(),o=Bn();for(const e of n){const n=t.hs(e.metadata.name);e.document&&(s=s.add(n));const r=t.Ps(e);r.setReadTime(t.Is(e.metadata.readTime)),o=o.insert(n,r)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),c=await Mo(i,function(e){return Cn(xn(j.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>Po(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.qr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.qr.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.us,t.cs))).next((()=>t.us))))))}(this.localStore,new ac(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(const e of this.queries)await Uo(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}}}function uc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class lc{constructor(e){this.key=e}}class hc{constructor(e){this.key=e}}class dc{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Wn(),this.mutatedKeys=Wn(),this.Ia=Rn(e),this.Ta=new Ha(this.Ia)}get Ea(){return this.la}da(e,t){const n=t?t.Aa:new Qa,r=t?t.Ta:this.Ta;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=Ln(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Ra(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Ia(l,a)>0||c&&this.Ia(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ta:s,Aa:n,Zi:o,mutatedKeys:i}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const s=e.Aa.Q_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||this.Ia(e.doc,t.doc))),this.Va(n),r=null!=r&&r;const o=t&&!r?this.ma():[],a=0===this.Pa.size&&this.current&&!r?1:0,c=a!==this.ha;return this.ha=a,0!==s.length||c?{snapshot:new Wa(this.query,e.Ta,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:o}:{fa:o}}j_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Qa,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach((e=>this.la=this.la.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.la=this.la.delete(e))),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=Wn(),this.Ta.forEach((e=>{this.ga(e.key)&&(this.Pa=this.Pa.add(e.key))}));const t=[];return e.forEach((e=>{this.Pa.has(e)||t.push(new hc(e))})),this.Pa.forEach((n=>{e.has(n)||t.push(new lc(n))})),t}pa(e){this.la=e.ls,this.Pa=Wn();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Wa.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}class fc{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class pc{constructor(e){this.key=e,this.wa=!1}}class mc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Sa={},this.ba=new Vn((e=>On(e)),Nn),this.Da=new Map,this.Ca=new Set,this.va=new Ze(q.comparator),this.Fa=new Map,this.Ma=new co,this.xa={},this.Oa=new Map,this.Na=Fs.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return!0===this.La}}async function gc(e,t,n=!0){const r=Kc(e);let i;const s=r.ba.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=await vc(r,t,n,!0),i}async function yc(e,t){const n=Kc(e);await vc(n,t,!0,!1)}async function vc(e,t,n,r){const i=await Mo(e.localStore,Cn(t)),s=i.targetId,o=n?e.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=await wc(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&va(e.remoteStore,i),a}async function wc(e,t,n,r,i){e.Ba=(t,n,r)=>async function(e,t,n,r){let i=t.view.da(n);i.Zi&&(i=await Fo(e.localStore,t.query,!1).then((({documents:e})=>t.view.da(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Nc(e,t.targetId,a.fa),a.snapshot}(e,t,n,r);const s=await Fo(e.localStore,t,!0),o=new dc(t,s.ls),a=o.da(s.documents),c=Hr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);Nc(e,n,u.fa);const l=new fc(t,n,o);return e.ba.set(t,l),e.Da.has(n)?e.Da.get(n).push(t):e.Da.set(n,[t]),u.snapshot}async function bc(e,t,n){const r=w(e),i=r.ba.get(t),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter((e=>!Nn(e,t)))),void r.ba.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ro(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&wa(r.remoteStore,i.targetId),Ac(r,i.targetId)})).catch(ne)):(Ac(r,i.targetId),await Ro(r.localStore,i.targetId,!0))}async function _c(e,t){const n=w(e),r=n.ba.get(t),i=n.Da.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),wa(n.remoteStore,r.targetId))}async function Ec(e,t){const n=w(e);try{const e=await function(e,t){const n=w(e),r=t.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.qr.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(at.EMPTY_BYTE_STRING,F.min()).withLastLimboFreeSnapshotVersion(F.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.qr.updateTargetData(e,u))}));let a=Bn(),c=Wn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Po(e,s,t.documentUpdates).next((e=>{a=e.us,c=e.cs}))),!r.isEqual(F.min())){const t=n.qr.getLastRemoteSnapshotVersion(e).next((t=>n.qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return re.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Fa.get(t);r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.wa=!0:e.modifiedDocuments.size>0?v(r.wa):e.removedDocuments.size>0&&(v(r.wa),r.wa=!1))})),await Lc(n,e,t)}catch(e){await ne(e)}}function xc(e,t,n){const r=w(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ba.forEach(((n,r)=>{const i=r.view.j_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=w(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.U_)e.j_(t)&&(r=!0)})),r&&nc(n)}(r.eventManager,t),e.length&&r.Sa.l_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ic(e,t,n){const r=w(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Fa.get(t),s=i&&i.key;if(s){let e=new Ze(q.comparator);e=e.insert(s,Ut.newNoDocument(s,F.min()));const n=Wn().add(s),i=new $r(F.min(),new Map,new Ze(P),e,n);await Ec(r,i),r.va=r.va.remove(s),r.Fa.delete(t),Pc(r)}else await Ro(r.localStore,t,!1).then((()=>Ac(r,t,n))).catch(ne)}async function Sc(e,t){const n=w(e),r=t.batch.batchId;try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=re.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);v(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Wn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Dc(n,r,null),Cc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Lc(n,e)}catch(e){await ne(e)}}async function Tc(e,t,n){const r=w(e);try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(v(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Dc(r,t,n),Cc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Lc(r,e)}catch(n){await ne(n)}}function Cc(e,t){(e.Oa.get(t)||[]).forEach((e=>{e.resolve()})),e.Oa.delete(t)}function Dc(e,t,n){const r=w(e);let i=r.xa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.xa[r.currentUser.toKey()]=i}}function Ac(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Da.get(t))e.ba.delete(r),n&&e.Sa.ka(r,n);e.Da.delete(t),e.isPrimaryClient&&e.Ma.Rr(t).forEach((t=>{e.Ma.containsKey(t)||kc(e,t)}))}function kc(e,t){e.Ca.delete(t.path.canonicalString());const n=e.va.get(t);null!==n&&(wa(e.remoteStore,n),e.va=e.va.remove(t),e.Fa.delete(n),Pc(e))}function Nc(e,t,n){for(const r of n)r instanceof lc?(e.Ma.addReference(r.key,t),Oc(e,r)):r instanceof hc?(f("SyncEngine","Document no longer in limbo: "+r.key),e.Ma.removeReference(r.key,t),e.Ma.containsKey(r.key)||kc(e,r.key)):y()}function Oc(e,t){const n=t.key,r=n.path.canonicalString();e.va.get(n)||e.Ca.has(r)||(f("SyncEngine","New document in limbo: "+n),e.Ca.add(r),Pc(e))}function Pc(e){for(;e.Ca.size>0&&e.va.size<e.maxConcurrentLimboResolutions;){const t=e.Ca.values().next().value;e.Ca.delete(t);const n=new q(j.fromString(t)),r=e.Na.next();e.Fa.set(r,new pc(n)),e.va=e.va.insert(n,r),va(e.remoteStore,new Mi(Cn(xn(n.path)),r,"TargetPurposeLimboResolution",ge.oe))}}async function Lc(e,t,n){const r=w(e),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach(((e,a)=>{o.push(r.Ba(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=To.Qi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Sa.l_(i),await async function(e,t){const n=w(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>re.forEach(t,(t=>re.forEach(t.ki,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>re.forEach(t.qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ue(e))throw e;f("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ts.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.ts=n.ts.insert(t,i)}}}(r.localStore,s))}async function Mc(e,t){const n=w(e);if(!n.currentUser.isEqual(t)){f("SyncEngine","User change. New user:",t.toKey());const e=await No(n.localStore,t);n.currentUser=t,function(e,t){e.Oa.forEach((e=>{e.forEach((e=>{e.reject(new _(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Oa.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Lc(n,e._s)}}function Rc(e,t){const n=w(e),r=n.Fa.get(t);if(r&&r.wa)return Wn().add(r.key);{let e=Wn();const r=n.Da.get(t);if(!r)return e;for(const t of r){const r=n.ba.get(t);e=e.unionWith(r.view.Ea)}return e}}async function Fc(e,t){const n=w(e),r=await Fo(n.localStore,t.query,!0),i=t.view.pa(r);return n.isPrimaryClient&&Nc(n,t.targetId,i.fa),i}async function Vc(e,t){const n=w(e);return jo(n.localStore,t).then((e=>Lc(n,e)))}async function jc(e,t,n,r){const i=w(e),s=await function(e,t){const n=w(e),r=w(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Cn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):re.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Oa(i.remoteStore):"acknowledged"===n||"rejected"===n?(Dc(i,t,r||null),Cc(i,t),function(e,t){w(w(e).mutationQueue).Fn(t)}(i.localStore,t)):y(),await Lc(i,s)):f("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Bc(e,t,n){const r=w(e),i=[],s=[];for(const e of t){let t;const n=r.Da.get(e);if(n&&0!==n.length){t=await Mo(r.localStore,Cn(n[0]));for(const e of n){const t=r.ba.get(e),n=await Fc(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await Vo(r.localStore,e);t=await Mo(r.localStore,n),await wc(r,Uc(n),e,!1,t.resumeToken)}i.push(t)}return r.Sa.l_(s),i}function Uc(e){return En(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function qc(e){return function(e){return w(w(e).persistence).Li()}(w(e).localStore)}async function zc(e,t,n,r){const i=w(e);if(i.La)return void f("SyncEngine","Ignoring unexpected query state notification.");const s=i.Da.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await jo(i.localStore,Mn(s[0])),r=$r.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,at.EMPTY_BYTE_STRING);await Lc(i,e,r);break}case"rejected":await Ro(i.localStore,t,!0),Ac(i,t,r);break;default:y()}}async function Gc(e,t,n){const r=Kc(e);if(r.La){for(const e of t){if(r.Da.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){f("SyncEngine","Adding an already active target "+e);continue}const t=await Vo(r.localStore,e),n=await Mo(r.localStore,t);await wc(r,Uc(t),n.targetId,!1,n.resumeToken),va(r.remoteStore,n)}for(const e of n)r.Da.has(e)&&await Ro(r.localStore,e,!1).then((()=>{wa(r.remoteStore,e),Ac(r,e)})).catch(ne)}}function Kc(e){const t=w(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ec.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Rc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ic.bind(null,t),t.Sa.l_=ec.bind(null,t.eventManager),t.Sa.ka=tc.bind(null,t.eventManager),t}function $c(e){const t=w(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Sc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Tc.bind(null,t),t}class Hc{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ca(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return ko(this.persistence,new Do,e.initialUser,this.serializer)}createPersistence(e){return new mo(yo.jr,this.serializer)}createSharedClientState(e){return new Yo}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Qc extends Hc{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){v(this.persistence.referenceDelegate instanceof vo);const n=this.persistence.referenceDelegate.garbageCollector;return new Gs(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new mo((e=>vo.jr(e,t)),this.serializer)}}class Wc extends Hc{constructor(e,t,n){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Qa.initialize(this,e),await $c(this.Qa.syncEngine),await Oa(this.Qa.remoteStore),await this.persistence.mi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return ko(this.persistence,new Do,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Gs(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new me(t,this.persistence);return new pe(e.asyncQueue,n)}createPersistence(e){const t=So(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new Eo(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,oa(),aa(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Yo}}class Jc extends Wc{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Qa.syncEngine;this.sharedClientState instanceof Jo&&(this.sharedClientState.syncEngine={Ys:jc.bind(null,t),Zs:zc.bind(null,t),Xs:Gc.bind(null,t),Li:qc.bind(null,t),Js:Vc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi((async e=>{await async function(e,t){const n=w(e);if(Kc(n),$c(n),!0===t&&!0!==n.La){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Bc(n,e.toArray());n.La=!0,await qa(n.remoteStore,!0);for(const e of t)va(n.remoteStore,e)}else if(!1===t&&!1!==n.La){const e=[];let t=Promise.resolve();n.Da.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(Ac(n,i),Ro(n.localStore,i,!0)))),wa(n.remoteStore,i)})),await t,await Bc(n,e),function(e){const t=w(e);t.Fa.forEach(((e,n)=>{wa(t.remoteStore,n)})),t.Ma.Vr(),t.Fa=new Map,t.va=new Ze(q.comparator)}(n),n.La=!1,await qa(n.remoteStore,!1)}}(this.Qa.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=oa();if(!Jo.D(t))throw new _(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=So(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jo(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Yc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>xc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mc.bind(null,this.syncEngine),await qa(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ya}createDatastore(e){const t=ca(e.databaseInfo.databaseId),n=function(e){return new sa(e)}(e.databaseInfo);return function(e,t,n,r){return new fa(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ma(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>xc(this.syncEngine,e,0)),Zo.D()?new Zo:new Xo)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new mc(e,t,n,r,i,s);return o&&(a.La=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=w(e);f("RemoteStore","RemoteStore shutting down."),t.M_.add(5),await ya(t),t.O_.shutdown(),t.N_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}function Xc(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Zc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):p("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class eu{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new E,this.buffer=new Uint8Array,this.Wa=new TextDecoder("utf-8"),this.Ga().then((e=>{e&&e.sa()?this.metadata.resolve(e.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.ia)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Ua.cancel()}async getMetadata(){return this.metadata.promise}async qa(){return await this.getMetadata(),this.Ga()}async Ga(){const e=await this.za();if(null===e)return null;const t=this.Wa.decode(e),n=Number(t);isNaN(n)&&this.ja(`length string (${t}) is not valid number`);const r=await this.Ha(n);return new oc(JSON.parse(r),e.length+n)}Ja(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async za(){for(;this.Ja()<0&&!await this.Ya(););if(0===this.buffer.length)return null;const e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ha(e){for(;this.buffer.length<e;)await this.Ya()&&this.ja("Reached the end of bundle when more is expected.");const t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ya(){const e=await this.Ua.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class tu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new _(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=w(e),r={documents:t.map((e=>fi(n.serializer,e)))},i=await n.Mo("BatchGetDocuments",n.serializer.databaseId,j.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){v(!!t.found),t.found.name,t.found.updateTime;const n=pi(e,t.found.name),r=ui(t.found.updateTime),i=t.found.createTime?ui(t.found.createTime):F.min(),s=new jt({mapValue:{fields:t.found.fields}});return Ut.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){v(!!t.missing),v(!!t.readTime);const n=pi(e,t.missing),r=ui(t.readTime);return Ut.newNoDocument(n,r)}(e,t):y()}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());v(!!t),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Dr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=q.fromPath(t);this.mutations.push(new Ar(n,this.precondition(n)))})),await async function(e,t){const n=w(e),r={writes:t.map((e=>_i(n.serializer,e)))};await n.Do("Commit",n.serializer.databaseId,j.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw y();t=F.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new _(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(F.min())?mr.exists(!1):mr.updateTime(t):mr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(F.min()))throw new _(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mr.updateTime(t)}return mr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class nu{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Za=n.maxAttempts,this.Jo=new ua(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Jo.Ko((async()=>{const e=new tu(this.datastore),t=this.tu(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.nu(e)}))))})).catch((e=>{this.nu(e)}))}))}tu(e){try{const t=this.updateFunction(e);return!ye(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget((()=>(this.eu(),Promise.resolve())))):this.deferred.reject(e)}ru(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Fr(t)}return!1}}class ru{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=u.UNAUTHENTICATED,this.clientId=O.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{f("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(f("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new E;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=$a(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function iu(e,t){e.asyncQueue.verifyOperationInProgress(),f("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await No(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function su(e,t){e.asyncQueue.verifyOperationInProgress();const n=await au(e);f("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ua(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ua(t.remoteStore,n))),e._onlineComponents=t}function ou(e){return"FirebaseError"===e.name?e.code===b.FAILED_PRECONDITION||e.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function au(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){f("FirestoreClient","Using user provided OfflineComponentProvider");try{await iu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!ou(n))throw n;m("Error using user provided cache. Falling back to memory cache: "+n),await iu(e,new Hc)}}else f("FirestoreClient","Using default OfflineComponentProvider"),await iu(e,new Hc);return e._offlineComponents}async function cu(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(f("FirestoreClient","Using user provided OnlineComponentProvider"),await su(e,e._uninitializedComponentsProvider._online)):(f("FirestoreClient","Using default OnlineComponentProvider"),await su(e,new Yc))),e._onlineComponents}function uu(e){return au(e).then((e=>e.persistence))}function lu(e){return au(e).then((e=>e.localStore))}function hu(e){return cu(e).then((e=>e.remoteStore))}function du(e){return cu(e).then((e=>e.syncEngine))}function fu(e){return cu(e).then((e=>e.datastore))}async function pu(e){const t=await cu(e),n=t.eventManager;return n.onListen=gc.bind(null,t.syncEngine),n.onUnlisten=bc.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=yc.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=_c.bind(null,t.syncEngine),n}function mu(e,t,n={}){const r=new E;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Zc({next:s=>{t.enqueueAndForget((()=>Za(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new _(b.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new sc(xn(n.path),s,{includeMetadataChanges:!0,ra:!0});return Xa(e,o)}(await pu(e),e.asyncQueue,t,n,r))),r.promise}function gu(e,t,n={}){const r=new E;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Zc({next:n=>{t.enqueueAndForget((()=>Za(e,o))),n.fromCache&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new sc(n,s,{includeMetadataChanges:!0,ra:!0});return Xa(e,o)}(await pu(e),e.asyncQueue,t,n,r))),r.promise}function yu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const vu=new Map;function wu(e,t,n){if(!n)throw new _(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function bu(e,t,n,r){if(!0===t&&!0===r)throw new _(b.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function _u(e){if(!q.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Eu(e){if(q.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":y()}function Iu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xu(e);throw new _(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Su(e,t){if(t<=0)throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Tu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new _(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bu("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tu(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new I;switch(e.type){case"firstParty":return new D(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new _(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=vu.get(e);t&&(f("ComponentProvider","Removing Datastore"),vu.delete(e),t.terminate())}(this),Promise.resolve()}}function Du(e,t,n,r={}){var i;const s=(e=Iu(e,Cu))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&m("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=u.MOCK_USER;else{t=o.createMockUserToken(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new _(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(s)}e._authCredentials=new S(new x(t,n))}}class Au{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Au(this.firestore,e,this._query)}}class ku{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ku(this.firestore,e,this._key)}}class Nu extends Au{constructor(e,t,n){super(e,t,xn(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ku(this.firestore,null,new q(e))}withConverter(e){return new Nu(this.firestore,e,this._path)}}function Ou(e,t,...n){if(e=o.getModularInstance(e),1===arguments.length&&(t=O.newId()),wu("doc","path",t),e instanceof Cu){const r=j.fromString(t,...n);return _u(r),new ku(e,null,new q(r))}{if(!(e instanceof ku||e instanceof Nu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(j.fromString(t,...n));return _u(r),new ku(e.firestore,e instanceof Nu?e.converter:null,new q(r))}}function Pu(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),e instanceof Au&&t instanceof Au&&e.firestore===t.firestore&&Nn(e._query,t._query)&&e.converter===t.converter}class Lu{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new ua(this,"async_queue_retry"),this.hu=()=>{const e=aa();e&&f("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Jo.Uo()};const e=aa();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=aa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise((()=>{}));const t=new E;return this.Iu((()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.su.push(e),this.Tu())))}async Tu(){if(0!==this.su.length){try{await this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!ue(e))throw e;f("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko((()=>this.Tu()))}}Iu(e){const t=this.iu.then((()=>(this.uu=!0,e().catch((e=>{this.au=e,this.uu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw p("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.uu=!1,e))))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const r=Ka.createAndSchedule(this,e,t,n,(e=>this.Eu(e)));return this._u.push(r),r}Pu(){this.au&&y()}verifyOperationInProgress(){}async du(){let e;do{e=this.iu,await e}while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then((()=>{this._u.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()}))}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}function Mu(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Ru{constructor(){this._progressObserver={},this._taskCompletionResolver=new E,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Fu extends Cu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Lu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ju(this),this._firestoreClient.terminate()}}function Vu(e){return e._firestoreClient||ju(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ju(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new mt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,yu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new ru(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Bu(e,t,n){const r=new E;return e.asyncQueue.enqueue((async()=>{try{await iu(e,n),await su(e,t),r.resolve()}catch(e){const t=e;if(!ou(t))throw t;m("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function Uu(e){if(e._initialized||e._terminated)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class qu{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class zu{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Gu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gu(at.fromBase64String(e))}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Gu(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ku{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new _(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new U(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class $u{constructor(e){this._methodName=e}}class Hu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return P(this._lat,e._lat)||P(this._long,e._long)}}const Qu=/^__.*__$/;class Wu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ir(e,this.data,this.fieldMask,t,this.fieldTransforms):new xr(e,this.data,t,this.fieldTransforms)}}class Ju{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ir(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Yu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}class Xu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new Xu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.wu(e),r}Su(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return vl(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(Yu(this.fu)&&Qu.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class Zu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ca(e)}Fu(e,t,n,r=!1){return new Xu({fu:e,methodName:t,vu:n,path:U.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function el(e){const t=e._freezeSettings(),n=ca(e._databaseId);return new Zu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function tl(e,t,n,r,i,s={}){const o=e.Fu(s.merge||s.mergeFields?2:0,t,n,i);pl("Data must be an object, but it was:",o,r);const a=dl(r,o);let c,u;if(s.merge)c=new st(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=ml(t,r,n);if(!o.contains(i))throw new _(b.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);wl(e,i)||e.push(i)}c=new st(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Wu(new jt(a),c,u)}class nl extends $u{_toFieldTransform(e){if(2!==e.fu)throw 1===e.fu?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nl}}function rl(e,t,n){return new Xu({fu:3,vu:t.settings.vu,methodName:e._methodName,yu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class il extends $u{_toFieldTransform(e){return new fr(e.path,new sr)}isEqual(e){return e instanceof il}}class sl extends $u{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=rl(this,e,!0),n=this.Mu.map((e=>hl(e,t))),r=new or(n);return new fr(e.path,r)}isEqual(e){return e instanceof sl&&o.deepEqual(this.Mu,e.Mu)}}class ol extends $u{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=rl(this,e,!0),n=this.Mu.map((e=>hl(e,t))),r=new cr(n);return new fr(e.path,r)}isEqual(e){return e instanceof ol&&o.deepEqual(this.Mu,e.Mu)}}class al extends $u{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){const t=new lr(e.serializer,er(e.serializer,this.xu));return new fr(e.path,t)}isEqual(e){return e instanceof al&&this.xu===e.xu}}function cl(e,t,n,r){const i=e.Fu(1,t,n);pl("Data must be an object, but it was:",i,r);const s=[],a=jt.empty();Ye(r,((e,r)=>{const c=yl(t,e,n);r=o.getModularInstance(r);const u=i.Su(c);if(r instanceof nl)s.push(c);else{const e=hl(r,u);null!=e&&(s.push(c),a.set(c,e))}}));const c=new st(s);return new Ju(a,c,i.fieldTransforms)}function ul(e,t,n,r,i,s){const a=e.Fu(1,t,n),c=[ml(t,r,n)],u=[i];if(s.length%2!=0)throw new _(b.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)c.push(ml(t,s[e])),u.push(s[e+1]);const l=[],h=jt.empty();for(let e=c.length-1;e>=0;--e)if(!wl(l,c[e])){const t=c[e];let n=u[e];n=o.getModularInstance(n);const r=a.Su(t);if(n instanceof nl)l.push(t);else{const e=hl(n,r);null!=e&&(l.push(t),h.set(t,e))}}const d=new st(l);return new Ju(h,d,a.fieldTransforms)}function ll(e,t,n,r=!1){return hl(n,e.Fu(r?4:3,t))}function hl(e,t){if(fl(e=o.getModularInstance(e)))return pl("Unsupported field value:",t,e),dl(e,t);if(e instanceof $u)return function(e,t){if(!Yu(t.fu))throw t.Du(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Du(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.yu&&4!==t.fu)throw t.Du("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=hl(i,t.bu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=o.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return er(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=R.fromDate(e);return{timestampValue:oi(t.serializer,n)}}if(e instanceof R){const n=new R(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:oi(t.serializer,n)}}if(e instanceof Hu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Gu)return{bytesValue:ai(t.serializer,e._byteString)};if(e instanceof ku){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Du(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:li(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Du(`Unsupported field value: ${xu(e)}`)}(e,t)}function dl(e,t){const n={};return Xe(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ye(e,((e,r)=>{const i=hl(r,t.pu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function fl(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof R||e instanceof Hu||e instanceof Gu||e instanceof ku||e instanceof $u)}function pl(e,t,n){if(!fl(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=xu(n);throw"an object"===r?t.Du(e+" a custom object"):t.Du(e+" "+r)}}function ml(e,t,n){if((t=o.getModularInstance(t))instanceof Ku)return t._internalPath;if("string"==typeof t)return yl(e,t);throw vl("Field path arguments must be of type string or ",e,!1,void 0,n)}const gl=new RegExp("[~\\*/\\[\\]]");function yl(e,t,n){if(t.search(gl)>=0)throw vl(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ku(...t.split("."))._internalPath}catch(r){throw vl(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function vl(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new _(b.INVALID_ARGUMENT,a+e+c)}function wl(e,t){return e.some((e=>e.isEqual(t)))}class bl{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ku(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new _l(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(El("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class _l extends bl{data(){return super.data()}}function El(e,t){return"string"==typeof t?yl(e,t):t instanceof Ku?t._internalPath:t._delegate._internalPath}function xl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new _(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Il{}class Sl extends Il{}class Tl extends Sl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Tl(e,t,n)}_apply(e){const t=this._parse(e);return Ml(e._query,t),new Au(e.firestore,e.converter,An(e._query,t))}_parse(e){const t=el(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new _(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Ll(o,s);const t=[];for(const n of o)t.push(Pl(r,e,n));a={arrayValue:{values:t}}}else a=Pl(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ll(o,s),a=ll(n,"where",o,"in"===s||"not-in"===s);return Qt.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Cl extends Il{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cl(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Wt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Ml(n,e),n=An(n,e)}(e._query,t),new Au(e.firestore,e.converter,An(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Dl extends Sl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Dl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Kt(t,n)}(e._query,this._field,this._direction);return new Au(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new _n(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Al extends Sl{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Al(e,t,n)}_apply(e){return new Au(e.firestore,e.converter,kn(e._query,this._limit,this._limitType))}}class kl extends Sl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new kl(e,t,n)}_apply(e){const t=Ol(e,this.type,this._docOrFields,this._inclusive);return new Au(e.firestore,e.converter,function(e,t){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class Nl extends Sl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Nl(e,t,n)}_apply(e){const t=Ol(e,this.type,this._docOrFields,this._inclusive);return new Au(e.firestore,e.converter,function(e,t){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Ol(e,t,n,r){if(n[0]=o.getModularInstance(n[0]),n[0]instanceof bl)return function(e,t,n,r,i){if(!r)throw new _(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of Tn(e))if(n.field.isKeyField())s.push(Ct(t,r.key));else{const e=r.data.field(n.field);if(dt(e))throw new _(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new _(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new qt(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=el(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new _(b.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new _(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!Sn(e)&&-1!==c.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(j.fromString(c));if(!q.isDocumentKey(n))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new q(n);a.push(Ct(t,i))}else{const e=ll(n,r,c);a.push(e)}}return new qt(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Pl(e,t,n){if("string"==typeof(n=o.getModularInstance(n))){if(""===n)throw new _(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sn(t)&&-1!==n.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(j.fromString(n));if(!q.isDocumentKey(r))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ct(e,new q(r))}if(n instanceof ku)return Ct(e,n._key);throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xu(n)}.`)}function Ll(e,t){if(!Array.isArray(e)||0===e.length)throw new _(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ml(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Rl(e,t){if(!(t instanceof Tl||t instanceof Cl))throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Fl{convertValue(e,t="none"){switch(wt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ht(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ye(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Hu(lt(e.latitude),lt(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ft(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(pt(e));default:return null}}convertTimestamp(e){const t=ut(e);return new R(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=j.fromString(e);v(Li(n));const r=new gt(n.get(1),n.get(3)),i=new q(n.popFirst(5));return r.isEqual(t)||p(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Vl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class jl extends Fl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ku(this.firestore,null,t)}}function Bl(){return new qu("count")}class Ul{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ql extends bl{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(El("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class zl extends ql{data(e={}){return super.data(e)}}class Gl{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ul(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new zl(this._firestore,this._userDataWriter,n.key,n,new Ul(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new zl(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ul(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new zl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ul(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Kl(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Kl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}class $l extends Fl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ku(this.firestore,null,t)}}function Hl(e,t){return function(e,t){const n=new E;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=$c(e);try{const e=await function(e,t){const n=w(e),r=R.now(),i=t.reduce(((e,t)=>e.add(t.key)),Wn());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Bn(),c=Wn();return n.ss.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=_r(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Ir(e.key,t,Bt(t.value.mapValue),mr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:zn(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xa[e.currentUser.toKey()];r||(r=new Ze(P)),r=r.insert(t,n),e.xa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Lc(r,e.changes),await Oa(r.remoteStore)}catch(e){const t=$a(e,"Failed to persist write");n.reject(t)}}(await du(e),t,n))),n.promise}(Vu(e),t)}function Ql(e,t,n){const r=n.docs.get(t._key),i=new $l(e);return new ql(e,i,t._key,r,new Ul(n.hasPendingWrites,n.fromCache),t.converter)}function Wl(e,t){const n=Iu(e.firestore,Fu),r=Vu(n),i=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,((e,t)=>new Pr(t,e.aggregateType,e._internalFieldPath)));return function(e,t,n){const r=new E;return e.asyncQueue.enqueueAndForget((async()=>{try{const i=await fu(e);r.resolve(async function(e,t,n){var r;const i=w(e),{request:s,f_:o,parent:a}=function(e,t,n){const{_t:r,parent:i}=Ii(e,t),s={},o=[];let a=0;return n.forEach((e=>{const t="aggregate_"+a++;s[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:ki(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:ki(e.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:r.structuredQuery},parent:r.parent},f_:s,parent:i}}(i.serializer,function(e){const t=w(e);return t.he||(t.he=Dn(t,e.explicitOrderBy)),t.he}(t),n);i.connection.bo||delete s.parent;const c=(await i.Mo("RunAggregationQuery",i.serializer.databaseId,a,s,1)).filter((e=>!!e.result));v(1===c.length);const u=null===(r=c[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce(((e,t)=>(e[o[t]]=u[t],e)),{})}(i,t,n))}catch(e){r.reject(e)}})),r.promise}(r,e._query,i).then((t=>function(e,t,n){const r=new $l(e);return new zu(t,r,n)}(n,e,t)))}class Jl{constructor(e){this.kind="memory",this._onlineComponentProvider=new Yc,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new Hc}toJSON(){return{kind:this.kind}}}class Yl{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=nh(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Xl{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new Hc}toJSON(){return{kind:this.kind}}}class Zl{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new Qc(e)}toJSON(){return{kind:this.kind}}}class eh{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Yc,this._offlineComponentProvider=new Wc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class th{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Yc,this._offlineComponentProvider=new Jc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function nh(e){return new eh(null==e?void 0:e.forceOwnership)}const rh={maxAttempts:5};class ih{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=el(e)}set(e,t,n){this._verifyNotCommitted();const r=sh(e,this._firestore),i=Vl(r.converter,t,n),s=tl(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,mr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=sh(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ku?ul(this._dataReader,"WriteBatch.update",i._key,t,n,r):cl(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,mr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=sh(e,this._firestore);return this._mutations=this._mutations.concat(new Dr(t._key,mr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function sh(e,t){if((e=o.getModularInstance(e)).firestore!==t)throw new _(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class oh extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=el(e)}get(e){const t=sh(e,this._firestore),n=new jl(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return y();const r=e[0];if(r.isFoundDocument())return new bl(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new bl(this._firestore,n,t._key,null,t.converter);throw y()}))}set(e,t,n){const r=sh(e,this._firestore),i=Vl(r.converter,t,n),s=tl(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=sh(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ku?ul(this._dataReader,"Transaction.update",i._key,t,n,r):cl(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=sh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=sh(e,this._firestore),n=new $l(this._firestore);return super.get(e).then((e=>new ql(this._firestore,n,t._key,e._document,new Ul(!1,!1),t.converter)))}}function ah(e,t){if("string"!=typeof e[t])throw new _(b.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class ch{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}}function uh(e,t){e._client.verifyNotTerminated(),function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){w(e).es.$i=t}(await lu(e),t)))}(e._client,t).then((e=>f(`setting persistent cache index auto creation isEnabled=${t} succeeded`))).catch((e=>m(`setting persistent cache index auto creation isEnabled=${t} failed`,e)))}const lh=new WeakMap;class hh{constructor(){this.Ou=new Map}static get instance(){return dh||(dh=new hh,function(e){if(jr)throw new Error("a TestingHooksSpi instance is already set");jr=e}(dh)),dh}et(e){this.Ou.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Ou;return n.set(t,e),()=>n.delete(t)}}let dh=null;!function(e,t=!0){!function(e){l=e}(r.SDK_VERSION),r._registerComponent(new i.Component("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new Fu(new T(e.getProvider("auth-internal")),new k(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gt(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),r.registerVersion(c,"4.6.1",e),r.registerVersion(c,"4.6.1","cjs2017")}(),t.AbstractUserDataWriter=Fl,t.AggregateField=qu,t.AggregateQuerySnapshot=zu,t.Bytes=Gu,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=Nu,t.DocumentReference=ku,t.DocumentSnapshot=ql,t.FieldPath=Ku,t.FieldValue=$u,t.Firestore=Fu,t.FirestoreError=_,t.GeoPoint=Hu,t.LoadBundleTask=Ru,t.PersistentCacheIndexManager=ch,t.Query=Au,t.QueryCompositeFilterConstraint=Cl,t.QueryConstraint=Sl,t.QueryDocumentSnapshot=zl,t.QueryEndAtConstraint=Nl,t.QueryFieldFilterConstraint=Tl,t.QueryLimitConstraint=Al,t.QueryOrderByConstraint=Dl,t.QuerySnapshot=Gl,t.QueryStartAtConstraint=kl,t.SnapshotMetadata=Ul,t.Timestamp=R,t.Transaction=oh,t.WriteBatch=ih,t._AutoId=O,t._ByteString=at,t._DatabaseId=gt,t._DocumentKey=q,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new A(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=I,t._FieldPath=U,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return hh.instance.onExistenceFilterMismatch(e)}},t._cast=Iu,t._debugAssert=function(e,t){e||y()},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=m,t._validateIsNotUsedTogether=bu,t.addDoc=function(e,t){const n=Iu(e.firestore,Fu),r=Ou(e),i=Vl(e.converter,t);return Hl(n,[tl(el(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,mr.exists(!1))]).then((()=>r))},t.aggregateFieldEqual=function(e,t){var n,r;return e instanceof qu&&t instanceof qu&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Pu(e.query,t.query)&&o.deepEqual(e.data(),t.data())},t.and=function(...e){return e.forEach((e=>Rl("and",e))),Cl._create("and",e)},t.arrayRemove=function(...e){return new ol("arrayRemove",e)},t.arrayUnion=function(...e){return new sl("arrayUnion",e)},t.average=function(e){return new qu("avg",ml("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new _(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new E;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!se.D())return Promise.resolve();const t=e+"main";await se.delete(t)}(So(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise},t.collection=function(e,t,...n){if(e=o.getModularInstance(e),wu("collection","path",t),e instanceof Cu){const r=j.fromString(t,...n);return Eu(r),new Nu(e,null,r)}{if(!(e instanceof ku||e instanceof Nu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(j.fromString(t,...n));return Eu(r),new Nu(e.firestore,null,r)}},t.collectionGroup=function(e,t){if(e=Iu(e,Cu),wu("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Au(e,null,function(e){return new _n(j.emptyPath(),e)}(t))},t.connectFirestoreEmulator=Du,t.count=Bl,t.deleteAllPersistentCacheIndexes=function(e){e._client.verifyNotTerminated(),function(e){return e.asyncQueue.enqueue((async()=>function(e){const t=w(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",(e=>n.deleteAllFieldIndexes(e)))}(await lu(e))))}(e._client).then((e=>f("deleting all persistent cache indexes succeeded"))).catch((e=>m("deleting all persistent cache indexes failed",e)))},t.deleteDoc=function(e){return Hl(Iu(e.firestore,Fu),[new Dr(e._key,mr.none())])},t.deleteField=function(){return new nl("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await uu(e),n=await hu(e);return t.setNetworkEnabled(!1),async function(e){const t=w(e);t.M_.add(0),await ya(t),t.N_.set("Offline")}(n)}))}(Vu(e=Iu(e,Fu)))},t.disablePersistentCacheIndexAutoCreation=function(e){uh(e,!1)},t.doc=Ou,t.documentId=function(){return new Ku("__name__")},t.enableIndexedDbPersistence=function(e,t){Uu(e=Iu(e,Fu));const n=Vu(e);if(n._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Yc;return Bu(n,i,new Wc(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(e){Uu(e=Iu(e,Fu));const t=Vu(e);if(t._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Yc;return Bu(t,r,new Jc(r,n.cacheSizeBytes))},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await uu(e),n=await hu(e);return t.setNetworkEnabled(!0),function(e){const t=w(e);return t.M_.delete(0),ga(t)}(n)}))}(Vu(e=Iu(e,Fu)))},t.enablePersistentCacheIndexAutoCreation=function(e){uh(e,!0)},t.endAt=function(...e){return Nl._create("endAt",e,!0)},t.endBefore=function(...e){return Nl._create("endBefore",e,!1)},t.ensureFirestoreConfigured=Vu,t.executeWrite=Hl,t.getAggregateFromServer=Wl,t.getCountFromServer=function(e){return Wl(e,{count:Bl()})},t.getDoc=function(e){e=Iu(e,ku);const t=Iu(e.firestore,Fu);return mu(Vu(t),e._key).then((n=>Ql(t,e,n)))},t.getDocFromCache=function(e){e=Iu(e,ku);const t=Iu(e.firestore,Fu),n=Vu(t),r=new $l(t);return function(e,t){const n=new E;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=w(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new _(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=$a(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await lu(e),t,n))),n.promise}(n,e._key).then((n=>new ql(t,r,e._key,n,new Ul(null!==n&&n.hasLocalMutations,!0),e.converter)))},t.getDocFromServer=function(e){e=Iu(e,ku);const t=Iu(e.firestore,Fu);return mu(Vu(t),e._key,{source:"server"}).then((n=>Ql(t,e,n)))},t.getDocs=function(e){e=Iu(e,Au);const t=Iu(e.firestore,Fu),n=Vu(t),r=new $l(t);return xl(e._query),gu(n,e._query).then((n=>new Gl(t,r,e,n)))},t.getDocsFromCache=function(e){e=Iu(e,Au);const t=Iu(e.firestore,Fu),n=Vu(t),r=new $l(t);return function(e,t){const n=new E;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Fo(e,t,!0),i=new dc(t,r.ls),s=i.da(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=$a(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await lu(e),t,n))),n.promise}(n,e._query).then((n=>new Gl(t,r,e,n)))},t.getDocsFromServer=function(e){e=Iu(e,Au);const t=Iu(e.firestore,Fu),n=Vu(t),r=new $l(t);return gu(n,e._query,{source:"server"}).then((n=>new Gl(t,r,e,n)))},t.getFirestore=function(e,t){const n="object"==typeof e?e:r.getApp(),i="string"==typeof e?e:t||"(default)",s=r._getProvider(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const e=o.getDefaultEmulatorHostnameAndPort("firestore");e&&Du(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=Iu(e,Fu);const n=lh.get(e);if(n)return n;const r=Vu(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;const i=new ch(r);return lh.set(e,i),i},t.increment=function(e){return new al("increment",e)},t.initializeFirestore=function(e,t,n){n||(n="(default)");const i=r._getProvider(e,"firestore");if(i.isInitialized(n)){const e=i.getImmediate({identifier:n}),r=i.getOptions(n);if(o.deepEqual(r,t))return e;throw new _(b.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new _(b.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:n})},t.limit=function(e){return Su("limit",e),Al._create("limit",e,"F")},t.limitToLast=function(e){return Su("limitToLast",e),Al._create("limitToLast",e,"L")},t.loadBundle=function(e,t){const n=Vu(e=Iu(e,Fu)),r=new Ru;return function(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Br().encode(e):e,function(e,t){return new eu(e,t)}(function(e,t){if(e instanceof Uint8Array)return Xc(e,t);if(e instanceof ArrayBuffer)return Xc(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,ca(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=w(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=w(e),r=ui(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Kr.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(uc(r));const i=new cc(r,e.localStore,t.serializer);let s=await t.qa();for(;s;){const e=await i._a(s);e&&n._updateProgress(e),s=await t.qa()}const o=await i.complete();return await Lc(e,o.ca,void 0),await function(e,t){const n=w(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Kr.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.ua)}catch(e){return m("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await du(e),i,r)}))}(n,e._databaseId,t,r),r},t.memoryEagerGarbageCollector=function(){return new Xl},t.memoryLocalCache=function(e){return new Jl(e)},t.memoryLruGarbageCollector=function(e){return new Zl(null==e?void 0:e.cacheSizeBytes)},t.namedQuery=function(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=w(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Kr.getNamedQuery(e,t)))}(await lu(e),t)))}(Vu(e=Iu(e,Fu)),t).then((t=>t?new Au(e,null,t.query):null))},t.onSnapshot=function(e,...t){var n,r,i;e=o.getModularInstance(e);let s={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof t[a]||Mu(t[a])||(s=t[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Mu(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof ku)l=Iu(e.firestore,Fu),h=xn(e._key.path),u={next:n=>{t[a]&&t[a](Ql(l,e,n))},error:t[a+1],complete:t[a+2]};else{const n=Iu(e,Au);l=Iu(n.firestore,Fu),h=n._query;const r=new $l(l);u={next:e=>{t[a]&&t[a](new Gl(l,r,n,e))},error:t[a+1],complete:t[a+2]},xl(e._query)}return function(e,t,n,r){const i=new Zc(r),s=new sc(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Xa(await pu(e),s))),()=>{i.$a(),e.asyncQueue.enqueueAndForget((async()=>Za(await pu(e),s)))}}(Vu(l),h,c,u)},t.onSnapshotsInSync=function(e,t){return function(e,t){const n=new Zc(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).z_.add(t),t.next()}(await pu(e),n))),()=>{n.$a(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).z_.delete(t)}(await pu(e),n)))}}(Vu(e=Iu(e,Fu)),Mu(t)?t:{next:t})},t.or=function(...e){return e.forEach((e=>Rl("or",e))),Cl._create("or",e)},t.orderBy=function(e,t="asc"){const n=t,r=El("orderBy",e);return Dl._create(r,n)},t.persistentLocalCache=function(e){return new Yl(e)},t.persistentMultipleTabManager=function(){return new th},t.persistentSingleTabManager=nh,t.query=function(e,t,...n){let r=[];t instanceof Il&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof Cl)).length,n=e.filter((e=>e instanceof Tl)).length;if(t>1||t>0&&n>0)throw new _(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e},t.queryEqual=Pu,t.refEqual=function(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),(e instanceof ku||e instanceof Nu)&&(t instanceof ku||t instanceof Nu)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,n){e=Iu(e,Fu);const r=Object.assign(Object.assign({},rh),n);return function(e){if(e.maxAttempts<1)throw new _(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new E;return e.asyncQueue.enqueueAndForget((async()=>{const i=await fu(e);new nu(e.asyncQueue,i,n,t,r).Xa()})),r.promise}(Vu(e),(n=>t(new oh(e,n))),r)},t.serverTimestamp=function(){return new il("serverTimestamp")},t.setDoc=function(e,t,n){e=Iu(e,ku);const r=Iu(e.firestore,Fu),i=Vl(e.converter,t,n);return Hl(r,[tl(el(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,mr.none())])},t.setIndexConfiguration=function(e,t){var n;const r=Vu(e=Iu(e,Fu));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return m("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const e of t.indexes){const t=ah(e,"collectionGroup"),r=[];if(Array.isArray(e.fields))for(const t of e.fields){const e=yl("setIndexConfiguration",ah(t,"fieldPath"));"CONTAINS"===t.arrayConfig?r.push(new H(e,2)):"ASCENDING"===t.order?r.push(new H(e,0)):"DESCENDING"===t.order&&r.push(new H(e,1))}n.push(new z(z.UNKNOWN_ID,t,r,W.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue((async()=>async function(e,t){const n=w(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",(e=>r.getFieldIndexes(e).next((n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,c=0;for(;a<o&&c<s;){const s=n(e[c],t[a]);s<0?i(e[c++]):s>0?r(t[a++]):(a++,c++)}for(;a<o;)r(t[a++]);for(;c<s;)i(e[c++])}(n,t,$,(t=>{i.push(r.addFieldIndex(e,t))}),(t=>{i.push(r.deleteFieldIndex(e,t))})))).next((()=>re.waitFor(i)))))}(await lu(e),t)))}(r,i)},t.setLogLevel=function(e){h.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof ql&&t instanceof ql?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Gl&&t instanceof Gl&&e._firestore===t._firestore&&Pu(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(...e){return kl._create("startAfter",e,!1)},t.startAt=function(...e){return kl._create("startAt",e,!0)},t.sum=function(e){return new qu("sum",ml("sum",e))},t.terminate=function(e){return r._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,n,...r){e=Iu(e,ku);const i=Iu(e.firestore,Fu),s=el(i);let a;return a="string"==typeof(t=o.getModularInstance(t))||t instanceof Ku?ul(s,"updateDoc",e._key,t,n,r):cl(s,"updateDoc",e._key,t),Hl(i,[a.toMutation(e._key,mr.exists(!0))])},t.waitForPendingWrites=function(e){return function(e){const t=new E;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=w(e);Ia(n.remoteStore)||f("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=w(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Oa.get(e)||[];r.push(t),n.Oa.set(e,r)}catch(e){const n=$a(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await du(e),t))),t.promise}(Vu(e=Iu(e,Fu)))},t.where=function(e,t,n){const r=t,i=El("where",e);return Tl._create(i,r,n)},t.writeBatch=function(e){return Vu(e=Iu(e,Fu)),new ih(e,(t=>Hl(e,t)))}},5844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(1635),o=[];t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var a={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},c=t.LogLevel.INFO,u=((r={})[t.LogLevel.DEBUG]="log",r[t.LogLevel.VERBOSE]="log",r[t.LogLevel.INFO]="info",r[t.LogLevel.WARN]="warn",r[t.LogLevel.ERROR]="error",r),l=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=u[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));console[o].apply(console,s.__spreadArray(["[".concat(i,"]  ").concat(e.name,":")],n,!1))}},h=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1))},e}();t.Logger=h,t.setLogLevel=function(e){o.forEach((function(t){t.setLogLevel(e)}))},t.setUserLogHandler=function(e,n){for(var r=function(r){var i=null;n&&n.level&&(i=a[n.level]),r.userLogHandler=null===e?null:function(n,r){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];var a=s.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");r>=(null!=i?i:n.logLevel)&&e({level:t.LogLevel[r].toLowerCase(),message:a,args:s,type:n.name})}},i=0,s=o;i<s.length;i++)r(s[i])}},6336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new c;const u=i<<2|s>>4;if(r.push(u),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=o(e);return a.encodeByteArray(t,!0)},l=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}function f(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const p=()=>{try{return f().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},m=e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){var e;const t=null===(e=p())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}class w extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(_,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new w(r,o,n)}}const _=/\{\$([^}]+)}/g;function E(e){return JSON.parse(e)}const x=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=E(h(s[0])||""),n=E(h(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function I(e){return null!==e&&"object"==typeof e}class S{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=T),void 0===r.error&&(r.error=T),void 0===r.complete&&(r.complete=T);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function C(e,t){return`${e} failed: ${t} argument `}const D=144e5;t.CONSTANTS=r,t.DecodeBase64StringError=c,t.Deferred=g,t.ErrorFactory=b,t.FirebaseError=w,t.MAX_VALUE_MILLIS=D,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}},t.areCookiesEnabled=function(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)},t.assert=i,t.assertionError=s,t.async=function(e,t){return(...n)=>{Promise.resolve(!0).then((()=>{e(...n)})).catch((e=>{t&&t(e)}))}},t.base64=a,t.base64Decode=h,t.base64Encode=u,t.base64urlEncodeWithoutPadding=l,t.calculateBackoffMillis=function(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(D,r+i)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")},t.createSubscribe=function(e,t){const n=new S(e,t);return n.subscribe.bind(n)},t.decode=x,t.deepCopy=function(e){return d(void 0,e)},t.deepEqual=function e(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const r=t[s],o=n[s];if(I(r)&&I(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(const e of i)if(!r.includes(e))return!1;return!0},t.deepExtend=d,t.errorPrefix=C,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=m,t.getDefaultEmulatorHostnameAndPort=e=>{const t=m(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},t.getDefaults=p,t.getExperimentalSetting=e=>{var t;return null===(t=p())||void 0===t?void 0:t[`_${e}`]},t.getGlobal=f,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=y,t.isAdmin=function(e){const t=x(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return y().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=y();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"==typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())},t.isNode=v,t.isNodeSdk=function(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!v()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return y().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=x(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=x(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){const t=x(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=E,t.map=function(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){const t=(e=Math.abs(e))%100;if(t>=10&&t<=20)return"th";const n=e%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(e):`${e}`},t.promiseWithTimeout=function(e,t=2e3){const n=new g;return setTimeout((()=>n.reject("timeout!")),t),e.then(n.resolve,n.reject),n.promise},t.querystring=function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const t=s-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(r)-56320)}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.validateArgCount=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(C(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(C(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))},t.validateNamespace=function(e,t,n){if((!n||t)&&"string"!=typeof t)throw new Error(C(e,"namespace")+"must be a valid firebase namespace.")}},3637:(e,t,n)=>{(function(){var t;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:r(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}var s,o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(e,t){if(t)e:{var n=c;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{var l;e:{var h={};try{h.__proto__={a:!0},l=h.a;break e}catch(U){}l=!1}s=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=s;function f(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function p(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}u("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),u("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return f(r(this))}})}return e})),u("Promise",(function(e){function t(e){this.g=0,this.i=void 0,this.h=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=c.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.B),reject:e(this.l)}},t.prototype.B=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.D(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.g)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.g);this.g=e,this.i=t,2===this.g&&this.C(),this.u()},t.prototype.C=function(){var e=this;s((function(){if(e.v()){var t=c.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.v=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)o.h(this.h[e]);this.h=null}};var o=new n;return t.prototype.D=function(e){var t=this.j();e.la(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){s(e)}}:t}var i,s,o=new t((function(e,t){i=e,s=t}));return this.la(r(e,i),r(n,s)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.la=function(e,t){function n(){switch(r.g){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.g)}}var r=this;null==this.h?o.h(n):this.h.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var s=i(e),o=s.next();!o.done;o=s.next())r(o.value).la(t,n)}))},t.all=function(e){var n=i(e),s=n.next();return s.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--a&&e(o)}}var o=[],a=0;do{o.push(void 0),a++,r(s.value).la(i(o.length-1),t),s=n.next()}while(!s.done)}))},t})),u("Array.prototype.values",(function(e){return e||function(){return p(this,(function(e,t){return t}))}})),u("Array.prototype.keys",(function(e){return e||function(){return p(this,(function(e){return e}))}})),u("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=i(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function s(e){if(!m(e,c)){var t=new n;a(e,c,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&s(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var c="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(s(e),!m(e,c))throw Error("WeakMap key fail: "+e);return e[c][this.g]=t,this},t.prototype.get=function(e){return r(e)&&m(e,c)?e[c][this.g]:void 0},t.prototype.has=function(e){return r(e)&&m(e,c)&&m(e[c],this.g)},t.prototype.delete=function(e){return!!(r(e)&&m(e,c)&&m(e[c],this.g))&&delete e[c][this.g]},t})),u("Map",(function(e){function t(){var e={};return e.V=e.next=e.head=e}function n(e,t){var n=e.g;return f((function(){if(n){for(;n.head!=e.g;)n=n.V;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++a,o.set(t,n)):n="p_"+t;var r=e.h[n];if(r&&m(e.h,n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,K:i}}return{id:n,list:r,index:-1,K:void 0}}function s(e){if(this.h={},this.g=t(),this.size=0,e){e=i(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&"s"==s.value[1]&&!((s=r.next()).done||4!=s.value[0].x||"t"!=s.value[1]||!r.next().done)}catch(e){return!1}}())return e;var o=new WeakMap;s.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.K?n.K.value=t:(n.K={next:this.g,V:this.g.V,head:this.g,key:e,value:t},n.list.push(n.K),this.g.V.next=n.K,this.g.V=n.K,this.size++),this},s.prototype.delete=function(e){return!(!(e=r(this,e)).K||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.K.V.next=e.K.next,e.K.next.V=e.K.V,e.K.head=null,this.size--,0))},s.prototype.clear=function(){this.h={},this.g=this.g.V=t(),this.size=0},s.prototype.has=function(e){return!!r(this,e).K},s.prototype.get=function(e){return(e=r(this,e).K)&&e.value},s.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},s.prototype.keys=function(){return n(this,(function(e){return e.key}))},s.prototype.values=function(){return n(this,(function(e){return e.value}))},s.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},s.prototype[Symbol.iterator]=s.prototype.entries;var a=0;return s})),u("Array.prototype.find",(function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var r=n.length,i=0;i<r;i++){var s=n[i];if(e.call(t,s,i,n)){e=s;break e}}e=void 0}return e}})),u("Array.prototype.entries",(function(e){return e||function(){return p(this,(function(e,t){return[e,t]}))}})),u("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var s=0;!(i=e.next()).done;)r.push(t.call(n,i.value,s++))}else for(i=e.length,s=0;s<i;s++)r.push(t.call(n,e[s],s));return r}})),u("Set",(function(e){function t(e){if(this.g=new Map,e){e=i(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&s.value[1]==t&&!(s=r.next()).done&&s.value[0]!=t&&4==s.value[0].x&&s.value[1]==s.value[0]&&r.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(r){return e.call(t,r,r,n)}))},t)}));var g=g||{},y=this||self;function v(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function w(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function b(e){return Object.prototype.hasOwnProperty.call(e,_)&&e[_]||(e[_]=++E)}var _="closure_uid_"+(1e9*Math.random()>>>0),E=0;function x(e,t,n){return e.call.apply(e.bind,arguments)}function I(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:I).apply(null,arguments)}function T(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function C(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dc=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function D(){0!=A&&(k[b(this)]=this),this.s=this.s,this.o=this.o}var A=0,k={};D.prototype.s=!1,D.prototype.va=function(){if(!this.s&&(this.s=!0,this.O(),0!=A)){var e=b(this);if(0!=A&&this.o&&0<this.o.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete k[e]}},D.prototype.O=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var N=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function O(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function P(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(v(r)){var i=e.length||0,s=r.length||0;e.length=i+s;for(var o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}}function L(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var n=function(){};y.addEventListener("test",n,t),y.removeEventListener("test",n,t)}catch(e){}return e}();function R(e){return/^[\s\xa0]*$/.test(e)}function F(){var e=y.navigator;return e&&(e=e.userAgent)?e:""}function V(e){return-1!=F().indexOf(e)}function j(e){return j[" "](e),e}j[" "]=function(){};var B,U,q,z=V("Opera"),G=V("Trident")||V("MSIE"),K=V("Edge"),$=K||G,H=V("Gecko")&&!(-1!=F().toLowerCase().indexOf("webkit")&&!V("Edge"))&&!(V("Trident")||V("MSIE"))&&!V("Edge"),Q=-1!=F().toLowerCase().indexOf("webkit")&&!V("Edge");function W(){var e=y.document;return e?e.documentMode:void 0}e:{var J="",Y=(U=F(),H?/rv:([^\);]+)(\)|;)/.exec(U):K?/Edge\/([\d\.]+)/.exec(U):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(U):Q?/WebKit\/(\S+)/.exec(U):z?/(?:Version)[ \/]?(\S+)/.exec(U):void 0);if(Y&&(J=Y?Y[1]:""),G){var X=W();if(null!=X&&X>parseFloat(J)){B=String(X);break e}}B=J}y.document&&G?q=W()||parseInt(B,10)||void 0:q=void 0;var Z=q;function ee(e,t){if(L.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(H){e:{try{j(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:te[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ee.Z.h.call(this)}}C(ee,L);var te={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.oa=i,this.key=++re,this.ha=this.ka=!1}function se(e){e.ha=!0,e.listener=null,e.proxy=null,e.src=null,e.oa=null}function oe(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ae(e){var t,n={};for(t in e)n[t]=e[t];return n}var ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<ce.length;s++)n=ce[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function le(e){this.src=e,this.g={},this.h=0}function he(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=N(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ha&&s.listener==t&&s.capture==!!n&&s.oa==r)return i}return-1}le.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=de(e,t,r,i);return-1<o?(t=e[o],n||(t.ka=!1)):((t=new ie(t,this.src,s,!!r,i)).ka=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function me(e,t,n,r,i){if(r&&r.once)return ye(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)me(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.P(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=w(i)?!!i.capture:!!i,a=Ee(e);if(a||(e[fe]=a=new le(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=_e;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)M||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ye(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.R(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!0,r,i)}function ve(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ve(e,t[s],n,r,i);else r=w(r)?!!r.capture:!!r,n=Ie(n),e&&e[ne]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=de(s=e.g[t],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Ee(e))&&(t=e.g[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&we(n))}function we(e){if("number"!=typeof e&&e&&!e.ha){var t=e.src;if(t&&t[ne])he(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ee(t))?(he(n,e),0==n.h&&(n.src=null,t[fe]=null)):se(e)}}}function be(e){return e in pe?pe[e]:pe[e]="on"+e}function _e(e,t){if(e.ha)e=!0;else{t=new ee(t,this);var n=e.listener,r=e.oa||e.src;e.ka&&we(e),e=n.call(r,t)}return e}function Ee(e){return(e=e[fe])instanceof le?e:null}var xe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ie(e){return"function"==typeof e?e:(e[xe]||(e[xe]=function(t){return e.handleEvent(t)}),e[xe])}function Se(){D.call(this),this.i=new le(this),this.T=this,this.J=null}function Te(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.T,r=t.type||t,"string"==typeof t)t=new L(t,e);else if(t instanceof L)t.target=t.target||e;else{var i=t;ue(t=new L(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ce(o,r,!0,t)&&i}if(i=Ce(o=t.g=e,r,!0,t)&&i,i=Ce(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ce(o=t.g=n[s],r,!1,t)&&i}function Ce(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ha&&o.capture==n){var a=o.listener,c=o.oa||o.src;o.ka&&he(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}C(Se,D),Se.prototype[ne]=!0,Se.prototype.removeEventListener=function(e,t,n,r){ve(this,e,t,n,r)},Se.prototype.O=function(){if(Se.Z.O.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},Se.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Se.prototype.R=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var De=y.JSON.stringify;function Ae(e,t){this.i=e,this.j=t,this.h=0,this.g=null}function ke(){this.h=this.g=null}function Ne(){var e=Ve,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}Ae.prototype.get=function(){if(0<this.h){this.h--;var e=this.g;this.g=e.next,e.next=null}else e=this.i();return e},ke.prototype.add=function(e,t){var n=Oe.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n};var Oe=new Ae((function(){return new Pe}),(function(e){return e.reset()}));function Pe(){this.next=this.g=this.h=null}function Le(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Me(e){y.setTimeout((function(){throw e}),0)}Pe.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},Pe.prototype.reset=function(){this.next=this.g=this.h=null};var Re,Fe=!1,Ve=new ke;function je(e,t){Re||function(){var e=y.Promise.resolve(void 0);Re=function(){e.then(Be)}}(),Fe||(Re(),Fe=!0),Ve.add(e,t)}function Be(){for(var e;e=Ne();){try{e.h.call(e.g)}catch(e){Me(e)}var t=Oe;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fe=!1}function Ue(e,t){Se.call(this),this.h=e||1,this.g=t||y,this.j=S(this.tb,this),this.l=Date.now()}function qe(e){e.ia=!1,e.U&&(e.g.clearTimeout(e.U),e.U=null)}function ze(e,t,n){if("function"==typeof e)n&&(e=S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=S(e.handleEvent,e)}return 2147483647<Number(t)?-1:y.setTimeout(e,t||0)}function Ge(e,t,n){D.call(this),this.m=null!=n?e.bind(n):e,this.j=t,this.h=null,this.i=!1,this.g=null}if(C(Ue,Se),(t=Ue.prototype).ia=!1,t.U=null,t.tb=function(){if(this.ia){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.U=this.g.setTimeout(this.j,this.h-e):(this.U&&(this.g.clearTimeout(this.U),this.U=null),Te(this,"tick"),this.ia&&(qe(this),this.start()))}},t.start=function(){this.ia=!0,this.U||(this.U=this.g.setTimeout(this.j,this.h),this.l=Date.now())},t.O=function(){Ue.Z.O.call(this),qe(this),delete this.g},Ge.prototype=o(D.prototype),Ge.prototype.constructor=Ge,d)d(Ge,D);else for(var Ke in D)if("prototype"!=Ke)if(Object.defineProperties){var $e=Object.getOwnPropertyDescriptor(D,Ke);$e&&Object.defineProperty(Ge,Ke,$e)}else Ge[Ke]=D[Ke];function He(e){e.g=ze((function(){e.g=null,e.i&&(e.i=!1,He(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}function Qe(e){D.call(this),this.h=e,this.g={}}Ge.Z=D.prototype,Ge.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:He(this)},Ge.prototype.O=function(){D.prototype.O.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},C(Qe,D);var We=[];function Je(e,t,n,r){Array.isArray(n)||(n&&(We[0]=n.toString()),n=We);for(var i=0;i<n.length;i++){var s=me(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Ye(e){oe(e.g,(function(e,t){this.g.hasOwnProperty(t)&&we(e)}),e),e.g={}}function Xe(){this.g=!0}function Ze(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return De(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Qe.prototype.O=function(){Qe.Z.O.call(this),Ye(this)},Qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Xe.prototype.Ha=function(){this.g=!1},Xe.prototype.info=function(){};var et={},tt=null;function nt(){return tt=tt||new Se}function rt(e){L.call(this,et.Wa,e)}function it(e){var t=nt();Te(t,new rt(t,e))}function st(e,t){L.call(this,et.STAT_EVENT,e),this.stat=t}function ot(e){var t=nt();Te(t,new st(t,e))}function at(e,t){L.call(this,et.Xa,e),this.size=t}function ct(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){e()}),t)}et.Wa="serverreachability",C(rt,L),et.STAT_EVENT="statevent",C(st,L),et.Xa="timingevent",C(at,L);var ut={NO_ERROR:0,ub:1,Hb:2,Gb:3,Bb:4,Fb:5,Ib:6,Ta:7,TIMEOUT:8,Lb:9},lt={zb:"complete",Vb:"success",Ua:"error",Ta:"abort",Nb:"ready",Ob:"readystatechange",TIMEOUT:"timeout",Jb:"incrementaldata",Mb:"progress",Cb:"downloadprogress",cc:"uploadprogress"};function ht(){}function dt(e){return e.h||(e.h=e.i())}function ft(){}ht.prototype.h=null;var pt,mt={OPEN:"a",yb:"b",Ua:"c",Kb:"d"};function gt(){L.call(this,"d")}function yt(){L.call(this,"c")}function vt(){}function wt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.Y=r||1,this.W=new Qe(this),this.R=_t,e=$?125:void 0,this.X=new Ue(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.M=this.G=this.aa=this.C=null,this.D=[],this.g=null,this.o=0,this.s=this.v=null,this.ea=-1,this.J=!1,this.P=0,this.N=null,this.da=this.L=this.ca=this.T=!1,this.h=new bt}function bt(){this.i=null,this.g="",this.h=!1}C(gt,L),C(yt,L),C(vt,ht),vt.prototype.g=function(){return new XMLHttpRequest},vt.prototype.i=function(){return{}},pt=new vt;var _t=45e3,Et={},xt={};function It(e,t,n){e.M=1,e.A=zt(Vt(t)),e.u=n,e.T=!0,St(e,null)}function St(e,t){e.G=Date.now(),At(e),e.B=Vt(e.A);var n=e.B,r=e.Y;Array.isArray(r)||(r=[String(r)]),nn(n.i,"t",r),e.o=0,n=e.l.J,e.h=new bt,e.g=ir(e.l,n?t:null,!e.u),0<e.P&&(e.N=new Ge(S(e.Sa,e,e.g),e.P)),Je(e.W,e.g,"readystatechange",e.qb),t=e.I?ae(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ja(e.B,e.v,e.u,t)):(e.v="GET",e.g.ja(e.B,e.v,null,t)),it(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.Y,e.u)}function Tt(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.l.Ka}function Ct(e,t,n){for(var r,i=!0;!e.J&&e.o<n.length;){if((r=Dt(e,n))==xt){4==t&&(e.s=4,ot(14),i=!1),Ze(e.j,e.m,null,"[Incomplete Response]");break}if(r==Et){e.s=4,ot(15),Ze(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ze(e.j,e.m,r,null),Lt(e,r)}Tt(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,ot(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.da&&(e.da=!0,(t=e.l).g==e&&t.ea&&!t.N&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(t),t.N=!0,ot(11))):(Ze(e.j,e.m,n,"[Invalid Chunked Response]"),Pt(e),Ot(e))}function Dt(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?xt:(n=Number(t.substring(n,r)),isNaN(n)?Et:(r+=1)+n>t.length?xt:(t=t.slice(r,r+n),e.o=r+n,t))}function At(e){e.aa=Date.now()+e.R,kt(e,e.R)}function kt(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=ct(S(e.ob,e),t)}function Nt(e){e.C&&(y.clearTimeout(e.C),e.C=null)}function Ot(e){0==e.l.H||e.J||Zn(e.l,e)}function Pt(e){Nt(e);var t=e.N;t&&"function"==typeof t.va&&t.va(),e.N=null,qe(e.X),Ye(e.W),e.g&&(t=e.g,e.g=null,t.abort(),t.va())}function Lt(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||hn(n.i,e)))if(!e.L&&hn(n.i,e)&&3==n.H){try{var r=n.Ma.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Xn(n),qn(n)}Wn(n),ot(18)}}else n.Ia=i[1],0<n.Ia-n.X&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ct(S(n.lb,n),6e3));if(1>=ln(n.i)&&n.ra){try{n.ra()}catch(e){}n.ra=void 0}}else tr(n,11)}else if((e.L||n.g==e)&&Xn(n),!R(t))for(i=n.Ma.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.X=s[0],s=s[1],2==n.H)if("c"==s[0]){n.L=s[1],n.sa=s[2];var o=s[3];null!=o&&(n.ua=o,n.l.info("VER="+n.ua));var a=s[4];null!=a&&(n.Ja=a,n.l.info("SVER="+n.Ja));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.M=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(dn(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.Ga=d,qt(r.I,r.D,d))}}n.H=3,n.h&&n.h.Ea(),n.ea&&(n.T=Date.now()-e.G,n.l.info("Handshake RTT: "+n.T+"ms"));var f=e;if((r=n).za=rr(r,r.J?r.sa:null,r.aa),f.L){fn(r.i,f);var p=f,m=r.M;m&&p.setTimeout(m),p.C&&(Nt(p),At(p)),r.g=f}else Qn(r);0<n.j.length&&Gn(n)}else"stop"!=s[0]&&"close"!=s[0]||tr(n,7);else 3==n.H&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?tr(n,7):Un(n):"noop"!=s[0]&&n.h&&n.h.Da(s),n.A=0)}it(4)}catch(e){}}function Mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.wa&&"function"==typeof e.wa)return e.wa();if(!e.ba||"function"!=typeof e.ba){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(v(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.ba&&"function"==typeof e.ba)return e.ba();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(t=wt.prototype).setTimeout=function(e){this.R=e},t.qb=function(e){e=e.target;var t=this.N;t&&3==Mn(e)?t.l():this.Sa(e)},t.Sa=function(e){try{if(e==this.g)e:{var t=Mn(this.g),n=this.g.La(),r=this.g.fa();if(!(3>t)&&(3!=t||$||this.g&&(this.h.h||this.g.ma()||Rn(this.g)))){this.J||4!=t||7==n||it(8==n||0>=r?3:2),Nt(this);var i=this.g.fa();this.ea=i;t:if(Tt(this)){var s=Rn(this.g);e="";var o=s.length,a=4==Mn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Pt(this),Ot(this);var c="";break t}this.h.i=new y.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.length=0,this.h.g+=e,this.o=0,c=this.h.g}else c=this.g.ma();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.Y,t,i),this.i){if(this.ca&&!this.L){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.s=3,ot(12),Pt(this),Ot(this);break e}Ze(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lt(this,i)}this.T?(Ct(this,t,c),$&&this.i&&3==t&&(Je(this.W,this.X,"tick",this.pb),this.X.start())):(Ze(this.j,this.m,c,null),Lt(this,c)),4==t&&Pt(this),this.i&&!this.J&&(4==t?Zn(this.l,this):(this.i=!1,At(this)))}else(function(e){var t={};e=(e.g&&2<=Mn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!R(e[n])){var r=Le(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var s=t[i]||[];t[i]=s,s.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==i&&0<c.indexOf("Unknown SID")?(this.s=3,ot(12)):(this.s=0,ot(13)),Pt(this),Ot(this)}}}catch(e){}},t.pb=function(){if(this.g){var e=Mn(this.g),t=this.g.ma();this.o<t.length&&(Nt(this),Ct(this,e,t),this.i&&4!=e&&At(this))}},t.cancel=function(){this.J=!0,Pt(this)},t.ob=function(){this.C=null;var e=Date.now();0<=e-this.aa?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.M&&(it(3),ot(17)),Pt(this),this.s=2,Ot(this)):kt(this,this.aa-e)};var Rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(e){var t;this.g=this.s=this.j="",this.o=null,this.m=this.h="",this.l=!1,e instanceof Ft?(this.l=e.l,jt(this,e.j),this.s=e.s,this.g=e.g,Bt(this,e.o),this.h=e.h,Ut(this,rn(e.i)),this.m=e.m):e&&(t=String(e).match(Rt))?(this.l=!1,jt(this,t[1]||"",!0),this.s=Gt(t[2]||""),this.g=Gt(t[3]||"",!0),Bt(this,t[4]),this.h=Gt(t[5]||"",!0),Ut(this,t[6]||"",!0),this.m=Gt(t[7]||"")):(this.l=!1,this.i=new Xt(null,this.l))}function Vt(e){return new Ft(e)}function jt(e,t,n){e.j=n?Gt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.o=t}else e.o=null}function Ut(e,t,n){t instanceof Xt?(e.i=t,function(e,t){t&&!e.j&&(Zt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(en(this,t),nn(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=Kt(t,Jt)),e.i=new Xt(t,e.l))}function qt(e,t,n){e.i.set(t,n)}function zt(e){return qt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Gt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Kt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,$t),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function $t(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Kt(t,Ht,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Kt(t,Ht,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.o)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Kt(n,"/"==n.charAt(0)?Wt:Qt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Kt(n,Yt)),e.join("")},Ft.prototype.resolve=function(e){var t=Vt(this),n=!!e.j;n?jt(t,e.j):n=!!e.s,n?t.s=e.s:n=!!e.g,n?t.g=e.g:n=null!=e.o;var r=e.h;if(n)Bt(t,e.o);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],o=0;o<i.length;){var a=i[o++];"."==a?r&&o==i.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&o==i.length&&s.push("")):(s.push(a),r=!0)}r=s.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?Ut(t,rn(e.i)):n=!!e.m,n&&(t.m=e.m),t};var Ht=/[#\/\?@]/g,Qt=/[#\?:]/g,Wt=/[#\?]/g,Jt=/[#\?@]/g,Yt=/#/g;function Xt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Zt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function en(e,t){Zt(e),t=sn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tn(e,t){return Zt(e),t=sn(e,t),e.g.has(t)}function nn(e,t,n){en(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),O(n)),e.h+=n.length)}function rn(e){var t=new Xt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function on(e,t){this.g=e,this.map=t}function an(e){this.l=e||cn,e=y.PerformanceNavigationTiming?0<(e=y.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(y.g&&y.g.Na&&y.g.Na()&&y.g.Na().hc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(t=Xt.prototype).add=function(e,t){Zt(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},t.forEach=function(e,t){Zt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},t.wa=function(){Zt(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},t.ba=function(e){Zt(this);var t=[];if("string"==typeof e)tn(this,e)&&(t=t.concat(this.g.get(sn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},t.set=function(e,t){return Zt(this),this.i=null,tn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&0<(e=this.ba(e)).length?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.ba(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var cn=10;function un(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ln(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dn(e,t){e.g?e.g.add(t):e.h=t}function fn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){for(var t=e.i,n=(e=i(e.g.values())).next();!n.done;n=e.next())t=t.concat(n.value.D);return t}return O(e.i)}function mn(){}function gn(){this.g=new mn}function yn(e,t,n){var r=n||"";try{Mt(e,(function(e,n){var i=e;w(e)&&(i=De(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function vn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function wn(e){this.l=e.ic||null,this.j=e.rb||!1}function bn(e,t){Se.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=_n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}an.prototype.cancel=function(){if(this.i=pn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e=i(this.g.values()),t=e.next();!t.done;t=e.next())t.value.cancel();this.g.clear()}},mn.prototype.stringify=function(e){return y.JSON.stringify(e,void 0)},mn.prototype.parse=function(e){return y.JSON.parse(e,void 0)},C(wn,ht),wn.prototype.g=function(){return new bn(this.l,this.j)},wn.prototype.i=function(e){return function(){return e}}({}),C(bn,Se);var _n=0;function En(e){e.j.read().then(e.$a.bind(e)).catch(e.na.bind(e))}function xn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,In(e)}function In(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(t=bn.prototype).open=function(e,t){if(this.readyState!=_n)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,In(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||y).fetch(new Request(this.B,t)).then(this.cb.bind(this),this.na.bind(this))},t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xn(this)),this.readyState=_n},t.cb=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,In(this)),this.g&&(this.readyState=3,In(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.ab.bind(this),this.na.bind(this));else if(void 0!==y.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;En(this)}else e.text().then(this.bb.bind(this),this.na.bind(this))},t.$a=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?xn(this):In(this),3==this.readyState&&En(this)}},t.bb=function(e){this.g&&(this.response=this.responseText=e,xn(this))},t.ab=function(e){this.g&&(this.response=e,xn(this))},t.na=function(){this.g&&xn(this)},t.setRequestHeader=function(e,t){this.v.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(bn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Sn=y.JSON.parse;function Tn(e){Se.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.D=!1,this.B=0,this.A=null,this.L=Cn,this.M=this.N=!1}C(Tn,Se);var Cn="",Dn=/^https?$/i,An=["POST","PUT"];function kn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Nn(e),Pn(e)}function Nn(e){e.D||(e.D=!0,Te(e,"complete"),Te(e,"error"))}function On(e){if(e.h&&void 0!==g&&(!e.C[1]||4!=Mn(e)||2!=e.fa()))if(e.v&&4==Mn(e))ze(e.Oa,0,e);else if(Te(e,"readystatechange"),4==Mn(e)){e.h=!1;try{var t,n=e.fa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.I).match(Rt)[1]||null;!s&&y.self&&y.self.location&&(s=y.self.location.protocol.slice(0,-1)),i=!Dn.test(s?s.toLowerCase():"")}t=i}if(t)Te(e,"complete"),Te(e,"success");else{e.m=6;try{var o=2<Mn(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.fa()+"]",Nn(e)}}finally{Pn(e)}}}function Pn(e,t){if(e.g){Ln(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||Te(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Ln(e){e.g&&e.M&&(e.g.ontimeout=null),e.A&&(y.clearTimeout(e.A),e.A=null)}function Mn(e){return e.g?e.g.readyState:0}function Rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.L){case Cn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Fn(e){var t="";return oe(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Vn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Fn(n),"string"==typeof e?(encodeURIComponent(String(t)),null!=n&&encodeURIComponent(String(n))):qt(e,t,n))}function jn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Bn(e){this.Ja=0,this.j=[],this.l=new Xe,this.sa=this.za=this.I=this.aa=this.g=this.Ga=this.D=this.qa=this.o=this.W=this.s=null,this.ib=this.Y=0,this.gb=jn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.ca=!0,this.Ia=this.X=-1,this.da=this.A=this.C=0,this.eb=jn("baseRetryDelayMs",5e3,e),this.kb=jn("retryDelaySeedMs",1e4,e),this.hb=jn("forwardChannelMaxRetries",2,e),this.Aa=jn("forwardChannelRequestTimeoutMs",2e4,e),this.ya=e&&e.xmlHttpFactory||void 0,this.Ka=e&&e.useFetchStreams||!1,this.M=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.L="",this.i=new an(e&&e.concurrentRequestLimit),this.Ma=new gn,this.R=e&&e.fastHandshake||!1,this.P=e&&e.encodeInitMessageHeaders||!1,this.R&&this.P&&(this.P=!1),this.fb=e&&e.ec||!1,e&&e.Ha&&this.l.Ha(),e&&e.forceLongPolling&&(this.ca=!1),this.ea=!this.R&&this.ca&&e&&e.detectBufferingProxy||!1,this.ta=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ta=e.longPollingTimeout),this.ra=void 0,this.T=0,this.N=!1,this.pa=this.B=null}function Un(e){if(zn(e),3==e.H){var t=e.Y++,n=Vt(e.I);if(qt(n,"SID",e.L),qt(n,"RID",t),qt(n,"TYPE","terminate"),$n(e,n),(t=new wt(e,e.l,t)).M=2,t.A=zt(Vt(n)),n=!1,y.navigator&&y.navigator.sendBeacon)try{n=y.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&y.Image&&((new Image).src=t.A,n=!0),n||(t.g=ir(t.l,null),t.g.ja(t.A)),t.G=Date.now(),At(t)}nr(e)}function qn(e){e.g&&(Jn(e),e.g.cancel(),e.g=null)}function zn(e){qn(e),e.u&&(y.clearTimeout(e.u),e.u=null),Xn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&y.clearTimeout(e.m),e.m=null)}function Gn(e){un(e.i)||e.m||(e.m=!0,je(e.Qa,e),e.C=0)}function Kn(e,t){var n;n=t?t.m:e.Y++;var r=Vt(e.I);qt(r,"SID",e.L),qt(r,"RID",n),qt(r,"AID",e.X),$n(e,r),e.o&&e.s&&Vn(r,e.o,e.s),n=new wt(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.D.concat(e.j)),t=Hn(e,n,1e3),n.setTimeout(Math.round(.5*e.Aa)+Math.round(.5*e.Aa*Math.random())),dn(e.i,n),It(n,r,t)}function $n(e,t){e.qa&&oe(e.qa,(function(e,n){qt(t,n,e)})),e.h&&Mt({},(function(e,n){qt(t,n,e)}))}function Hn(e,t,n){n=Math.min(e.j.length,n);var r=e.h?S(e.h.Ya,e.h,e):null;e:for(var i=e.j,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].g,l=i[c].map;if(0>(u-=s))s=Math.max(0,i[c].g-100),a=!1;else try{yn(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.j.splice(0,n),t.D=e,r}function Qn(e){e.g||e.u||(e.da=1,je(e.Pa,e),e.A=0)}function Wn(e){return!(e.g||e.u||3<=e.A||(e.da++,e.u=ct(S(e.Pa,e),er(e,e.A)),e.A++,0))}function Jn(e){null!=e.B&&(y.clearTimeout(e.B),e.B=null)}function Yn(e){e.g=new wt(e,e.l,"rpc",e.da),null===e.o&&(e.g.I=e.s),e.g.P=0;var t=Vt(e.za);qt(t,"RID","rpc"),qt(t,"SID",e.L),qt(t,"AID",e.X),qt(t,"CI",e.G?"0":"1"),!e.G&&e.ta&&qt(t,"TO",e.ta),qt(t,"TYPE","xmlhttp"),$n(e,t),e.o&&e.s&&Vn(t,e.o,e.s),e.M&&e.g.setTimeout(e.M);var n=e.g;e=e.sa,n.M=1,n.A=zt(Vt(t)),n.u=null,n.T=!0,St(n,e)}function Xn(e){null!=e.v&&(y.clearTimeout(e.v),e.v=null)}function Zn(e,t){var n=null;if(e.g==t){Xn(e),Jn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,fn(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;Te(r=nt(),new at(r,n,t,i)),Gn(e)}else Qn(e);else if(3==(i=t.s)||0==i&&0<t.ea||!(1==r&&function(e,t){return!(ln(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.D.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.gb?0:e.hb)||(e.m=ct(S(e.Qa,e,t),er(e,e.C)),e.C++,0)))}(e,t)||2==r&&Wn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:tr(e,5);break;case 4:tr(e,10);break;case 3:tr(e,6);break;default:tr(e,2)}}function er(e,t){var n=e.eb+Math.floor(Math.random()*e.kb);return e.isActive()||(n*=2),n*t}function tr(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=S(e.sb,e);n||(n=new Ft("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||jt(n,"https"),zt(n)),function(e,t){var n=new Xe;if(y.Image){var r=new Image;r.onload=T(vn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=T(vn,n,r,"TestLoadImage: error",!1,t),r.onabort=T(vn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=T(vn,n,r,"TestLoadImage: timeout",!1,t),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ot(2);e.H=0,e.h&&e.h.Ca(t),nr(e),zn(e)}function nr(e){if(e.H=0,e.pa=[],e.h){var t=pn(e.i);0==t.length&&0==e.j.length||(P(e.pa,t),P(e.pa,e.j),e.i.i.length=0,O(e.j),e.j.length=0),e.h.Ba()}}function rr(e,t,n){var r=n instanceof Ft?Vt(n):new Ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Bt(r,r.o);else{var i=y.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Ft(null);r&&jt(s,r),t&&(s.g=t),i&&Bt(s,i),n&&(s.h=n),r=s}return n=e.D,t=e.Ga,n&&t&&qt(r,n,t),qt(r,"VER",e.ua),$n(e,r),r}function ir(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ka&&!e.ya?new Tn(new wn({rb:n})):new Tn(e.ya)).Ra(e.J),t}function sr(){}function or(){if(G&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function ar(e,t){Se.call(this),this.g=new Bn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Fa&&(e?e["X-WebChannel-Client-Profile"]=t.Fa:e={"X-WebChannel-Client-Profile":t.Fa}),this.g.W=e,(e=t&&t.fc)&&!R(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!R(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new lr(this)}function cr(e){gt.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){yt.call(this),this.status=1}function lr(e){this.g=e}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function dr(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function fr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(t=Tn.prototype).Ra=function(e){this.N=e},t.ja=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():pt.g(),this.C=this.u?dt(this.u):dt(pt),this.g.onreadystatechange=S(this.Oa,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void kn(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(var o=(s=i(r.keys())).next();!o.done;o=s.next())o=o.value,n.set(o,r.get(o))}for(r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=y.FormData&&e instanceof y.FormData,!(0<=N(An,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r=(t=i(n)).next();!r.done;r=t.next())r=(n=i(r.value)).next().value,n=n.next().value,this.g.setRequestHeader(r,n);this.L&&(this.g.responseType=this.L),"withCredentials"in this.g&&this.g.withCredentials!==this.N&&(this.g.withCredentials=this.N);try{Ln(this),0<this.B&&((this.M=function(e){return G&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=S(this.xa,this)):this.A=ze(this.xa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){kn(this,e)}},t.xa=function(){void 0!==g&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Te(this,"timeout"),this.abort(8))},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Te(this,"complete"),Te(this,"abort"),Pn(this))},t.O=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pn(this,!0)),Tn.Z.O.call(this)},t.Oa=function(){this.s||(this.G||this.v||this.l?On(this):this.nb())},t.nb=function(){On(this)},t.isActive=function(){return!!this.g},t.fa=function(){try{return 2<Mn(this)?this.g.status:-1}catch(e){return-1}},t.ma=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.Za=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Sn(t)}},t.La=function(){return this.m},t.Va=function(){return"string"==typeof this.j?this.j:String(this.j)},(t=Bn.prototype).ua=8,t.H=1,t.Qa=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.Y=Math.floor(1e5*Math.random()),e=this.Y++;var t,n=new wt(this,this.l,e),r=this.s;if(this.W&&(r?ue(r=ae(r),this.W):r=this.W),null!==this.o||this.P||(n.I=r,r=null),this.R)e:{for(var i=t=0;i<this.j.length;i++){var s=this.j[i];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=i;break e}if(4096===t||i===this.j.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Hn(this,n,t),qt(i=Vt(this.I),"RID",e),qt(i,"CVER",22),this.D&&qt(i,"X-HTTP-Session-Id",this.D),$n(this,i),r&&(this.P?t="headers="+encodeURIComponent(String(Fn(r)))+"&"+t:this.o&&Vn(i,this.o,r)),dn(this.i,n),this.fb&&qt(i,"TYPE","init"),this.R?(qt(i,"$req",t),qt(i,"SID","null"),n.ca=!0,It(n,i,null)):It(n,i,t),this.H=2}}else 3==this.H&&(e?Kn(this,e):0==this.j.length||un(this.i)||Kn(this))},t.Pa=function(){if(this.u=null,Yn(this),this.ea&&!(this.N||null==this.g||0>=this.T)){var e=2*this.T;this.l.info("BP detection timer enabled: "+e),this.B=ct(S(this.mb,this),e)}},t.mb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.N=!0,ot(10),qn(this),Yn(this))},t.lb=function(){null!=this.v&&(this.v=null,qn(this),Wn(this),ot(19))},t.sb=function(e){e?(this.l.info("Successfully pinged google.com"),ot(2)):(this.l.info("Failed to ping google.com"),ot(1))},t.isActive=function(){return!!this.h&&this.h.isActive(this)},(t=sr.prototype).Ea=function(){},t.Da=function(){},t.Ca=function(){},t.Ba=function(){},t.isActive=function(){return!0},t.Ya=function(){},or.prototype.g=function(e,t){return new ar(e,t)},C(ar,Se),ar.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ot(0),e.aa=t,e.qa=n||{},e.G=e.ca,e.I=rr(e,null,e.aa),Gn(e)},ar.prototype.close=function(){Un(this.g)},ar.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=De(e),e=n);t.j.push(new on(t.ib++,e)),3==t.H&&Gn(t)},ar.prototype.O=function(){this.g.h=null,delete this.j,Un(this.g),delete this.g,ar.Z.O.call(this)},C(cr,gt),C(ur,yt),C(lr,sr),lr.prototype.Ea=function(){Te(this.g,"a")},lr.prototype.Da=function(e){Te(this.g,new cr(e))},lr.prototype.Ca=function(e){Te(this.g,new ur(e))},lr.prototype.Ba=function(){Te(this.g,"b")},C(hr,(function(){this.blockSize=-1})),hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},hr.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)dr(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){dr(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){dr(this,r),i=0;break}}this.h=i,this.i+=t},hr.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var pr={};function mr(e){return-128<=e&&128>e?function(e,t){var n=pr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new fr([0|e],0>e?-1:0)}(e)}(e):new fr([0|e],0>e?-1:0)}function gr(e){if(isNaN(e)||!isFinite(e))return vr;if(0>e)return xr(gr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=yr;return new fr(t,0)}var yr=4294967296,vr=mr(0),wr=mr(1),br=mr(16777216);function _r(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Er(e){return-1==e.h}function xr(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new fr(n,~e.h).add(wr)}function Ir(e,t){return e.add(xr(t))}function Sr(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Tr(e,t){this.g=e,this.h=t}function Cr(e,t){if(_r(t))throw Error("division by zero");if(_r(e))return new Tr(vr,vr);if(Er(e))return t=Cr(xr(e),t),new Tr(xr(t.g),xr(t.h));if(Er(t))return t=Cr(e,xr(t)),new Tr(xr(t.g),t.h);if(30<e.g.length){if(Er(e)||Er(t))throw Error("slowDivide_ only works with positive integers.");for(var n=wr,r=t;0>=r.$(e);)n=Dr(n),r=Dr(r);var i=Ar(n,1),s=Ar(r,1);for(r=Ar(r,2),n=Ar(n,2);!_r(r);){var o=s.add(r);0>=o.$(e)&&(i=i.add(n),s=o),r=Ar(r,1),n=Ar(n,1)}return t=Ir(e,i.S(t)),new Tr(i,t)}for(i=vr;0<=e.$(t);){for(n=Math.max(1,Math.floor(e.ga()/t.ga())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=gr(n)).S(t);Er(o)||0<o.$(e);)o=(s=gr(n-=r)).S(t);_r(s)&&(s=wr),i=i.add(s),e=Ir(e,o)}return new Tr(i,e)}function Dr(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.F(r)<<1|e.F(r-1)>>>31;return new fr(n,e.h)}function Ar(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.F(s+n)>>>t|e.F(s+n+1)<<32-t:e.F(s+n);return new fr(i,e.h)}(t=fr.prototype).ga=function(){if(Er(this))return-xr(this).ga();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.F(n);e+=(0<=r?r:yr+r)*t,t*=yr}return e},t.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(_r(this))return"0";if(Er(this))return"-"+xr(this).toString(e);for(var t=gr(Math.pow(e,6)),n=this,r="";;){var i=Cr(n,t).g,s=((0<(n=Ir(n,i.S(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(_r(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.F=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},t.$=function(e){return Er(e=Ir(this,e))?-1:_r(e)?0:1},t.abs=function(){return Er(this)?xr(this):this},t.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.F(i))+(65535&e.F(i)),o=(s>>>16)+(this.F(i)>>>16)+(e.F(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new fr(n,-2147483648&n[n.length-1]?-1:0)},t.S=function(e){if(_r(this)||_r(e))return vr;if(Er(this))return Er(e)?xr(this).S(xr(e)):xr(xr(this).S(e));if(Er(e))return xr(this.S(xr(e)));if(0>this.$(br)&&0>e.$(br))return gr(this.ga()*e.ga());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.F(r)>>>16,o=65535&this.F(r),a=e.F(i)>>>16,c=65535&e.F(i);n[2*r+2*i]+=o*c,Sr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Sr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Sr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Sr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new fr(n,0)},t.jb=function(e){return Cr(this,e).h},t.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)&e.F(r);return new fr(n,this.h&e.h)},t.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)|e.F(r);return new fr(n,this.h|e.h)},t.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)^e.F(r);return new fr(n,this.h^e.h)},or.prototype.createWebChannel=or.prototype.g,ar.prototype.send=ar.prototype.u,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,lt.COMPLETE="complete",ft.EventType=mt,mt.OPEN="a",mt.CLOSE="b",mt.ERROR="c",mt.MESSAGE="d",Se.prototype.listen=Se.prototype.P,Tn.prototype.listenOnce=Tn.prototype.R,Tn.prototype.getLastError=Tn.prototype.Va,Tn.prototype.getLastErrorCode=Tn.prototype.La,Tn.prototype.getStatus=Tn.prototype.fa,Tn.prototype.getResponseJson=Tn.prototype.Za,Tn.prototype.getResponseText=Tn.prototype.ma,Tn.prototype.send=Tn.prototype.ja,Tn.prototype.setWithCredentials=Tn.prototype.Ra,hr.prototype.digest=hr.prototype.l,hr.prototype.reset=hr.prototype.reset,hr.prototype.update=hr.prototype.j,fr.prototype.add=fr.prototype.add,fr.prototype.multiply=fr.prototype.S,fr.prototype.modulo=fr.prototype.jb,fr.prototype.compare=fr.prototype.$,fr.prototype.toNumber=fr.prototype.ga,fr.prototype.toString=fr.prototype.toString,fr.prototype.getBits=fr.prototype.F,fr.fromNumber=gr,fr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return xr(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=gr(Math.pow(n,8)),i=vr,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=gr(Math.pow(n,o)),i=i.S(o).add(gr(a))):i=(i=i.S(r)).add(gr(a))}return i},e.exports.createWebChannelTransport=function(){return new or},e.exports.getStatEventTarget=function(){return nt()},e.exports.ErrorCode=ut,e.exports.EventType=lt,e.exports.Event=et,e.exports.Stat={Ab:0,Db:1,Eb:2,Xb:3,bc:4,Zb:5,$b:6,Yb:7,Wb:8,ac:9,PROXY:10,NOPROXY:11,Ub:12,Qb:13,Rb:14,Pb:15,Sb:16,Tb:17,wb:18,vb:19,xb:20},e.exports.FetchXmlHttpFactory=wn,e.exports.WebChannel=ft,e.exports.XhrIo=Tn,e.exports.Md5=hr,e.exports.Integer=fr}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},341:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"/* Estilos generales */\n\n.section {\n    background-color: #d0cdcd;\n    width: 38%;\n    margin: 11rem auto 0;\n    padding: 2rem;\n    border-radius: 86px;\n    box-shadow: 0 0 10px 13px rgba(0, 0, 0, 0.2);\n}\n\n.h1 {\n    margin-left: -15.5rem;\n    font-family: 'Poppins', sans-serif;\n    font-size: 2rem;\n    text-align: center;\n    margin-bottom: -4rem;\n}\n\n.img {\n    width: 100%;\n    height: auto;\n    border-radius: 3rem;\n    display: block;\n    margin: 0 auto;\n}\n\n.img-i {\n    height: 3rem;\n    border-radius: 50%;\n    margin: 1rem auto;\n    display: block;\n    margin-left: 3rem;\n}\n\n/* Iconos */\n.icon-container {\n    display: flex;\n    justify-content: center;\n    margin-top: 1rem;\n}\n\n.likeicon1, .likeicon2, .saveicon {\n    width: 3rem;\n    height: 3rem;\n    margin: 0 1rem;\n    cursor: pointer;\n    margin-top: 2rem;\n}\n\n\n\n/* Estilos para dispositivos móviles */\n@media (max-width: 431px) {\n    .section {\n        width: 77%;\n        margin: 6rem auto;\n        padding: 1rem;\n        border-radius: 2rem;\n    }\n    .h1 {\n        font-size: 1rem;\n        margin-left: -3rem;\n        margin-bottom: -3rem;\n    }\n\n    .img {\n        width: 90%;\n        border-radius: 2rem;\n    }\n\n    .img-i {\n        height: 2rem;\n        margin-left: 2rem;\n    }\n\n    .icon-container {\n        margin-top: 0.5rem;\n    }\n\n    .likeicon1, .likeicon2, .saveicon {\n        width: 1.5rem;\n        height: 1.5rem;\n        margin: 13px 0.5rem;\n        margin-bottom: 0%;\n    }\n}\n",""]);const a=o},5750:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".hidden {\n\tdisplay: none;\n}\n\n.suggestionsSectionShow {\n    width: 23rem;\n    display: flex;\n    position: fixed;\n    z-index: 10;\n    flex-direction: column;\n    background-color: #959595;\n    border-radius: 14px;\n    margin-left: 70rem;\n    margin-top: 7rem;\n    height: 34rem;\n}\n.h2 {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: space-between;\n\talign-content: center;\n\tflex-wrap: wrap;\n\tfont-family: 'Poppins', sans-serif;\n}\n\n@media (max-width: 431px) {\n       .suggestionsSectionShow {\n        width: 17rem;\n        display: flex;\n        position: fixed;\n        z-index: 10;\n        flex-direction: column;\n        background-color: #959595;\n        border-radius: 14px;\n        margin-left: 8rem;\n        margin-top: 4rem;\n        height: 35rem;\n    }\n   \n}",""]);const a=o},5278:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".poppins {\n\tfont-family: 'Poppins', sans-serif;\n}\n.text {\n\tmargin-bottom: 61px;\n\n\tfont-size: 61px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n\n#general {\n\tbackground: rgb(255 255 255 / 8%);\n\tborder-radius: 10px;\n\tpadding: 20px;\n\twidth: 400px;\n\tmargin: 214px auto;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nlabel {\n\tdisplay: block;\n\tfont-size: 23px;\n\tcolor: #666;\n\tfont-weight: 500;\n\tpadding: 12px;\n\tfont-family: 'Poppins', sans-serif;\n}\n\ninput {\n\tborder: 1px solid #ddd;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\twidth: 99%;\n\tmargin-bottom: 20px;\n\tborder-radius: 12px;\n\theight: 30px;\n}\nbutton {\n\tbackground: #666666;\n\tborder: none;\n\tborder-radius: 3px;\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tcursor: pointer;\n\twidth: 105%;\n\tborder-radius: 32px;\n\talign-content: center;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tflex-direction: column-reverse;\n\tfont-size: 23px;\n\tmargin-top: 17px;\n}\n\nbutton:hover {\n\tbackground: #000000;\n}\n\n#password {\n\tbackground-color: 666666;\n}\nh4 {\n\tcolor: black;\n\tfont-size: 21px;\n\tfont-family: 'Poppins', sans-serif;\n}\nh5 {\n\tcolor: #000000;\n\tfont-size: 21px;\n\tmargin-left: 16rem;\n\tmargin-top: -13%;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nh6 {\n\tdisplay: flex;\n\tcolor: black;\n\tfont-size: 22px;\n\talign-items: center;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n",""]);const a=o},7829:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".navbar-icons {\n\tvertical-align: sub;\n\theight: 35px;\n\tmargin-right: 10px;\n}\n\n.nav-item {\n    margin-right: 80px;\n    display: flex;\n    flex-direction: row;\n}\n.nav-item a {\n\tcolor: #000;\n\tfont-weight: bold;\n\ttext-decoration: none;\n\ttransition: color 0.3s ease;\n\tmargin-right: 10px;\n}\n.nav-item p {\n\tcolor: #000;\n\tfont-weight: bold;\n\ttext-decoration: none;\n\ttransition: color 0.3s ease;\n\tmargin-right: 23px;\n\tfont-family: 'Poppins', sans-serif;\n\tfont-size: 20px;\n}\n\n.nav-item a:hover {\n\tcolor: #ff9900;\n}\n\n.nav-item a:hover {\n\tcolor: #ff9900;\n}\n\n@media (max-width: 431px) {\n\n\t.nav-item p {\n    color: #000;\n    font-weight: bold;\n    text-decoration: none;\n    transition: color 0.3s ease;\n    margin-right: 23px;\n    font-family: 'Poppins', sans-serif;\n    font-size: 0;\n}\n.nav-item {\n\tmargin-right: 19px;\n\tdisplay: flex;\n\tflex-direction: row;\n\theight: 24px;\n}\n\n}\n",""]);const a=o},2487:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"/* Estilos generales */\n.navbar {\n    width: 100%;\n    background-image: linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)), url('https://pbs.twimg.com/media/GKHt7rtXQAAyNuw?format=jpg&name=medium');\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n    background-blend-mode: overlay;\n    padding: 10px 20px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    position: fixed;\n    z-index: 999;\n}\n.navbar-brand img {\n    height: 34px;\n    margin-right: 30rem;\n}\n\n.navbar-nav {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n    display: flex;\n}\n.nav-item {\n    margin-right: 80px;\n    display: flex;\n    flex-direction: row;\n}\n\n.nav-item a:hover {\n    color: #666;\n}\n\n#navbar-icons {\n    vertical-align: middle;\n    height: 25px;\n    margin-right: 5px;\n}\n\n/* Sugerencias */\n.section {\n    display: flex;\n    width: 100%;\n    height: 100%;\n}\n\n.hidden {\n    display: none;\n}\n\n.show {\n    display: flex;\n    background-color: rgb(139, 136, 136);\n    flex-direction: column;\n    position: absolute;\n    top: 64px;\n    right: 20px;\n    border-radius: 13px;\n    height: 65vh;\n    width: 250px;\n    color: #000;\n    z-index: 998;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\n}\n\n.h2 {\n    display: flex;\n    margin-left: 26%;\n    font-size: 1.2rem;\n    font-weight: bold;\n}\n\n/* Estilos para dispositivos móviles */\n@media (max-width: 431px) {\n    .navbar {\n        width: 100%;\n        height: 2rem;\n        padding: 10px;\n        background-image: url('https://pbs.twimg.com/media/GKIEiRTX0AAzbq2?format=jpg&name=large');\n        background-size: cover;\n        background-position: center;\n    }\n\n    .navbar-brand img {\n        height: 17px;\n        margin-right: 31px;\n    }\n\n    .nav-item a {\n        font-size: 0;\n    }\n\n    #navbar-icons {\n        height: 20px;\n        margin-right: 10px;\n        margin-left: -5px;\n    }\n\n    .navbar-nav {\n        margin: 0;\n        margin-left: auto;\n    }\n\n    .show {\n        top: 54px;\n        left: 10px;\n        height: 51vh;\n        width: 234px;\n    }\n\n    .h2 {\n        margin-left: 22%;\n        font-size: 1rem;\n    }\n}\n",""]);const a=o},475:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".poppins {\n\tfont-family: 'Poppins', sans-serif;\n}\n.text {\n\tmargin-bottom: 61px;\n\n\tfont-size: 61px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n\n#general {\n\tbackground: rgb(255 255 255 / 8%);\n\tborder-radius: 10px;\n\tpadding: 20px;\n\twidth: 400px;\n\tmargin: 214px auto;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nlabel {\n\tdisplay: block;\n\tfont-size: 23px;\n\tcolor: #666;\n\tfont-weight: 500;\n\tpadding: 12px;\n\tfont-family: 'Poppins', sans-serif;\n}\n\ninput {\n\tborder: 1px solid #ddd;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\twidth: 99%;\n\tmargin-bottom: 20px;\n\tborder-radius: 12px;\n\theight: 30px;\n\tfont-size: 0;\n}\nbutton {\n\tbackground: #666666;\n\tborder: none;\n\tborder-radius: 3px;\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tcursor: pointer;\n\twidth: 105%;\n\tborder-radius: 32px;\n\talign-content: center;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tflex-direction: column-reverse;\n\tfont-size: 23px;\n\tmargin-top: 17px;\n}\n\nbutton:hover {\n\tbackground: #000000;\n}\n\n#password {\n\tbackground-color: 666666;\n}\nh4 {\n\tcolor: black;\n\tfont-size: 21px;\n\tfont-family: 'Poppins', sans-serif;\n}\nh5 {\n\tcolor: #000000;\n\tfont-size: 21px;\n\tmargin-left: 16rem;\n\tmargin-top: -13%;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nh6 {\n\tdisplay: flex;\n\tcolor: black;\n\tfont-size: 22px;\n\talign-items: center;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n\n\n\n@media (max-width: 431px) {\n\n\tlabel {\n\t\tdisplay: block;\n\t\tfont-size: 34px;\n\t\tcolor: #666;\n\t\tfont-weight: 500;\n\t\tpadding: 12px;\n\t\tfont-family: 'Poppins', sans-serif;\n\t\tmargin-top: -25%;\n}\n\ninput {\n\tborder: 1px solid #ddd;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\twidth: 89%;\n\tmargin-bottom: 20px;\n\tborder-radius: 12px;\n\theight: 196px;\n\tfont-size: 0;\n}\n\nbutton {\n\tbackground: #666666;\n\tborder: none;\n\tborder-radius: 3px;\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tcursor: pointer;\n\twidth: 94%;\n\tborder-radius: 32px;\n\talign-content: center;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tflex-direction: column-reverse;\n\tfont-size: 23px;\n\tmargin-top: 17px;\n}\n}",""]);const a=o},422:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".sidebar {\n\tdisplay: flex;\n\tbackground-color: #555555;\n\twidth: 250px;\n\theight: 100vh;\n\tmargin-top: 20px;\n\tmargin-right: 20px;\n\tborder-radius: 13px;\n\tmargin-left: 1227px;\n\tcolor: #ffffff;\n}\n\n.noShow {\n\tdisplay: none;\n}\n\n#navbar-icons {\n\tvertical-align: middle;\n\theight: 45px;\n\tmargin-right: 30px;\n\tmargin-left: 44px;\n\tvertical-align: sub;\n\theight: 35px;\n\tmargin-right: 23px;\n}\n\n.h2 {\n\tmargin-left: 48px;\n\tposition: sticky;\n\tcolor: white;\n}\n\n.suggestion-item {\n\tdisplay: flex;\n\tmargin-top: 2%;\n}\n\na {\n\ttext-decoration: none;\n\tmargin-bottom: 7px;\n\tfont-size: 2rem;\n}\n\n/* iphone 14 pro max */\n@media (min-width: 431px) {\n\n\t#navbar-icons {\n\t\tvertical-align: middle;\n\t\theight: 45px;\n\t\tmargin-right: 30px;\n\t\tmargin-left: 44px;\n\t\tvertical-align: sub;\n\t\theight: 35px;\n\t\tmargin-right: 13px;\n\t}\n\ta {\n\t\ttext-decoration: none;\n\t\tmargin-bottom: 7px;\n\t\tfont-size: 137%;\n}\n}\n",""]);const a=o},2503:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".poppins {\n\tfont-family: 'Poppins', sans-serif;\n}\n.text {\n\tmargin-bottom: 26px;\n\t/* margin: 5rem; */\n\tfont-size: 47px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n\n#general {\n\tbackground: rgb(255 255 255 / 8%);\n\tborder-radius: 10px;\n\tpadding: 20px;\n\twidth: 400px;\n\tmargin: 214px auto;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nlabel {\n\tdisplay: block;\n\tfont-size: 23px;\n\tcolor: #666;\n\tfont-weight: 500;\n\tpadding: 12px;\n\tfont-family: 'Poppins', sans-serif;\n}\n\ninput {\n\tborder: 1px solid #ddd;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\twidth: 99%;\n\tmargin-bottom: 20px;\n\tborder-radius: 12px;\n\theight: 30px;\n}\nbutton {\n\tbackground: #666666;\n\tborder: none;\n\tborder-radius: 3px;\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tcursor: pointer;\n\twidth: 105%;\n\tborder-radius: 32px;\n\talign-content: center;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tflex-direction: column-reverse;\n\tfont-size: 23px;\n\tmargin-top: 17px;\n}\n\nbutton:hover {\n\tbackground: #000000;\n}\n\n#password {\n\tbackground-color: 666666;\n}\nh4 {\n\tcolor: black;\n\tfont-size: 21px;\n\tfont-family: 'Poppins', sans-serif;\n\tmargin: 24px;\n}\nh5 {\n\tcolor: #000000;\n\tfont-size: 21px;\n\tmargin-left: 287px;\n\tmargin-top: -12%;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nh6 {\n\tdisplay: flex;\n\tcolor: black;\n\tfont-size: 22px;\n\talign-items: center;\n\tflex-direction: column;\n\tfont-family: 'Poppins', sans-serif;\n}\n",""]);const a=o},5927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"/* .container {\n\tbackground-image: url('https://pbs.twimg.com/media/GKHrydJWUAADY89?format=jpg&name=large');\n\tbackground-attachment: fixed;\n\tbackground-repeat: no-repeat;\n\tbackground-size: cover;\n}\n\n@media (max-width: 431px) {\n\t.container {\n\t\tbackground-image: url('https://pbs.twimg.com/media/GKH9S3UXwAAONh9?format=jpg&name=large');\n\t\tbackground-attachment: fixed;\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-size: cover;\n\t}\n} */\n",""]);const a=o},1152:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,".container {\n    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.8), rgba(192, 192, 192, 0.8));\n    background-attachment: fixed;\n    background-repeat: no-repeat;\n    background-size: cover;\n    backdrop-filter: blur(7px);\n}\n\n\n@media (max-width: 431px) {\n\t.container {\n\t\tbackground-image: url('https://pbs.twimg.com/media/GKH9S3UXwAAONh9?format=jpg&name=large');\n\t\tbackground-attachment: fixed;\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-size: cover;\n\t}\n\t\n}\n",""]);const a=o},6196:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap);"]),o.push([e.id,".poppins {\n\tfont-family: 'Poppins', sans-serif;\n}\n\n#general {\n\tbackground: rgb(255 255 255 / 8%);\n\tborder-radius: 10px;\n\tpadding: 20px;\n\twidth: 400px;\n\tmargin: 214px auto;\n\tfont-family: 'Poppins', sans-serif;\n}\n\nlabel {\n\tdisplay: block;\n\tfont-size: 23px;\n\tcolor: #666;\n\tfont-weight: 500;\n\tpadding: 12px;\n\tfont-family: 'Poppins', sans-serif;\n}\n\ninput {\n\tborder: 1px solid #ddd;\n\tborder-radius: 3px;\n\tpadding: 10px;\n\twidth: 99%;\n\tmargin-bottom: 20px;\n\tborder-radius: 12px;\n\theight: 30px;\n}\nbutton {\n\tbackground: #666666;\n\tborder: none;\n\tborder-radius: 3px;\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tcursor: pointer;\n\twidth: 105%;\n\tborder-radius: 32px;\n\talign-content: center;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tflex-direction: column-reverse;\n\tfont-size: 23px;\n\tmargin-top: 17px;\n}\n\nbutton:hover {\n\tbackground: #000000;\n}\n\n#password {\n\tbackground-color: 666666;\n}\n\n#logo {\n\tposition: absolute;\n\tleft: 2%;\n\ttop: 9%;\n}\n",""]);const a=o},1187:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"#logo {\n\tposition: absolute;\n\tleft: 2%;\n\ttop: 9%;\n}\n@media (max-width: 431px) {\n\t#logo{\n\tposition: absolute;\n\tleft: 5%;\n\ttop: 5%;\n\theight: 28px;\n}\n}",""]);const a=o},1582:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(1601),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([e.id,"#logo {\n\tposition: absolute;\n\tleft: 2%;\n\ttop: 9%;\n}\n",""]);const a=o},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1542:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/57e94d14b5c0231d5c4c1a80f13cd240.png"},6827:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/60948cb3f84227213d33209848b1370b.png"},6709:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/10fe09f387eff8413c83a69c2e92a400.png"},6559:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/57f6627a49f1063e02d772e2dfb9744e.png"},7904:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/36cd3e6fa39b64a1db33d638470e66c8.png"},5577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6199);r.registerVersion("firebase","10.11.1","app"),Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},9815:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1241);Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},1177:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.postcard=t.sideC=t.singup=t.imputs=t.card=t.sidebar=t.navbar=t.dcard=void 0;var i=n(5988);Object.defineProperty(t,"dcard",{enumerable:!0,get:function(){return r(i).default}});var s=n(1402);Object.defineProperty(t,"navbar",{enumerable:!0,get:function(){return r(s).default}});var o=n(1845);Object.defineProperty(t,"sidebar",{enumerable:!0,get:function(){return r(o).default}});var a=n(5988);Object.defineProperty(t,"card",{enumerable:!0,get:function(){return r(a).default}});var c=n(4610);Object.defineProperty(t,"imputs",{enumerable:!0,get:function(){return r(c).default}});var u=n(6518);Object.defineProperty(t,"singup",{enumerable:!0,get:function(){return r(u).default}});var l=n(3975);Object.defineProperty(t,"sideC",{enumerable:!0,get:function(){return l.sideC}});var h=n(9439);Object.defineProperty(t,"postcard",{enumerable:!0,get:function(){return h.postcard}})},5988:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeCard=void 0;const i=r(n(341)),s=r(n(6709)),o=r(n(6827)),a=r(n(6559)),c=r(n(7904)),u=r(n(1542));var l;!function(e){e.name="name",e.image="image",e.profileimage="profileimage"}(l||(t.AttributeCard=l={}));class h extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({name:null,image:null,profileimage:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML="\n\n\n\n\t\t\t\t";const e=document.createElement("section");e.className="section";const t=document.createElement("h1");t.className="h1",t.textContent=this.name||"";const n=document.createElement("img");n.className="img-i",n.src=this.profileimage||"";const r=document.createElement("img");r.className="img",r.src=this.image||"";const i=document.createElement("img");i.src=s.default,i.className="likeicon1",i.addEventListener("click",(function(){i.src===s.default?i.src=o.default:i.src=s.default}));const l=document.createElement("img");l.src=u.default,l.className="likeicon2";const h=document.createElement("img");h.src=a.default,h.className="saveicon",h.addEventListener("click",(function(){h.src===a.default?h.src=c.default:h.src=a.default})),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(h),e.appendChild(i),e.appendChild(l),this.shadowRoot.appendChild(e)}const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}t.default=h,customElements.define("my-card",h)},3975:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sideC=void 0;const i=n(1845),s=n(7153),o=r(n(5750));class a extends HTMLElement{constructor(){super(),this.Component=[],this.attachShadow({mode:"open"}),s.workers.filter((e=>e.id)).slice(0,8).forEach((e=>{const t=this.ownerDocument.createElement("my-si");t.setAttribute(i.Attribute.name,e.name),this.Component.push(t),console.log(this.Component)}))}connectedCallback(){console.log("emtraaaa"),this.render()}render(){var e,t;const n=this.ownerDocument.createElement("style");n.innerHTML=o.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("section");r.className="hidden",null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const i=document.createElement("h2");i.textContent="Suggestions",i.className="h2",r.appendChild(i),this.Component.forEach((e=>{r.appendChild(e)}))}}t.sideC=a,customElements.define("my-sidec",a)},4610:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeCard=void 0;const i=r(n(5278)),s=n(2482),o=n(2997),a=n(8006);var c;!function(e){e.name="name",e.image="image"}(c||(t.AttributeCard=c={}));class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({name:null,image:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}handleLoginButton(){(0,s.dispatch)((0,o.navigate)(a.Screens.DASHBOARD))}handleSignupButton(){(0,s.dispatch)((0,o.navigate)(a.Screens.SINGUP))}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML=" ";const e=document.createElement("div");e.id="general";const t=document.createElement("div");t.id="inputs";const n=document.createElement("label");n.setAttribute("for","email"),n.textContent="Email address or user name";const r=document.createElement("input");r.type="email",r.classList.add("email");const i=document.createElement("label");i.setAttribute("for","Password"),i.textContent="Password";const s=document.createElement("input");s.type="password",s.id="password";const o=document.createElement("button");o.classList.add("button"),o.textContent="login",o.style.fontFamily="Poppins, sans-serif",o.addEventListener("click",this.handleLoginButton),console.log("Se hizo clic en el botón de inicio de sesión"),document.createElement("img").src="";const a=document.createElement("h4");a.classList.add("h4"),a.textContent="Don’t have an acount?";const c=document.createElement("h5");c.textContent="Sign up",c.classList.add("h5"),c.addEventListener("click",(()=>{c.addEventListener("click",this.handleSignupButton),console.log('Se hizo clic en "Sign up"')}));const u=document.createElement("h6");u.textContent="Forget your password",u.classList.add("h6");const l=document.createElement("text");l.textContent="log in",l.classList.add("text"),t.appendChild(l),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(s),t.appendChild(o),t.appendChild(u),t.appendChild(a),t.appendChild(c),e.appendChild(t),document.body.appendChild(e),this.shadowRoot.appendChild(e)}const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}customElements.define("my-imputs",u),t.default=u},7366:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.button=t.AttributeCard=void 0;const i=r(n(7829));n(1177);const s=n(2482),o=n(2997),a=n(8006);var c;!function(e){e.name="name",e.image="image"}(c||(t.AttributeCard=c={}));class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),console.log("Contructor")}static get observedAttributes(){return Object.keys({name:null,image:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}render(){var e,t;this.shadowRoot&&(this.shadowRoot.innerHTML="");const n=this.ownerDocument.createElement("style");n.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=document.createElement("div");r.classList.add("nav-item"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const c=document.createElement("p");this.name&&(c.textContent=this.name),r.appendChild(c);const u=document.createElement("img");u.src=`../../../../imagenes/${this.image}`,u.id="navbar-icons",r.appendChild(u),"HOME"===this.name&&r.addEventListener("click",(()=>{window.location.reload()})),"USERS"===this.name&&r.addEventListener("click",(()=>{var e,t,n,r,i,s;const o=null===(s=null===(i=null===(r=null===(n=null===(t=null===(e=this.ownerDocument.querySelector("app-container"))||void 0===e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("app-dashboard"))||void 0===n?void 0:n.shadowRoot)||void 0===r?void 0:r.querySelector("my-sidec"))||void 0===i?void 0:i.shadowRoot)||void 0===s?void 0:s.querySelector("section");console.log("Sugggestion"),console.log(o),"hidden"===(null==o?void 0:o.className)?(console.log("Hidden"),o.classList.remove("hidden"),o.classList.add("suggestionsSectionShow")):"suggestionsSectionShow"===(null==o?void 0:o.className)&&(o.classList.remove("suggestionsSectionShow"),o.classList.add("hidden"))})),"POST"===this.name&&r.addEventListener("click",(()=>{(0,s.dispatch)((0,o.navigate)(a.Screens.POST)),console.log('Se hizo clic en el botón de "POST"')})),"ACCOUNT"===this.name&&r.addEventListener("click",(()=>{(0,s.dispatch)((0,o.navigate)(a.Screens.LOGIN)),console.log('Se hizo clic en el botón de "ACCOUNT"')}))}}t.button=u,customElements.define("my-button",u)},1402:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2487)),s=n(1845),o=n(7153);n(7366);class a extends HTMLElement{constructor(){super(),this.Component=[],this.attachShadow({mode:"open"}),o.workers.filter((e=>e.id)).slice(0,8).forEach((e=>{const t=this.ownerDocument.createElement("my-si");t.setAttribute(s.Attribute.name,e.name),this.Component.push(t),console.log(this.Component)}))}connectedCallback(){this.render()}render(){var e;const t=document.createElement("section");t.className="section",this.shadowRoot&&this.shadowRoot.appendChild(t);const n=document.createElement("nav");n.classList.add("navbar"),t.appendChild(n);const r=document.createElement("ul");r.classList.add("navbar-nav"),n.appendChild(r);const s=document.createElement("div");s.classList.add("navbar-brand"),n.appendChild(s);const o=document.createElement("img");o.src="../../../../imagenes/pesa.png",o.alt="Logo",o.id="logo",s.appendChild(o);const a=this.ownerDocument.createElement("my-button");a.setAttribute("name","HOME"),a.setAttribute("image","../../../../imagenes/icons8-chicle--100 1.png"),n.appendChild(a);const c=this.ownerDocument.createElement("my-button");c.setAttribute("name","POST"),c.setAttribute("image","../../../../imagenes/icons8-add-100 1.png"),n.appendChild(c);const u=this.ownerDocument.createElement("my-button");u.setAttribute("name","USERS"),u.setAttribute("image","../../../../imagenes/icons8-usuario-60.png"),n.appendChild(u);const l=this.ownerDocument.createElement("my-button");l.setAttribute("name","ACCOUNT"),l.setAttribute("image","../../../../imagenes/Ellipse 15.png"),n.appendChild(l);const h=this.ownerDocument.createElement("style");h.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(h)}}customElements.define("my-bar",a),t.default=a},9439:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.postcard=void 0;const i=r(n(475)),s=n(2482),o=n(2997),a=n(8006);class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}handlepostButton(){(0,s.dispatch)((0,o.navigate)(a.Screens.DASHBOARD))}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML=" ";const e=document.createElement("div");e.id="general";const t=document.createElement("div");t.id="inputs";const n=document.createElement("label");n.textContent="post";const r=document.createElement("input");r.type="file",r.id="file";const i=document.createElement("button");i.classList.add("button"),i.textContent="Post",i.addEventListener("click",(()=>{i.addEventListener("click",this.handlepostButton),console.log('Se hizo clic en "post"')})),t.appendChild(n),t.appendChild(r),t.appendChild(i),e.appendChild(t),this.shadowRoot.appendChild(e)}const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}t.postcard=c,customElements.define("my-post",c)},1845:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;const i=r(n(422));var s;!function(e){e.name="name"}(s||(t.Attribute=s={}));class o extends HTMLElement{static get observedAttributes(){return["name"]}attributeChangedCallback(e,t,n){"name"===e&&null!==n&&(this.name=n)}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render(),this.setupEventListeners()}setupEventListeners(){this.addEventListener("btnBarritaClicked",(()=>{console.log("Evento btnBarritaClicked recibido en Suggestions")}))}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t\t\t\t\t\t\t<style>\n\t\t\t\t\t\t\t\t\t${i.default}\n\t\t\t\t\t\t\t\t\t</style>\n\t\t\t\t\t\t\t\t\t<section class='suggestion-item'>\n\t\t\t\t\t\t\t\t\t\t<a href="#"><img src="../../../../imagenes/Ellipse 15.png" id="navbar-icons" />${this.name}</a>\n                    </section>\n\n                `)}}customElements.define("my-si",o),t.default=o},6518:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2503)),s=n(2482),o=n(2997),a=n(8006);class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}handleCreatButton(){(0,s.dispatch)((0,o.navigate)(a.Screens.DASHBOARD))}handlelogButton(){(0,s.dispatch)((0,o.navigate)(a.Screens.LOGIN))}render(){var e;if(this.shadowRoot){this.shadowRoot.innerHTML=" ";const e=document.createElement("div");e.id="general";const t=document.createElement("div");t.id="inputs";const n=document.createElement("label");n.setAttribute("for","email"),n.textContent="Email address or user name";const r=document.createElement("input");r.type="email",r.classList.add("email");const i=document.createElement("label");i.setAttribute("for","Password"),i.textContent="Password";const s=document.createElement("input");s.type="password",s.id="password";const o=document.createElement("label");o.textContent="User";const a=document.createElement("input");a.type="text",a.id="user";const c=document.createElement("label");c.textContent="age";const u=document.createElement("input");u.type="text",u.id="age";const l=document.createElement("label");l.textContent="Bench press";const h=document.createElement("input");h.type="text",h.id="Bench press";const d=document.createElement("label");d.textContent="DeadLift";const f=document.createElement("input");f.type="text",f.id="DeadLift";const p=document.createElement("label");p.textContent="Squat";const m=document.createElement("input");m.type="text",m.id="Squat";const g=document.createElement("button");g.classList.add("button"),g.textContent="create account",g.addEventListener("click",this.handleCreatButton),console.log('Se hizo clic en el botón de "crear cuenta"'),document.body.appendChild(e),this.shadowRoot.appendChild(e);const y=document.createElement("h4");y.classList.add("h4"),y.textContent="Already have an ccount?";const v=document.createElement("h5");v.textContent="Log in",v.classList.add("h5"),v.addEventListener("click",this.handlelogButton),console.log("Se hizo clic en el elemento h5");const w=document.createElement("text");w.textContent="Create an account",w.classList.add("text"),t.appendChild(w),t.appendChild(y),t.appendChild(v),t.appendChild(o),t.appendChild(a),t.appendChild(c),t.appendChild(u),t.appendChild(l),t.appendChild(h),t.appendChild(d),t.appendChild(f),t.appendChild(p),t.appendChild(m),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(s),t.appendChild(g),e.appendChild(t)}const t=this.ownerDocument.createElement("style");t.innerHTML=i.default,null===(e=this.shadowRoot)||void 0===e||e.appendChild(t)}}customElements.define("my-singup",c),t.default=c},7153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workers=void 0,t.workers=[{id:1,name:"Maria Lopez",image:"https://www.pexels.com/es-es/foto/mujer-en-camisa-con-cuello-774909/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:2,name:"Emily Johnson",image:"https://www.pexels.com/es-es/foto/mujer-sonriendo-a-la-camara-1181686/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:3,name:"John Smith",image:"https://www.pexels.com/es-es/foto/hombre-de-chaqueta-roja-1681010/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:4,name:"Michael Brown",image:"https://www.pexels.com/es-es/foto/hombre-brazos-cruzados-1516680/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:5,name:"Sophia Martinez",image:"https://www.pexels.com/es-es/foto/mujer-llevando-negro-correa-espagueti-top-415829/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:6,name:"Isabella Garcia",image:"https://www.pexels.com/es-es/foto/mujer-cerca-de-casa-2804282/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:7,name:"William Taylor",image:"https://images.pexels.com/photos/2589653/pexels-photo-2589653.jpeg?auto=compress&cs=tinysrgb&w=600",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:8,name:"Ethan Wilson",image:"https://www.pexels.com/es-es/foto/camisa-de-vestir-azul-para-hombre-1043471/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:9,name:"Olivia Anderson",image:"https://www.pexels.com/es-es/foto/riendo-a-mujer-formal-en-elegante-chaqueta-5905902/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:10,name:"Emma Brown",image:"https://www.pexels.com/es-es/foto/moda-mujer-modelo-camisa-19130891/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:11,name:"James Martinez",image:"https://www.pexels.com/es-es/foto/fotografia-de-hombre-con-camisa-blanca-con-reloj-analogico-negro-redondo-697509/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:12,name:"Alexander Rodriguez",image:"https://www.pexels.com/es-es/foto/hombre-vestido-con-camiseta-azul-con-cuello-circular-2379005/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:13,name:"Ava Wilson",image:"https://www.pexels.com/es-es/foto/mujer-retrato-morena-confianza-14541208/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:14,name:"Mia Perez",image:"https://www.pexels.com/es-es/foto/joven-retrato-adolescente-sonreir-5878568/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"},{id:15,name:"Daniel Thompson",image:"https://www.pexels.com/es-es/foto/hombre-sentado-junto-a-la-pared-purpura-2232981/",profileImage:"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?tf=3840x"}]},5113:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.dashboard=void 0;const s=n(5988),o=i(n(1152));n(1177);const a=n(3445);class c extends HTMLElement{constructor(){super(),this.cards=[],this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){return r(this,void 0,void 0,(function*(){var e,t,n;const r=this.ownerDocument.createElement("div");r.classList.add("container");const i=this.createNavigationBar(),s=this.ownerDocument.createElement("div"),c=this.ownerDocument.createElement("my-sidec");null===(e=this.shadowRoot)||void 0===e||e.appendChild(c),console.log("Traer los datos");const u=yield(0,a.getPosts)();console.log(u),this.createCards(u),this.cards.forEach((e=>{s.appendChild(e)})),r.appendChild(i),r.appendChild(s),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const l=this.ownerDocument.createElement("style");l.innerHTML=o.default,null===(n=this.shadowRoot)||void 0===n||n.appendChild(l)}))}createNavigationBar(){return this.ownerDocument.createElement("my-bar")}createCards(e){return r(this,void 0,void 0,(function*(){this.cards=[],console.log("Firebase Cards Data"),this.renderCards(e)}))}renderCards(e){e.forEach((e=>{const t=this.ownerDocument.createElement("my-card");t.setAttribute(s.AttributeCard.name,e.name),t.setAttribute(s.AttributeCard.profileimage,e.profileImage),t.setAttribute(s.AttributeCard.image,e.image),this.cards.push(t)}))}}t.dashboard=c,customElements.define("app-dashboard",c)},1931:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publica=t.singuppage=t.dashboard=t.loginPge=void 0;var r=n(7365);Object.defineProperty(t,"loginPge",{enumerable:!0,get:function(){return r.loginPge}});var i=n(5113);Object.defineProperty(t,"dashboard",{enumerable:!0,get:function(){return i.dashboard}});var s=n(127);Object.defineProperty(t,"singuppage",{enumerable:!0,get:function(){return s.singuppage}});var o=n(7022);Object.defineProperty(t,"publica",{enumerable:!0,get:function(){return o.publica}})},7365:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loginPge=t.AttributeCard=void 0;const i=r(n(6196));var s;n(1177),function(e){e.name="name",e.image="image"}(s||(t.AttributeCard=s={}));class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({name:null,image:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("my-imputs");null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=document.createElement("img");n.src="../../../../imagenes/pesa.png",n.alt="Logo",n.id="logo",this.shadowRoot.appendChild(n)}const n=this.ownerDocument.createElement("style");n.innerHTML=i.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}}t.loginPge=o,customElements.define("login-page",o)},7022:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.publica=t.AttributeCard=void 0;const i=r(n(1187));var s;n(1177),function(e){e.name="name",e.image="image"}(s||(t.AttributeCard=s={}));class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({name:null,image:null})}attributeChangedCallback(e,t,n){this[e]=n,this.render()}connectedCallback(){this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("my-post");null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=document.createElement("img");n.src="../../../../imagenes/pesa.png",n.alt="Logo",n.id="logo",this.shadowRoot.appendChild(n)}const n=this.ownerDocument.createElement("style");n.innerHTML=i.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}}t.publica=o,customElements.define("public-page",o)},127:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.singuppage=void 0;const i=r(n(1582));n(1177);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("my-singup");null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=document.createElement("img");n.src="../../../../imagenes/pesa.png",n.alt="Logo",n.id="logo",this.shadowRoot.appendChild(n)}const n=this.ownerDocument.createElement("style");n.innerHTML=i.default,null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}}t.singuppage=s,customElements.define("singup-page",s),t.default=s},2997:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigate=void 0,t.navigate=e=>({type:"NAVIGATE",payload:e})},2482:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.addObserver=t.dispatch=t.appState=void 0;const o=s(n(1167)),a=n(6950),c={screen:n(8006).Screens.DASHBOARD};t.appState=o.default.get({key:o.PersistanceKeys.STORE,defaultValue:c});let u=[];t.dispatch=e=>{const n=JSON.parse(JSON.stringify(t.appState)),r=(0,a.reducer)(e,n);var i;t.appState=r,i=r,o.default.set({key:o.PersistanceKeys.STORE,value:i}),u.forEach((e=>e.render()))},t.addObserver=e=>{u=[...u,e]}},6950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0,t.reducer=(e,t)=>{const{type:n,payload:r}=e;return"NAVIGATE"===n&&(t.screen=r),t}},8006:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Screens=void 0,function(e){e.LOGIN="LOGIN",e.DASHBOARD="DASHBOARD",e.SINGUP="SINGUP",e.POST="POST"}(n||(t.Screens=n={}))},3445:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getPosts=t.getSongs=t.addSongs=void 0;const i=n(5577),s=n(9815),o=(0,i.initializeApp)({apiKey:"AIzaSyCspx3Rb4sp29Vh7mY2M6rLldBTiVLkE2g",authDomain:"songs-e8720.firebaseapp.com",projectId:"songs-e8720",storageBucket:"songs-e8720.appspot.com",messagingSenderId:"550395699183",appId:"1:550395699183:web:fc148de80a26d2c964e01a",measurementId:"G-1P6PPRXY9V"}),a=(0,s.getFirestore)(o),c=(0,s.collection)(a,"songs");t.addSongs=e=>r(void 0,void 0,void 0,(function*(){try{yield(0,s.addDoc)(c,e),console.log("Se añadió")}catch(e){console.error(e)}})),t.getSongs=()=>r(void 0,void 0,void 0,(function*(){const e=yield(0,s.getDocs)(c),t=[];return e.docs.forEach((e=>{e.data();const n=e.data();t.push(n)})),console.log(t),t})),t.getPosts=()=>r(void 0,void 0,void 0,(function*(){const e=yield(0,s.getDocs)((0,s.collection)(a,"posts")),t=[];return e.forEach((e=>{t.push(e.data())})),t}))},1167:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PersistanceKeys=void 0,function(e){e.STORE="STORE"}(n||(t.PersistanceKeys=n={})),t.default={get:({key:e,defaultValue:t})=>{const n=localStorage.getItem(e)||sessionStorage.getItem(e);return n?JSON.parse(n):t},set:({key:e,value:t,session:n=!1})=>{const r=n?sessionStorage:localStorage,i=JSON.stringify(t);r.setItem(e,i)}}},6148:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>g,openDB:()=>m,unwrap:()=>p,wrap:()=>f});const r=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),f(o.get(this))}:function(...e){return f(t.apply(p(this),e))}:function(e,...n){const r=t.call(p(this),e,...n);return c.set(r,e.sort?e.sort():[e]),f(r)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(f(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=d(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const p=e=>l.get(e);function m(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=f(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(f(o.result),e.oldVersion,e.newVersion,f(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function g(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),f(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=v.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return w.set(t,s),s}var _;_=h,h={..._,get:(e,t,n)=>b(e,t)||_.get(e,t,n),has:(e,t)=>!!b(e,t)||_.has(e,t)}},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>L,__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>I,__asyncValues:()=>T,__await:()=>x,__awaiter:()=>p,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>P,__classPrivateFieldSet:()=>O,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>R,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>k,__importStar:()=>A,__makeTemplateObject:()=>C,__metadata:()=>f,__param:()=>c,__propKey:()=>h,__read:()=>w,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>b,__spreadArray:()=>E,__spreadArrays:()=>_,__values:()=>v,default:()=>F});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?r.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var m in r)p[m]="access"===m?{}:r[m];for(var m in r.access)p.access[m]=r.access[m];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var g=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[u],p);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(h.get=a),(a=o(g.set))&&(h.set=a),(a=o(g.init))&&i.unshift(a)}else(a=o(g))&&("field"===c?i.unshift(a):h[u]=a)}l&&Object.defineProperty(l,r.name,h),d=!0}function l(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function m(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function E(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function x(e){return this instanceof x?(this.v=e,this):new x(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof x?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:x(e[r](t)),done:!1}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var D=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return D(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function N(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function O(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var M="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function R(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:i,__assign:s,__rest:o,__decorate:a,__param:c,__metadata:f,__awaiter:p,__generator:m,__createBinding:g,__exportStar:y,__values:v,__read:w,__spread:b,__spreadArrays:_,__spreadArray:E,__await:x,__asyncGenerator:I,__asyncDelegator:S,__asyncValues:T,__makeTemplateObject:C,__importStar:A,__importDefault:k,__classPrivateFieldGet:N,__classPrivateFieldSet:O,__classPrivateFieldIn:P,__addDisposableResource:L,__disposeResources:R}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{"use strict";n(4610),n(5927),n(1931);const e=n(2482),t=n(2482),r=n(8006),i=n(3445);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),(0,e.addObserver)(this)}connectedCallback(){this.render()}render(){var e,n,s,o;switch((0,i.getPosts)(),this.shadowRoot&&(this.shadowRoot.innerHTML=""),t.appState.screen){case r.Screens.DASHBOARD:const t=this.ownerDocument.createElement("app-dashboard");null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);break;case r.Screens.LOGIN:const i=this.ownerDocument.createElement("login-page");null===(n=this.shadowRoot)||void 0===n||n.appendChild(i);break;case r.Screens.SINGUP:const a=this.ownerDocument.createElement("singup-page");null===(s=this.shadowRoot)||void 0===s||s.appendChild(a);break;case r.Screens.POST:const c=this.ownerDocument.createElement("public-page");null===(o=this.shadowRoot)||void 0===o||o.appendChild(c)}}}customElements.define("app-container",s)})()})();